<!DOCTYPE html>
<html>
<head>
  <title>Vibe Out Event Rentals - Layouts</title>
 <link rel="icon" type="image/png" href="favicon.png">
</head>
<body style="margin:0; background-color:#fbf7f0;">

<!-- Header -->
<div style="display:flex; align-items:center; justify-content:space-between; padding:12px 0; position:relative;">

  <!-- Logo (left) -->
  <a href="https://vibeouteventrentals.com/" style="display:block; margin-left:15vw;">

    <img
      src="logo.png"
      alt="Vibe Out Event Rentals logo"
      style="max-width:220px; width:100%; height:auto; display:block;"
    >
  </a>

  <!-- Desktop links (right) -->
  <div class="nav-desktop" style="display:flex; gap:40px; flex-wrap:wrap; padding-right:300px;">
    <a href="https://vibeouteventrentals.com/" style="text-decoration:none; font-weight:600; font-family: Arial, Helvetica, sans-serif;">HOME</a>
    <a href="https://vibeouteventrentals.com/pages/rentals" style="text-decoration:none; font-weight:600; font-family: Arial, Helvetica, sans-serif;">RENTALS</a>
    <a href="https://vibeouteventrentals.com/pages/faqs" style="text-decoration:none; font-weight:600; font-family: Arial, Helvetica, sans-serif;">FAQ's</a>
    <a href="https://vibeouteventrentals.com/pages/contact" style="text-decoration:none; font-weight:600; font-family: Arial, Helvetica, sans-serif;">CONTACT</a>
  </div>

  <!-- Mobile button (right) -->
  <button
    class="nav-toggle"
    onclick="(function(){
      var m = document.getElementById('mobileMenu');
      if (!m) return;
      m.style.display = (m.style.display === 'block') ? 'none' : 'block';
    })();"
    aria-label="Menu"
    style="display:none; margin-right:16px; padding:10px 12px; border:1px solid #ddd; background:#fff; border-radius:8px; font-weight:600;"
  >
    â˜°
  </button>

</div>

<!-- Mobile dropdown menu -->
<div id="mobileMenu" class="nav-mobile"
  style="display:none; padding:8px 16px 16px 16px; border-top:1px solid #eee;">
  <a href="https://vibeouteventrentals.com/" style="display:block; padding:10px 0; text-decoration:none; font-weight:600;">HOME</a>
  <a href="https://vibeouteventrentals.com/pages/rentals" style="display:block; padding:10px 0; text-decoration:none; font-weight:600;">RENTALS</a>
  <a href="https://vibeouteventrentals.com/pages/faqs" style="display:block; padding:10px 0; text-decoration:none; font-weight:600;">FAQ's</a>
  <a href="https://vibeouteventrentals.com/pages/contact" style="display:block; padding:10px 0; text-decoration:none; font-weight:600;">CONTACT</a>
</div>

<!-- Responsive behavior -->
<style>
  @media (max-width: 700px) {
    .nav-desktop { display: none !important; }
    .nav-toggle { display: inline-block !important; }
  }
.nav-desktop a {
    color: #000;
    transition: color 0.2s ease;
  }

  .nav-desktop a:hover {
    color: #c59d5f; /* change to your brand color */
  }
</style>


<iframe src="data:text/html;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAsIHVzZXItc2NhbGFibGU9bm8iPgogICAgPHRpdGxlPlRlbnRNYXBwZXIgSW50ZXJhY3RpdmUgQ2xpZW50IExheW91dDwvdGl0bGU+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG4udGFpbHdpbmRjc3MuY29tIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9pbnRlcmFjdC5qcy8xLjEwLjExL2ludGVyYWN0Lm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvdGhyZWUuanMvcjEyOC90aHJlZS5taW4uanMiPjwvc2NyaXB0PgogICAgPCEtLSBHTEIvR0xURiBsb2FkZXIgc28gZXh0ZXJuYWxseS1ob3N0ZWQgY2hhaXIgbW9kZWxzIGNhbiByZW5kZXIgaW4gZW1iZWQgLS0+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS90aHJlZUAwLjEyOC4wL2V4YW1wbGVzL2pzL2xvYWRlcnMvR0xURkxvYWRlci5qcyI+PC9zY3JpcHQ+CiAgICA8c3R5bGU+CiAgICAgICAgQGltcG9ydCB1cmwoJ2h0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzMj9mYW1pbHk9UG9wcGluczp3Z2h0QDQwMDs3MDA7OTAwJmRpc3BsYXk9c3dhcCcpOwogICAgICAgIGJvZHkgeyBtYXJnaW46MDsgcGFkZGluZzowOyBvdmVyZmxvdzpoaWRkZW47IGZvbnQtZmFtaWx5OiAnUG9wcGlucycsIHNhbnMtc2VyaWY7IGJhY2tncm91bmQ6ICNmMWY1Zjk7IC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7IH0KICAgICAgICAKICAgICAgICAjdmlld3BvcnQtMmQgeyBwb3NpdGlvbjogZml4ZWQ7IGluc2V0OiAwOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsgb3ZlcmZsb3c6IGhpZGRlbjsgYmFja2dyb3VuZDogI2NiZDVlMTsgY3Vyc29yOiBjcm9zc2hhaXI7IH0KICAgICAgICAKICAgICAgICAjc2VsZWN0aW9uLWJveCB7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgYm9yZGVyOiAycHggc29saWQgIzNiODJmNjsgYmFja2dyb3VuZDogcmdiYSg1OSwgMTMwLCAyNDYsIDAuMik7IGRpc3BsYXk6IG5vbmU7IHotaW5kZXg6IDEwMDAwOyBwb2ludGVyLWV2ZW50czogbm9uZTsgfQoKICAgICAgICAjY2FudmFzLXdyYXAgeyBwb3NpdGlvbjogcmVsYXRpdmU7IHRyYW5zZm9ybS1vcmlnaW46IGNlbnRlciBjZW50ZXI7IHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjNzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSk7IH0KICAgICAgICAjY2FudmFzIHsgCiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsgCiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNDBweCA4MHB4IHJnYmEoMCwwLDAsMC4yNSk7IAogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAyMHB4OyB0b3VjaC1hY3Rpb246IG5vbmU7CiAgICAgICAgfQoKICAgICAgICAuaXRlbSB7IAogICAgICAgICAgICBwb3NpdGlvbjphYnNvbHV0ZTsgdXNlci1zZWxlY3Q6bm9uZTsgZGlzcGxheTpmbGV4OyBhbGlnbi1pdGVtczpjZW50ZXI7IGp1c3RpZnktY29udGVudDpjZW50ZXI7IAogICAgICAgICAgICBmb250LXNpemU6IDhweDsgZm9udC13ZWlnaHQ6OTAwOyBib3JkZXI6IDNweCBzb2xpZCAjM2I4MjI2OyBib3JkZXItcmFkaXVzOiA0cHg7IGNvbG9yOiBibGFjazsgCiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsgbGluZS1oZWlnaHQ6IDE7IHBvaW50ZXItZXZlbnRzOiBhdXRvOyB6LWluZGV4OiAxMDA7CiAgICAgICAgfQogICAgICAgIC5pdGVtLnNlbGVjdGVkIHsgCiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogIzA2YjZkNDsgCiAgICAgICAgICAgIGJvcmRlci13aWR0aDogNHB4OyAKICAgICAgICAgICAgYm94LXNoYWRvdzogMCAwIDUwcHggOHB4IHJnYmEoMzQsIDIxMSwgMjM4LCAwLjUpOyAKICAgICAgICAgICAgei1pbmRleDogMjAwMDsgCiAgICAgICAgfQogICAgICAgIC5pdGVtLmNoYWlyLW1vZHVsZSB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7CiAgICAgICAgfQoKICAgICAgICAucm91bmQgeyBib3JkZXItcmFkaXVzOiA1MCUgIWltcG9ydGFudDsgfQogICAgICAgIAogICAgICAgIC5jaGFpci0yZCB7IAogICAgICAgICAgICBwb3NpdGlvbjphYnNvbHV0ZTsgd2lkdGg6IDE2cHg7IGhlaWdodDogMTdweDsgYm9yZGVyLXJhZGl1czogM3B4OyAKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgIzk0YTNiODsgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2Y4ZmFmYyAwJSwgI2UyZThmMCAxMDAlKTsgCiAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lOyB6LWluZGV4OiA1MDsgCiAgICAgICAgICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCAwIDFweCByZ2JhKDAsMCwwLDAuMDYpOwogICAgICAgIH0KICAgICAgICAuY2hhaXItMmQ6OmFmdGVyIHsgCiAgICAgICAgICAgIGNvbnRlbnQ6ICcnOyBwb3NpdGlvbjphYnNvbHV0ZTsgdG9wOiAtM3B4OyBsZWZ0OiAwOyB3aWR0aDogMTAwJTsgaGVpZ2h0OiA0cHg7IAogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuOTUpOyBib3JkZXItYm90dG9tOiAxcHggc29saWQgcmdiYSgwLDAsMCwwLjI1KTsgYm9yZGVyLXJhZGl1czogMXB4IDFweCAwIDA7IAogICAgICAgIH0KICAgICAgICAuY2hhaXItMmRbZGF0YS1jaGFpcj0iZm9sZGluZ19ibGFjayJdIHsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiAjMGYxNzJhOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjMTExODI3IDAlLCAjMzM0MTU1IDEwMCUpOwogICAgICAgICAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgMCAxcHggcmdiYSgyNTUsMjU1LDI1NSwwLjA4KTsKICAgICAgICB9CiAgICAgICAgLmNoYWlyLTJkW2RhdGEtY2hhaXI9ImZvbGRpbmdfYmxhY2siXTo6YWZ0ZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMGIwZjE2OyBib3JkZXItYm90dG9tLWNvbG9yOiByZ2JhKDI1NSwyNTUsMjU1LDAuMTIpOwogICAgICAgIH0KICAgICAgICAuY2hhaXItMmRbZGF0YS1jaGFpcj0iZm9sZGluZ193aGl0ZV9jb21tZXJjaWFsIl0gewogICAgICAgICAgICBib3JkZXItY29sb3I6ICM2NDc0OGI7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmZmZmZmYgMCUsICNlMmU4ZjAgMTAwJSk7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCAwIDFweCByZ2JhKDAsMCwwLDAuMDYpOwogICAgICAgIH0KICAgICAgICAuY2hhaXItMmRbZGF0YS1jaGFpcj0iZm9sZGluZ193aGl0ZV9jb21tZXJjaWFsIl06OmFmdGVyIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwwLjk1KTsKICAgICAgICAgICAgYm9yZGVyLWJvdHRvbS1jb2xvcjogcmdiYSgwLDAsMCwwLjIyKTsKICAgICAgICB9CiAgICAgICAgLmNoYWlyLTJkW2RhdGEtY2hhaXI9IndoaXRlX3Jlc2luX3BhZGRlZCJdIHsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiAjNjQ3NDhiOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDUwJSA1NSUsIHJnYmEoMjU1LDI1NSwyNTUsMC45NSkgMCA1NSUsIHRyYW5zcGFyZW50IDU2JSAxMDAlKSwKICAgICAgICAgICAgICAgICAgICAgICAgbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2ZmZmZmZiAwJSwgI2UyZThmMCAxMDAlKTsKICAgICAgICAgICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMXB4IHJnYmEoMCwwLDAsMC4wNik7CiAgICAgICAgfQogICAgICAgIC5jaGFpci0yZFtkYXRhLWNoYWlyPSJ3aGl0ZV9yZXNpbl9wYWRkZWQiXTo6YWZ0ZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuOTUpOwogICAgICAgICAgICBib3JkZXItYm90dG9tLWNvbG9yOiByZ2JhKDAsMCwwLDAuMjIpOwogICAgICAgIH0KICAgICAgICAuY2hhaXItMmRbZGF0YS1jaGFpcj0iYmxhY2tfcGFkZGVkX2ZvbGRpbmciXSB7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogIzBmMTcyYTsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCA1MCUgNTUlLCByZ2JhKDI1NSwyNTUsMjU1LDAuMTApIDAgNTUlLCB0cmFuc3BhcmVudCA1NiUgMTAwJSksCiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMwYjBmMTYgMCUsICMzMzQxNTUgMTAwJSk7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCAwIDFweCByZ2JhKDI1NSwyNTUsMjU1LDAuMDgpOwogICAgICAgIH0KICAgICAgICAuY2hhaXItMmRbZGF0YS1jaGFpcj0iYmxhY2tfcGFkZGVkX2ZvbGRpbmciXTo6YWZ0ZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMGIwZjE2OyBib3JkZXItYm90dG9tLWNvbG9yOiByZ2JhKDI1NSwyNTUsMjU1LDAuMTIpOwogICAgICAgIH0KCiAgICAgICAgLmNoYWlyLTJkW2RhdGEtY2hhaXI9IndoaXRlX2ZhbmJhY2siXSB7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogIzk0YTNiODsKICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDkwZGVnLCByZ2JhKDE0OCwxNjMsMTg0LDAuMzUpIDAgMnB4LCB0cmFuc3BhcmVudCAycHggOHB4KSwKICAgICAgICAgICAgICAgICAgICAgICAgbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2ZmZmZmZiAwJSwgI2YxZjVmOSAxMDAlKTsKICAgICAgICAgICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMXB4IHJnYmEoMCwwLDAsMC4wNik7CiAgICAgICAgfQogICAgICAgIC5jaGFpci0yZFtkYXRhLWNoYWlyPSJ3aGl0ZV9mYW5iYWNrIl06OmFmdGVyIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwwLjk1KTsKICAgICAgICAgICAgYm9yZGVyLWJvdHRvbS1jb2xvcjogcmdiYSgwLDAsMCwwLjIyKTsKICAgICAgICB9CiAgICAgICAgLmNoYWlyLTJkW2RhdGEtY2hhaXJePSJjaGlhdmFyaV8iXSB7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogcmdiYSgwLDAsMCwwLjE4KTsKICAgICAgICB9CiAgICAgICAgLmNoYWlyLTJkW2RhdGEtY2hhaXI9ImNoaWF2YXJpX2dvbGQiXSB7IGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmN2UwOGEgMCUsICNjODliMmMgMTAwJSk7IH0KICAgICAgICAuY2hhaXItMmRbZGF0YS1jaGFpcj0iY2hpYXZhcmlfc2lsdmVyIl0geyBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZjhmYWZjIDAlLCAjOTRhM2I4IDEwMCUpOyB9CiAgICAgICAgLmNoYWlyLTJkW2RhdGEtY2hhaXI9ImNoaWF2YXJpX3doaXRlIl0geyBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZmZmZmZmIDAlLCAjZTJlOGYwIDEwMCUpOyBib3JkZXItY29sb3I6ICNjYmQ1ZTE7IH0KICAgICAgICAuY2hhaXItMmRbZGF0YS1jaGFpcl49ImNoaWF2YXJpXyJdOjphZnRlciB7IGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC4wKTsgYm9yZGVyLWJvdHRvbS1jb2xvcjogcmdiYSgwLDAsMCwwLjEyKTsgfQogICAgICAgIC5jaGFpci0yZFtkYXRhLWNoYWlyXj0iY2hpYXZhcmlfIl1bZGF0YS1jdXNoaW9uPSIxIl06OmJlZm9yZSB7CiAgICAgICAgICAgIGNvbnRlbnQ6ICcnOyBwb3NpdGlvbjphYnNvbHV0ZTsgaW5zZXQ6IDNweCAzcHggNHB4IDNweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2Y4ZmFmYzsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgwLDAsMCwwLjEyKTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMnB4OwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDFweCAwIHJnYmEoMjU1LDI1NSwyNTUsMC42KSBpbnNldDsKICAgICAgICB9CiAgICAgICAgLmNoYWlyLTJkW2RhdGEtY2hhaXI9InJ1c3RpY19jcm9zc2JhY2siXSwKICAgICAgICAuY2hhaXItMmRbZGF0YS1jaGFpcj0icnVzdGljX2Nyb3NzYmFja19vYWsiXSB7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogIzdjNTIyZDsKICAgICAgICAgICAgYmFja2dyb3VuZDoKICAgICAgICAgICAgICBsaW5lYXItZ3JhZGllbnQoNDVkZWcsIHJnYmEoMCwwLDAsMC4yMikgMCUsIHJnYmEoMCwwLDAsMC4yMikgNiUsIHRyYW5zcGFyZW50IDYlLCB0cmFuc3BhcmVudCA5NCUsIHJnYmEoMCwwLDAsMC4yMikgOTQlLCByZ2JhKDAsMCwwLDAuMjIpIDEwMCUpLAogICAgICAgICAgICAgIGxpbmVhci1ncmFkaWVudCgtNDVkZWcsIHJnYmEoMCwwLDAsMC4yMikgMCUsIHJnYmEoMCwwLDAsMC4yMikgNiUsIHRyYW5zcGFyZW50IDYlLCB0cmFuc3BhcmVudCA5NCUsIHJnYmEoMCwwLDAsMC4yMikgOTQlLCByZ2JhKDAsMCwwLDAuMjIpIDEwMCUpLAogICAgICAgICAgICAgIGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNjMzhiNWEgMCUsICM4YjVhMmIgMTAwJSk7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCAwIDFweCByZ2JhKDAsMCwwLDAuMDgpOwogICAgICAgIH0KICAgICAgICAuY2hhaXItMmRbZGF0YS1jaGFpcj0icnVzdGljX2Nyb3NzYmFjayJdOjphZnRlciwKICAgICAgICAuY2hhaXItMmRbZGF0YS1jaGFpcj0icnVzdGljX2Nyb3NzYmFja19vYWsiXTo6YWZ0ZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuMDYpOyBib3JkZXItYm90dG9tLWNvbG9yOiByZ2JhKDAsMCwwLDAuMjUpOwogICAgICAgIH0KCiAgICAgICAgLml0ZW0tdG9vbGJhciB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgYm90dG9tOiAtMTEwcHg7IGxlZnQ6IDUwJTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsgcGFkZGluZzogMjBweCAzMHB4OyBib3JkZXItcmFkaXVzOiAxMDBweDsgCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7IGdhcDogMThweDsgYm94LXNoYWRvdzogMCAxNXB4IDM1cHggcmdiYSgwLDAsMCwwLjMpOyB6LWluZGV4OiAxMDAwOwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjZTJlOGYwOyBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgIH0KICAgICAgICAucm90YXRlLWhhbmRsZSB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAtOTBweDsgbGVmdDogNTAlOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgICAgICAgIHdpZHRoOiA2NHB4OyBoZWlnaHQ6IDY0cHg7IGJhY2tncm91bmQ6ICMwNmI2ZDQ7IGNvbG9yOiB3aGl0ZTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgICAgICAgZm9udC1zaXplOiAyOHB4OyBjdXJzb3I6IHBvaW50ZXI7IGJvcmRlcjogM3B4IHNvbGlkIHdoaXRlOyBib3gtc2hhZG93OiAwIDZweCAxNXB4IHJnYmEoMCwwLDAsMC4yKTsKICAgICAgICB9CgogICAgICAgIC5jb2xvci1kb3QgeyB3aWR0aDogNDRweDsgaGVpZ2h0OiA0NHB4OyBib3JkZXItcmFkaXVzOiA1MCU7IGJvcmRlcjogM3B4IHNvbGlkICNlZWU7IGN1cnNvcjogcG9pbnRlcjsgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMXM7IGZsZXgtc2hyaW5rOiAwOyB9CiAgICAgICAgLmNvbG9yLWRvdC5hY3RpdmUgeyBib3JkZXItY29sb3I6ICMwNmI2ZDQ7IHRyYW5zZm9ybTogc2NhbGUoMS4xKTsgYm94LXNoYWRvdzogMCAwIDEycHggIzA2YjZkNDsgfQogICAgICAgIAogICAgICAgIC5saW5lbi1tZW51IHsKICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOyBib3R0b206IDEwMCU7IGxlZnQ6IDUwJTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpIHRyYW5zbGF0ZVkoLTIwcHgpOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsgcGFkZGluZzogMTVweDsgYm9yZGVyLXJhZGl1czogMzBweDsgZGlzcGxheTogbm9uZTsgZ2FwOiAxMnB4OwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDIwcHggNTBweCByZ2JhKDAsMCwwLDAuMyk7IGJvcmRlcjogMXB4IHNvbGlkICNlMmU4ZjA7IHotaW5kZXg6IDEwMDE7CiAgICAgICAgfQogICAgICAgIC5saW5lbi1tZW51LmFjdGl2ZSB7IGRpc3BsYXk6IGZsZXg7IH0KCiAgICAgICAgLm1haW4tdG9vbGJhciB7IAogICAgICAgICAgICBwb3NpdGlvbjpmaXhlZDsgYm90dG9tOiAzMHB4OyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsgCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC45KTsgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOyAKICAgICAgICAgICAgcGFkZGluZzogMTBweCAxOHB4OyBib3JkZXItcmFkaXVzOiAxMDBweDsgZGlzcGxheTpmbGV4OyBnYXA6IDhweDsgCiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMCwwLDAsMC4wNSk7IGJveC1zaGFkb3c6IDAgMjBweCA0MHB4IHJnYmEoMCwwLDAsMC4yKTsgei1pbmRleDogNTAwMDsgCiAgICAgICAgfQogICAgICAgIC5idG4geyAKICAgICAgICAgICAgcGFkZGluZzogN3B4IDE2cHg7IGJvcmRlci1yYWRpdXM6IDUwcHg7IGJhY2tncm91bmQ6ICMyNTYzZWI7IAogICAgICAgICAgICBjb2xvcjogd2hpdGU7IGZvbnQtc2l6ZTogOXB4OyBmb250LXdlaWdodDogOTAwOyAKICAgICAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsgbGV0dGVyLXNwYWNpbmc6IDAuNXB4OyBjdXJzb3I6cG9pbnRlcjsgCiAgICAgICAgICAgIGJvcmRlcjpub25lOyB0cmFuc2l0aW9uOiBhbGwgMC4yczsgCiAgICAgICAgfQogICAgICAgIC5idG46YWN0aXZlIHsgdHJhbnNmb3JtOiBzY2FsZSgwLjk1KTsgfQogICAgICAgIC5idG4uYWN0aXZlIHsgYmFja2dyb3VuZDogI2ZhY2MxNTsgY29sb3I6IGJsYWNrOyBib3gtc2hhZG93OiAwIDAgMTVweCByZ2JhKDI1MCwyMDQsMjEsMC41KTsgfQoKICAgICAgICAubmF2LWNvbnRyb2xzIHsgcG9zaXRpb246IGZpeGVkOyBib3R0b206IDQwcHg7IGxlZnQ6IDMwcHg7IGRpc3BsYXk6IGZsZXg7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IGdhcDogOHB4OyB6LWluZGV4OiA1MDAwOyB9CiAgICAgICAgLmhpc3RvcnktY29udHJvbHMgeyBwb3NpdGlvbjogZml4ZWQ7IGJvdHRvbTogNDBweDsgcmlnaHQ6IDMwcHg7IGRpc3BsYXk6IGZsZXg7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IGdhcDogOHB4OyB6LWluZGV4OiA1MDAwOyB9CiAgICAgICAgCiAgICAgICAgLm5hdi1idG4gewogICAgICAgICAgICB3aWR0aDogNDBweDsgaGVpZ2h0OiA0MHB4OyBiYWNrZ3JvdW5kOiB3aGl0ZTsgYm9yZGVyLXJhZGl1czogMTBweDsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IGZvbnQtd2VpZ2h0OiA5MDA7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAyMHB4IHJnYmEoMCwwLDAsMC4xKTsgY3Vyc29yOiBwb2ludGVyOyBib3JkZXI6IDFweCBzb2xpZCAjZWVlOyB0cmFuc2l0aW9uOiBhbGwgMC4yczsgY29sb3I6IGJsYWNrOwogICAgICAgIH0KICAgICAgICAubmF2LWJ0bjpob3ZlciB7IGJhY2tncm91bmQ6ICNmOGZhZmM7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMnB4KTsgfQogICAgICAgIC5uYXYtYnRuOmFjdGl2ZSB7IHRyYW5zZm9ybTogc2NhbGUoMC45NSk7IH0KCiAgICAgICAgI3RocmVlLWNvbnRhaW5lciB7IHBvc2l0aW9uOmZpeGVkOyBpbnNldDowOyB6LWluZGV4OiA0MDAwOyBkaXNwbGF5Om5vbmU7IGJhY2tncm91bmQ6ICM4N0NFRUI7IH0KICAgICAgICAjdGhyZWUtb3ZlcmxheSB7IHBvc2l0aW9uOmZpeGVkOyBpbnNldDowOyB6LWluZGV4OiA0NTAwOyBwb2ludGVyLWV2ZW50czogbm9uZTsgZGlzcGxheTpub25lOyB9CiAgICAgICAgLm92ZXJsYXktYm94IHsgCiAgICAgICAgICAgIHBvc2l0aW9uOmFic29sdXRlOyB0b3A6IDIwcHg7IGxlZnQ6IDIwcHg7IGJhY2tncm91bmQ6IHJnYmEoMTUsIDIzLCA0MiwgMC44NSk7IAogICAgICAgICAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTBweCk7IHBhZGRpbmc6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDIwcHg7IAogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMSk7IGNvbG9yOiB3aGl0ZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmVtYmVkLTNkLWZvb3RlciB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgYm90dG9tOiAzMHB4OyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsgZ2FwOiA4cHg7IHBvaW50ZXItZXZlbnRzOiBhdXRvOyB6LWluZGV4OiA2MDAwOwogICAgICAgIH0KICAgICAgICAuZW1iZWQtM2QtYnRuIHsKICAgICAgICAgICAgcGFkZGluZzogOHB4IDE4cHg7IGJvcmRlci1yYWRpdXM6IDEwMHB4OyBmb250LXdlaWdodDogOTAwOyBmb250LXNpemU6IDEwcHg7CiAgICAgICAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7IGxldHRlci1zcGFjaW5nOiAxcHg7IGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDI1cHggcmdiYSgwLDAsMCwwLjMpOyBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMSk7IHRyYW5zaXRpb246IGFsbCAwLjJzOwogICAgICAgIH0KICAgICAgICAuZW1iZWQtM2QtYnRuLXdoaXRlIHsgYmFja2dyb3VuZDogd2hpdGU7IGNvbG9yOiBibGFjazsgfQogICAgICAgIC5lbWJlZC0zZC1idG4td2hpdGU6aG92ZXIgeyBiYWNrZ3JvdW5kOiAjZjhmYWZjOyB9CiAgICAgICAgLmVtYmVkLTNkLWJ0bi1ibHVlIHsgYmFja2dyb3VuZDogIzI1NjNlYjsgY29sb3I6IHdoaXRlOyBib3JkZXItY29sb3I6ICMzYjgyZjY7IH0KICAgICAgICAuZW1iZWQtM2QtYnRuLWJsdWU6aG92ZXIgeyBiYWNrZ3JvdW5kOiAjMWQ0ZWQ4OyB9CiAgICAgICAgLmVtYmVkLTNkLWJ0bjphY3RpdmUgeyB0cmFuc2Zvcm06IHNjYWxlKDAuOTUpOyB9CiAgICAgICAgCiAgICAgICAgLm9uLXNjcmVlbi1jb250cm9scyB7IHBvc2l0aW9uOmFic29sdXRlOyBib3R0b206IDEwMHB4OyBsZWZ0OiAyMHB4OyByaWdodDogMjBweDsgZGlzcGxheTpmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47IGFsaWduLWl0ZW1zOiBmbGV4LWVuZDsgcG9pbnRlci1ldmVudHM6IG5vbmU7IH0KICAgICAgICAuZHBhZCB7IGRpc3BsYXk6Z3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoMywgNTBweCk7IGdhcDogNXB4OyBwb2ludGVyLWV2ZW50czogYXV0bzsgfQogICAgICAgIC5jb250cm9sLWJ0biB7IHdpZHRoOiA1MHB4OyBoZWlnaHQ6IDUwcHg7IGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC4xNSk7IGJhY2tkcm9wLWZpbHRlcjogYmx1cig1cHgpOyBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMik7IGJvcmRlci1yYWRpdXM6IDEycHg7IGNvbG9yOiB3aGl0ZTsgZGlzcGxheTpmbGV4OyBhbGlnbi1pdGVtczpjZW50ZXI7IGp1c3RpZnktY29udGVudDpjZW50ZXI7IGN1cnNvcjogcG9pbnRlcjsgcG9pbnRlci1ldmVudHM6IGF1dG87IHVzZXItc2VsZWN0OiBub25lOyB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDAuMXM7IGZvbnQtd2VpZ2h0OiA5MDA7IGZvbnQtc2l6ZTogMTRweDsgfQogICAgICAgIC5jb250cm9sLWJ0bjphY3RpdmUgeyBiYWNrZ3JvdW5kOiByZ2JhKDU5LCAxMzAsIDI0NiwgMC41KTsgfQogICAgICAgIC5jb250cm9sLWJ0bi5sb29rOmFjdGl2ZSB7IGJhY2tncm91bmQ6IHJnYmEoMzQsIDIxMSwgMjM4LCAwLjUpOyB9CiAgICAgICAgLmNvbnRyb2wtYnRuLmVsZXZhdGlvbi11cDphY3RpdmUgeyBiYWNrZ3JvdW5kOiByZ2JhKDM0LCAxOTcsIDk0LCAwLjUpOyB9CiAgICAgICAgLmNvbnRyb2wtYnRuLmVsZXZhdGlvbi1kb3duOmFjdGl2ZSB7IGJhY2tncm91bmQ6IHJnYmEoMzQsIDE5NywgOTQsIDAuNSk7IH0KCiAgICAgICAgLndhbGwtdHJpZ2dlciB7IAogICAgICAgICAgICBwb3NpdGlvbjphYnNvbHV0ZTsgYm9yZGVyOiAycHggZGFzaGVkIHJnYmEoMjU1LDI1NSwyNTUsMC4zKTsgY3Vyc29yOnBvaW50ZXI7IHotaW5kZXg6IDIwMDsgCiAgICAgICAgICAgIGRpc3BsYXk6ZmxleDsgYWxpZ24taXRlbXM6Y2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOyBmb250LXNpemU6IDZweDsgZm9udC13ZWlnaHQ6IDkwMDsgY29sb3I6IHdoaXRlOyAKICAgICAgICB9CiAgICAgICAgLndhbGwtdHJpZ2dlci5hY3RpdmUgeyBiYWNrZ3JvdW5kOiAjZjk3MzE2OyBib3JkZXItY29sb3I6ICNmZGJhNzQ7IGJvcmRlci1zdHlsZTogc29saWQ7IGJveC1zaGFkb3c6IDAgNHB4IDEwcHggcmdiYSgyNDksMTE1LDIyLDAuMyk7IH0KICAgICAgICAuc3RhZ2UtcmFpbCB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgxNDgsIDE2MywgMTg0LCAwLjkyKTsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgzMCwgNDEsIDU5LCAwLjY1KTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMnB4OwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDJweCA2cHggcmdiYSgwLDAsMCwwLjE4KTsKICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICAgICAgfQogICAgICAgIC5zdGFnZS1yYWlsLXRyaWdnZXIgewogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgIGJvcmRlcjogMnB4IGRhc2hlZCByZ2JhKDU2LCAxODksIDI0OCwgMC45KTsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSg1NiwgMTg5LCAyNDgsIDAuMDgpOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAzcHg7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogOXB4OwogICAgICAgICAgICBmb250LXdlaWdodDogOTAwOwogICAgICAgICAgICBjb2xvcjogcmdiYSgzMCwgNDEsIDU5LCAwLjkpOwogICAgICAgICAgICB1c2VyLXNlbGVjdDogbm9uZTsKICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IGF1dG87CiAgICAgICAgfQogICAgICAgIC5zdGFnZS1yYWlsLXRyaWdnZXIuYWN0aXZlIHsKICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgcmdiYSgzNCwgMTk3LCA5NCwgMC45NSk7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMzQsIDE5NywgOTQsIDAuMTgpOwogICAgICAgIH0KICAgICAgICAuY291bnRlci1yb3RhdGUgeyBwb3NpdGlvbjogYWJzb2x1dGU7IGxlZnQ6IDUwJTsgdG9wOiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpOyB3aWR0aDogbWF4LWNvbnRlbnQ7IHBvaW50ZXItZXZlbnRzOiBub25lOyB9CgogICAgICAgICN0YWxseS1wYW5lbCB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsgdG9wOiAyMHB4OyByaWdodDogMjBweDsgCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC44KTsgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOyAKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgwLCAwLCAwLCAwLjA1KTsgcGFkZGluZzogMTJweCAxOHB4OyBib3JkZXItcmFkaXVzOiAyMHB4OyAKICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDMwcHggcmdiYSgwLCAwLCAwLCAwLjEpOyB6LWluZGV4OiA1MDAwOwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBnYXA6IDRweDsgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICAgICAgfQogICAgICAgIC50YWxseS1pdGVtIHsgZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyBnYXA6IDIwcHg7IGZvbnQtd2VpZ2h0OiA5MDA7IGZvbnQtc2l6ZTogMTBweDsgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsgdHJhY2tpbmctd2lkZXN0IHRleHQtc2xhdGUtNDAwOyB9CiAgICAgICAgLnRhbGx5LXZhbCB7IGNvbG9yOiAjMjU2M2ViOyB0ZXh0LWFsaWduOiByaWdodDsgfQoKICAgICAgICAjdHV0b3JpYWwtbW9kZS1idG4gewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7IHRvcDogMjBweDsgbGVmdDogMjBweDsgei1pbmRleDogMTAwMDA7CiAgICAgICAgICAgIHBhZGRpbmc6IDhweCAxNnB4OyBib3JkZXItcmFkaXVzOiA1MHB4OyBiYWNrZ3JvdW5kOiB3aGl0ZTsKICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDIwcHggcmdiYSgwLDAsMCwwLjEpOyBib3JkZXI6IDFweCBzb2xpZCAjZTJlOGYwOwogICAgICAgICAgICBmb250LXdlaWdodDogOTAwOyBmb250LXNpemU6IDlweDsgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOyB0cmFuc2l0aW9uOiBhbGwgMC4yczsgZGlzcGxheTogbm9uZTsKICAgICAgICB9CiAgICAgICAgI3R1dG9yaWFsLW1vZGUtYnRuLm9uIHsgYmFja2dyb3VuZDogIzI1NjNlYjsgY29sb3I6IHdoaXRlOyBib3JkZXItY29sb3I6ICMzYjgyZjY7IH0KICAgICAgICAjdHV0b3JpYWwtdGlwIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOyBib3R0b206IDEwMHB4OyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKSB0cmFuc2xhdGVZKDIwcHgpOwogICAgICAgICAgICB6LWluZGV4OiAxMDAwMTsgYmFja2dyb3VuZDogIzBmMTcyYTsgY29sb3I6IHdoaXRlOyBwYWRkaW5nOiAxNHB4IDI0cHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDIwcHg7IGJveC1zaGFkb3c6IDAgMjBweCA1MHB4IHJnYmEoMCwwLDAsMC41KTsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDsgZm9udC1zaXplOiAxMXB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgICAgIG9wYWNpdHk6IDA7IHBvaW50ZXItZXZlbnRzOiBub25lOyB0cmFuc2l0aW9uOiBhbGwgMC4zcyBjdWJpYy1iZXppZXIoMC40LCAwLCAwLjIsIDEpOwogICAgICAgICAgICBtYXgtd2lkdGg6IDMwMHB4OyB3aWR0aDogOTAlOyBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMSk7CiAgICAgICAgfQogICAgICAgICN0dXRvcmlhbC10aXAuYWN0aXZlIHsgb3BhY2l0eTogMTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpIHRyYW5zbGF0ZVkoMCk7IH0KCiAgICAgICAgLyogRHJhcGUgTW9kdWxlIDJEIHN0eWxlcyAqLwogICAgICAgIC5kcmFwZS1wb2ludC0yZCB7CiAgICAgICAgICAgIHdpZHRoOiAxMnB4OyBoZWlnaHQ6IDEycHg7IGJhY2tncm91bmQ6ICNmZmY7IGJvcmRlcjogMnB4IHNvbGlkICMzYjgyZjY7IGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOyBwb2ludGVyLWV2ZW50czogbm9uZTsgei1pbmRleDogMTAxOwogICAgICAgIH0KICAgICAgICAuc2VnLWxhYmVsLWdyb3VwIHsgY3Vyc29yOiBkZWZhdWx0OyBwb2ludGVyLWV2ZW50czogbm9uZTsgfQogICAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KICAgIDxidXR0b24gaWQ9InR1dG9yaWFsLW1vZGUtYnRuIiBvbmNsaWNrPSJ0b2dnbGVUdXRvcmlhbCgpIj5IZWxwIE1vZGU6IE9mZjwvYnV0dG9uPgogICAgPGRpdiBpZD0idHV0b3JpYWwtdGlwIj48L2Rpdj4KCiAgICA8ZGl2IGlkPSJzZWxlY3Rpb24tYm94Ij48L2Rpdj4KICAgIDxkaXYgaWQ9InZpZXdwb3J0LTJkIj4KICAgICAgICA8ZGl2IGlkPSJjYW52YXMtd3JhcCI+CiAgICAgICAgICAgIDxkaXYgaWQ9ImNhbnZhcyI+PC9kaXY+CiAgICAgICAgICAgIDwhLS0gT3ZlcmxheSBmb3IgVGFwZSBNZWFzdXJlIFNWRyAtLT4KICAgICAgICAgICAgPHN2ZyBpZD0idGFwZS1tZWFzdXJlLW92ZXJsYXkiIHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTsgaW5zZXQ6MDsgcG9pbnRlci1ldmVudHM6bm9uZTsgei1pbmRleDoxMDAwMDsgb3ZlcmZsb3c6dmlzaWJsZTsiPjwvc3ZnPgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CgogICAgPGRpdiBpZD0idGFsbHktcGFuZWwiPgogICAgICAgIDxkaXYgY2xhc3M9InRhbGx5LWl0ZW0iPjxzcGFuIGlkPSJ0YWxseS10eXBlLWxhYmVsIj5UZW50PC9zcGFuPiA8c3BhbiBpZD0idGVudC10eXBlIiBjbGFzcz0idGFsbHktdmFsIj4tPC9zcGFuPjwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9InRhbGx5LWl0ZW0iPlRhYmxlcyA8c3BhbiBpZD0iY291bnQtdGFibGVzIiBjbGFzcz0idGFsbHktdmFsIj4wPC9zcGFuPjwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9InRhbGx5LWl0ZW0iPlNlYXRzIDxzcGFuIGlkPSJjb3VudC1zZWF0cyIgY2xhc3M9InRhbGx5LXZhbCI+MDwvc3Bhbj48L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJ0YWxseS1pdGVtIj5PdGhlciA8c3BhbiBpZD0iY291bnQtb3RoZXIiIGNsYXNzPSJ0YWxseS12YWwiPjA8L3NwYW4+PC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGlkPSJ0aHJlZS1jb250YWluZXIiPjwvZGl2PgogICAgPGRpdiBpZD0idGhyZWUtb3ZlcmxheSI+CiAgICAgICAgPGRpdiBjbGFzcz0ib3ZlcmxheS1ib3giPgogICAgICAgICAgICA8aDIgaWQ9IndhbGstbW9kZS10aXRsZSIgY2xhc3M9InRleHQtbGcgZm9udC1ibGFjayBpdGFsaWMgdGV4dC1ibHVlLTQwMCB1cHBlcmNhc2UiPjNEIFdhbGt0aHJvdWdoPC9oMj4KICAgICAgICAgICAgPHAgaWQ9IndhbGstbW9kZS1kZXNjIiBjbGFzcz0idGV4dC1bOXB4XSBmb250LWJvbGQgb3BhY2l0eS02MCBtdC0xIHVwcGVyY2FzZSB0cmFja2luZy13aWRlc3QiPlVzZSBPbnNjcmVlbiBCdXR0b25zIOKAoiBXQVNEIHRvIE1vdmU8L3A+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0iYWJzb2x1dGUgdG9wLTQgcmlnaHQtNCBmbGV4IGdhcC0yIHBvaW50ZXItZXZlbnRzLWF1dG8iPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ3LTEyIGgtMTIgcm91bmRlZC1mdWxsIGJnLWN5YW4tNjAwIHRleHQtd2hpdGUgYm9yZGVyLTIgYm9yZGVyLWN5YW4tNDAwIHNoYWRvdy14bCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBob3ZlcjpiZy1jeWFuLTUwIHRyYW5zaXRpb24tYWxsIiBvbmNsaWNrPSJzbmFwc2hvdDNEKCkiIHRpdGxlPSJDYXB0dXJlIFNjcmVlbnNob3QiPvCfk7g8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgICAgICAKICAgICAgICA8ZGl2IGNsYXNzPSJvbi1zY3JlZW4tY29udHJvbHMiIGlkPSJvbi1zY3JlZW4tY29udHJvbHMiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJkcGFkIj4KICAgICAgICAgICAgICAgIDxkaXY+PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJidG4tbW92ZS1mIiBjbGFzcz0iY29udHJvbC1idG4iIAogICAgICAgICAgICAgICAgICAgICBvbnRvdWNoc3RhcnQ9ImV2ZW50LnByZXZlbnREZWZhdWx0KCk7IHVwZGF0ZU1vdmUoJ2YnLCB0cnVlKSIgb250b3VjaGVuZD0idXBkYXRlTW92ZSgnZicsIGZhbHNlKSIgCiAgICAgICAgICAgICAgICAgICAgIG9ubW91c2Vkb3duPSJ1cGRhdGVNb3ZlKCdmJywgdHJ1ZSkiIG9ubW91c2V1cD0idXBkYXRlTW92ZSgnZicsIGZhbHNlKSIgb25tb3VzZWxlYXZlPSJ1cGRhdGVNb3ZlKCdmJywgZmFsc2UpIj7ihpE8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXY+PC9kaXY+CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIDxkaXYgaWQ9ImJ0bi1tb3ZlLWwiIGNsYXNzPSJjb250cm9sLWJ0biIgCiAgICAgICAgICAgICAgICAgICAgIG9udG91Y2hzdGFydD0iZXZlbnQucHJldmVudERlZmF1bHQoKTsgdXBkYXRlTW92ZSgnbCcsIHRydWUpIiBvbnRvdWNoZW5kPSJ1cGRhdGVNb3ZlKCdsJywgZmFsc2UpIiAKICAgICAgICAgICAgICAgICAgICAgb25tb3VzZWRvd249InVwZGF0ZU1vdmUoJ2wnLCB0cnVlKSIgb25tb3VzZXVwPSJ1cGRhdGVNb3ZlKCdsJywgZmFsc2UpIiBvbm1vdXNlbGVhdmU9InVwZGF0ZU1vdmUoJ2wnLCBmYWxzZSkiPuKGkDwvZGl2PgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJidG4tbW92ZS1iIiBjbGFzcz0iY29udHJvbC1idG4iIAogICAgICAgICAgICAgICAgICAgICBvbnRvdWNoc3RhcnQ9ImV2ZW50LnByZXZlbnREZWZhdWx0KCk7IHVwZGF0ZU1vdmUoJ2InLCB0cnVlKSIgb250b3VjaGVuZD0idXBkYXRlTW92ZSgnYicsIGZhbHNlKSIgCiAgICAgICAgICAgICAgICAgICAgIG9ubW91c2Vkb3duPSJ1cGRhdGVNb3ZlKCdiJywgdHJ1ZSkiIG9ubW91c2V1cD0idXBkYXRlTW92ZSgnYicsIGZhbHNlKSIgb25tb3VzZWxlYXZlPSJ1cGRhdGVNb3ZlKCdiJywgZmFsc2UpIj7ihpM8L2Rpdj4KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgPGRpdiBpZD0iYnRuLW1vdmUtciIgY2xhc3M9ImNvbnRyb2wtYnRuIiAKICAgICAgICAgICAgICAgICAgICAgb250b3VjaHN0YXJ0PSJldmVudC5wcmV2ZW50RGVmYXVsdCgpOyB1cGRhdGVNb3ZlKCdyJywgdHJ1ZSkiIG9udG91Y2hlbmQ9InVwZGF0ZU1vdmUoJ3InLCBmYWxzZSkiIAogICAgICAgICAgICAgICAgICAgICBvbm1vdXNlZG93bj0idXBkYXRlTW92ZSgncicsIHRydWUpIiBvbm1vdXNldXA9InVwZGF0ZU1vdmUoJ3InLCBmYWxzZSkiIG9ubW91c2VsZWF2ZT0idXBkYXRlTW92ZSgncicsIGZhbHNlKSI+4oaSPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxleCBmbGV4LWNvbCBnYXAtNiBpdGVtcy1lbmQgcG9pbnRlci1ldmVudHMtYXV0byI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbGV4IGZsZXgtY29sIGl0ZW1zLWNlbnRlciBnYXAtMSI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxleCBmbGV4LWNvbCBnYXAtMSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRyb2wtYnRuIGVsZXZhdGlvbi11cCAhcm91bmRlZC1mdWxsIiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbnRvdWNoc3RhcnQ9ImV2ZW50LnByZXZlbnREZWZhdWx0KCk7IHVwZGF0ZU1vdmUoJ3VwJywgdHJ1ZSkiIG9udG91Y2hlbmQ9InVwZGF0ZU1vdmUoJ3VwJywgZmFsc2UpIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ubW91c2Vkb3duPSJ1cGRhdGVNb3ZlKCd1cCcsIHRydWUpIiBvbm1vdXNldXA9InVwZGF0ZU1vdmUoJ3VwJywgZmFsc2UpIiBvbm1vdXNlbGVhdmU9InVwZGF0ZU1vdmUoJ3VwJywgZmFsc2UpIj7ilrI8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udHJvbC1idG4gZWxldmF0aW9uLWRvd24gIXJvdW5kZWQtZnVsbCIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb250b3VjaHN0YXJ0PSJldmVudC5wcmV2ZW50RGVmYXVsdCgpOyB1cGRhdGVNb3ZlKCdkb3duJywgdHJ1ZSkiIG9udG91Y2hlbmQ9InVwZGF0ZU1vdmUoJ2Rvd24nLCBmYWxzZSkiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25tb3VzZWRvd249InVwZGF0ZU1vdmUoJ2Rvd24nLCB0cnVlKSIgb25tb3VzZXVwPSJ1cGRhdGVNb3ZlKCdkb3duJywgZmFsc2UpIiBvbm1vdXNlbGVhdmU9InVwZGF0ZU1vdmUoJ2Rvd24nLCBmYWxzZSkiPuKWvDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0ZXh0LXdoaXRlIHRleHQtWzlweF0gZm9udC1ibGFjayB1cHBlcmNhc2UgdHJhY2tpbmctd2lkZXN0IG9wYWNpdHktNTAiPkVsZXZhdGlvbjwvc3Bhbj4KICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgIDxkaXYgaWQ9Imxvb2stY29udHJvbHMiIGNsYXNzPSJmbGV4IGZsZXgtY29sIGl0ZW1zLWNlbnRlciBnYXAtMSI+CiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRleHQtd2hpdGUgdGV4dC1bOXB4XSBmb250LWJsYWNrIHVwcGVyY2FzZSB0cmFja2luZy13aWRlc3Qgb3BhY2l0eS01MCI+TG9vazwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbGV4IGZsZXgtY29sIGl0ZW1zLWNlbnRlciBnYXAtMSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRyb2wtYnRuIGxvb2siIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9udG91Y2hzdGFydD0iZXZlbnQucHJldmVudERlZmF1bHQoKTsgdXBkYXRlTW92ZSgnbG9va1VwJywgdHJ1ZSkiIG9udG91Y2hlbmQ9InVwZGF0ZU1vdmUoJ2xvb2tVcCcsIGZhbHNlKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbm1vdXNlZG93bj0idXBkYXRlTW92ZSgnbG9va1VwJywgdHJ1ZSkiIG9ubW91c2V1cD0idXBkYXRlTW92ZSgnbG9va1VwJywgZmFsc2UpIiBvbm1vdXNlbGVhdmU9InVwZGF0ZU1vdmUoJ2xvb2tVcCcsIGZhbHNlKSI+4payPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsZXggZ2FwLTEiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udHJvbC1idG4gbG9vayIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9udG91Y2hzdGFydD0iZXZlbnQucHJldmVudERlZmF1bHQoKTsgdXBkYXRlTW92ZSgnbG9va0wnLCB0cnVlKSIgb250b3VjaGVuZD0idXBkYXRlTW92ZSgnbG9va0wnLCBmYWxzZSkiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ubW91c2Vkb3duPSJ1cGRhdGVNb3ZlKCdsb29rTCcsIHRydWUpIiBvbm1vdXNldXA9InVwZGF0ZU1vdmUoJ2xvb2tMJywgZmFsc2UpIiBvbm1vdXNlbGVhdmU9InVwZGF0ZU1vdmUoJ2xvb2tMJywgZmFsc2UpIj7il4A8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRyb2wtYnRuIGxvb2siIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbnRvdWNoc3RhcnQ9ImV2ZW50LnByZXZlbnREZWZhdWx0KCk7IHVwZGF0ZU1vdmUoJ2xvb2tSJywgdHJ1ZSkiIG9udG91Y2hlbmQ9InVwZGF0ZU1vdmUoJ2xvb2tSJywgZmFsc2UpIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbm1vdXNlZG93bj0idXBkYXRlTW92ZSgnbG9va1InLCB0cnVlKSIgb25tb3VzZXVwPSJ1cGRhdGVNb3ZlKCdsb29rUicsIGZhbHNlKSIgb25tb3VzZWxlYXZlPSJ1cGRhdGVNb3ZlKCdsb29rUicsIGZhbHNlKSI+4pa2PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250cm9sLWJ0biBsb29rIiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb250b3VjaHN0YXJ0PSJldmVudC5wcmV2ZW50RGVmYXVsdCgpOyB1cGRhdGVNb3ZlKCdsb29rRG93bicsIHRydWUpIiBvbnRvdWNoZW5kPSJ1cGRhdGVNb3ZlKCdsb29rRG93bicsIGZhbHNlKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25tb3VzZWRvd249InVwZGF0ZU1vdmUoJ2xvb2tEb3duJywgdHJ1ZSkiIG9ubW91c2V1cD0idXBkYXRlTW92ZSgnbG9va0Rvd24nLCBmYWxzZSkiIG9ubW91c2VsZWF2ZT0idXBkYXRlTW92ZSgnbG9va0Rvd24nLCBmYWxzZSkiPuKWvDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJlbWJlZC0zZC1mb290ZXIiPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJlbWJlZC0zZC1idG4gZW1iZWQtM2QtYnRuLXdoaXRlIiBvbmNsaWNrPSJ0b2dnbGVWaWV3KCkiPkVESVQ8L2J1dHRvbj4KICAgICAgICAgICAgPGJ1dHRvbiBpZD0iZm9vdGVyLW5pZ2h0LWJ0biIgY2xhc3M9ImVtYmVkLTNkLWJ0biBlbWJlZC0zZC1idG4td2hpdGUiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2siIG9uY2xpY2s9InRvZ2dsZU5pZ2h0TW9kZSgpIj48L2J1dHRvbj4KICAgICAgICAgICAgPGJ1dHRvbiBpZD0iZm9vdGVyLW1vZGUtYnRuIiBjbGFzcz0iZW1iZWQtM2QtYnRuIGVtYmVkLTNkLWJ0bi1ibHVlIiBvbmNsaWNrPSJ0b2dnbGVEcm9uZU1vZGUoKSI+RFJPTkU8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9Im5hdi1jb250cm9scyIgaWQ9Im5hdi1jb250cm9scyI+CiAgICAgICAgPGRpdiBjbGFzcz0ibmF2LWJ0biIgb25jbGljaz0iem9vbSgwLjEpIiB0aXRsZT0iWm9vbSBJbiI+KzwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9Im5hdi1idG4iIG9uY2xpY2s9Inpvb20oLTAuMSkiIHRpdGxlPSJab29tIE91dCI+LTwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9Im5hdi1idG4iIG9uY2xpY2s9InJlc2V0TmF2KCkiIHRpdGxlPSJSZXNldCBOYXZpZ2F0aW9uIj7in7I8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9Imhpc3RvcnktY29udHJvbHMiIGlkPSJoaXN0b3J5LWNvbnRyb2xzIj4KICAgICAgICA8ZGl2IGNsYXNzPSJuYXYtYnRuIiBvbmNsaWNrPSJ1bmRvKCkiIHRpdGxlPSJVbmRvIj7ihqk8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJuYXYtYnRuIiBvbmNsaWNrPSJyZWRvKCkiIHRpdGxlPSJSZWRvIj7ihqo8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9Im1haW4tdG9vbGJhciIgaWQ9Im1haW4tdG9vbGJhciI+CiAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJyb3RhdGVMYXlvdXQoKSIgY2xhc3M9ImJ0biI+8J+UhCBSb3RhdGU8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGlkPSJidG4tdGFwZS1tZWFzdXJlIiBvbmNsaWNrPSJ0b2dnbGVUYXBlTWVhc3VyZSgpIiBjbGFzcz0iYnRuIiBzdHlsZT0iZGlzcGxheTogYmxvY2siPvCfk48gVGFwZTwvYnV0dG9uPgogICAgICAgIDxidXR0b24gb25jbGljaz0idG9nZ2xlVmlldygpIiBjbGFzcz0iYnRuIj7wn4+wIFZpZXcgM0Q8L2J1dHRvbj4KICAgIDwvZGl2PgoKICAgIDxzY3JpcHQ+CiAgICAgICAgY29uc3QgSVRFTV9ERUZTID0geyJyb3VuZC10YWJsZS01ZnQiOnsidHlwZSI6InJvdW5kIiwiZGlhbWV0ZXIiOjUsInNlYXRzIjo4LCJjb2xvciI6IiM1NTZCMkYiLCJkaXNwbGF5TmFtZSI6IjUgZnQgUm91bmQiLCJkZXNjcmlwdGlvbiI6IlN0YW5kYXJkIDYwLWluY2ggY2lyY3VsYXIgdGFibGUuIFNlYXRzIDggZ3Vlc3RzIGNvbWZvcnRhYmx5LiBCZXN0IGZvciB3ZWRkaW5ncyBhbmQgZ2FsYSBkaW5uZXJzIHRvIGZhY2lsaXRhdGUgZmFjZS10by1mYWNlIGNvbnZlcnNhdGlvbi4ifSwiYmFucXVldC10YWJsZS00ZnQiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6NCwiaGVpZ2h0IjoyLjUsInNlYXRzIjo0LCJjb2xvciI6IiM0QjAwODIiLCJkaXNwbGF5TmFtZSI6IjQgZnQgQmFucXVldCIsImRlc2NyaXB0aW9uIjoiQ29tcGFjdCByZWN0YW5ndWxhciB0YWJsZS4gU2VhdHMgNCBndWVzdHMuIE9mdGVuIHVzZWQgZm9yIHJlZ2lzdHJhdGlvbiwgY2FrZSBkaXNwbGF5cywgb3Igc21hbGwgdmVuZG9yIHNldHVwcy4ifSwiYmFucXVldC10YWJsZS02ZnQiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6NiwiaGVpZ2h0IjoyLjUsInNlYXRzIjo2LCJjb2xvciI6IiM0QjAwODIiLCJkaXNwbGF5TmFtZSI6IjYgZnQgQmFucXVldCIsImRlc2NyaXB0aW9uIjoiTWVkaXVtIHJlY3Rhbmd1bGFyIHV0aWxpdHkgdGFibGUuIFNlYXRzIDYgZ3Vlc3RzLiBJZGVhbCBmb3IgYnVmZmV0IGxpbmVzLCBuYXJyb3cgZGluaW5nIHJvd3MsIG9yIHNlbWluYXIgc2VhdGluZy4ifSwiYmFucXVldC10YWJsZS04ZnQiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0IjoyLjUsInNlYXRzIjo4LCJjb2xvciI6IiM0QjAwODIiLCJkaXNwbGF5TmFtZSI6IjggZnQgQmFucXVldCIsImRlc2NyaXB0aW9uIjoiRnVsbC1zaXplIHJlY3Rhbmd1bGFyIHRhYmxlLiBTZWF0cyA4IGd1ZXN0cy4gVGhlIGluZHVzdHJ5IHN0YW5kYXJkIGZvciBoZWFkIHRhYmxlcywgYnVmZmV0IHN0YXRpb25zLCBhbmQgZm9ybWFsIGJhbnF1ZXQgcm93cy4ifSwiaGVhZC10YWJsZS02ZnQiOnsidHlwZSI6ImhlYWQiLCJ3aWR0aCI6NiwiaGVpZ2h0IjoyLjUsInNlYXRzIjozLCJjb2xvciI6IiM0QjAwODIiLCJkaXNwbGF5TmFtZSI6IjYgZnQgSGVhZCIsImRlc2NyaXB0aW9uIjoiT25lLXNpZGVkIHJlY3Rhbmd1bGFyIHRhYmxlLiBTZWF0cyAzIGd1ZXN0cyBvbiB0aGUgZnJvbnQgZmFjZS4gU3BlY2lmaWNhbGx5IGRlc2lnbmVkIGZvciBicmlkYWwgcGFydGllcyBvciBzcGVha2VyIHBhbmVscy4ifSwiaGVhZC10YWJsZS04ZnQiOnsidHlwZSI6ImhlYWQiLCJ3aWR0aCI6OCwiaGVpZ2h0IjoyLjUsInNlYXRzIjo0LCJjb2xvciI6IiM0QjAwODIiLCJkaXNwbGF5TmFtZSI6IjggZnQgSGVhZCIsImRlc2NyaXB0aW9uIjoiTGFyZ2Ugb25lLXNpZGVkIHRhYmxlLiBTZWF0cyA0IGd1ZXN0cyBvbiB0aGUgZnJvbnQgZmFjZS4gVXNlZCB0byBhbmNob3IgdGhlIGZvY3VzIG9mIHRoZSByb29tIGZvciBWSVBzIG9yIHdlZGRpbmcgcGFydGllcy4ifSwidHJhZGUtc2hvdy10YWJsZS02ZnQiOnsidHlwZSI6ImhlYWQiLCJ3aWR0aCI6NiwiaGVpZ2h0IjoyLjUsInNlYXRzIjoyLCJjb2xvciI6IiM0QjAwODIiLCJkaXNwbGF5TmFtZSI6IjYgZnQgVHJhZGUgU2hvdyIsImRlc2NyaXB0aW9uIjoiUmVnaXN0cmF0aW9uLXN0eWxlIHRhYmxlLiBTZWF0cyAyIHN0YWZmIG1lbWJlcnMuIE9wdGltaXplZCBmb3IgdHJhZGUgc2hvdyBib290aHMgd2l0aCBzcGFjZSBmb3IgbGl0ZXJhdHVyZSBhbmQgaW50ZXJhY3Rpb24uIn0sInRyYWRlLXNob3ctdGFibGUtOGZ0Ijp7InR5cGUiOiJoZWFkIiwid2lkdGgiOjgsImhlaWdodCI6Mi41LCJzZWF0cyI6MiwiY29sb3IiOiIjNEIwMDgyIiwiZGlzcGxheU5hbWUiOiI4IGZ0IFRyYWRlIFNob3ciLCJkZXNjcmlwdGlvbiI6IkZ1bGwgdHJhZGUgc2hvdyBkaXNwbGF5IHRhYmxlLiBQcm92aWRlcyBhbXBsZSBzdXJmYWNlIGFyZWEgZm9yIHByb2R1Y3RzIGFuZCBwcm9tb3Rpb25hbCBtYXRlcmlhbHMgYXQgZXhoaWJpdGlvbnMuIn0sImNvY2t0YWlsLXRhYmxlIjp7InR5cGUiOiJyb3VuZCIsImRpYW1ldGVyIjoyLjUsInNlYXRzIjowLCJjb2xvciI6IiMyRjRGNEYiLCJkaXNwbGF5TmFtZSI6IkNvY2t0YWlsIiwiZGVzY3JpcHRpb24iOiJIaWdoLXRvcCAnYmlzdHJvJyB0YWJsZS4gTm8gc2VhdGluZyBwcm92aWRlZC4gRW5jb3VyYWdlcyBndWVzdCBtaW5nbGluZyBhbmQgc2VydmVzIGFzIGEgbGFuZGluZyBzcG90IGZvciBkcmlua3MgZHVyaW5nIHJlY2VwdGlvbnMuIn0sImNoYWlyLXNpbmdsZSI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoxLjgsImhlaWdodCI6Miwic2VhdHMiOjEsImNvbG9yIjoiI2U1ZTdlYiIsImRpc3BsYXlOYW1lIjoiQ2hhaXIiLCJkZXNjcmlwdGlvbiI6IlNpbmdsZSBjaGFpciAoaW5kZXBlbmRlbnQgb2YgdGFibGUgc2VhdGluZykuIFVzZSBmb3IgY2VyZW1vbnkgcm93cywgY2xhc3Nyb29tIGxheW91dHMsIG9yIGZyZWUtZm9ybSBzZWF0aW5nLiJ9LCJjaGFpci1yb3ciOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6MjAsImhlaWdodCI6NCwic2VhdHMiOjEwLCJjb2xvciI6IiNlNWU3ZWIiLCJkaXNwbGF5TmFtZSI6IkNoYWlyIFJvdyIsImRlc2NyaXB0aW9uIjoiUm93IG9mIGNoYWlycyB3aXRoIGEgcmlnaHQtc2lkZSByZXNpemUgaGFuZGxlLiBTdXBwb3J0cyBhIHNpbXBsZSBjdXJ2ZSAoYm93KSBmb3IgY2VyZW1vbnktc3R5bGUgc2VhdGluZy4ifSwiY2hhaXItY2lyY2xlIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjMwLCJoZWlnaHQiOjMwLCJzZWF0cyI6NjQsImNvbG9yIjoiI2U1ZTdlYiIsImRpc3BsYXlOYW1lIjoiQ2lyY2xlIFNlYXRpbmciLCJkZXNjcmlwdGlvbiI6IkZ1bGwgY2lyY2xlIHNlYXRpbmcgYXJvdW5kIGEgZml4ZWQgMTUnIHggMTUnIGNlbnRlciB2b2lkLCB3aXRoIDQgZGlhZ29uYWwgYWlzbGVzIChORS9TRS9TVy9OVykuIFJlc2l6aW5nIGdyb3dzIG91dHdhcmQgYnkgYWRkaW5nL3JlbW92aW5nIE9VVEVSIHJvd3Mgb25seS4ifSwicGVyc29uLXRoZS1yZW50YWwtZ3V5Ijp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjIuNSwiaGVpZ2h0IjoyLjUsInNlYXRzIjowLCJjb2xvciI6IiNmNTllMGIiLCJkaXNwbGF5TmFtZSI6IlRoZSBSZW50YWwgR3V5IiwiZGVzY3JpcHRpb24iOiIzRCBhdmF0YXIgbW9kZWwgKFRoZSBSZW50YWwgR3V5KS4gRmFsbHMgYmFjayB0byBhIGJhc2ljIHBlcnNvbiBwbGFjZWhvbGRlciBpZiB0aGUgR0xCIGNhbid0IGxvYWQuIn0sInBlcnNvbi1iYXNpYyI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoyLjUsImhlaWdodCI6Mi41LCJzZWF0cyI6MCwiY29sb3IiOiIjOTRhM2I4IiwiZGlzcGxheU5hbWUiOiJQZXJzb24gKEJhc2ljKSIsImRlc2NyaXB0aW9uIjoiU2ltcGxlIHBlcnNvbiBwbGFjZWhvbGRlciBmb3IgbGF5b3V0cy4ifSwicGVyc29uLWdyb29tIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjIuNSwiaGVpZ2h0IjoyLjUsInNlYXRzIjowLCJjb2xvciI6IiNmOTczMTYiLCJkaXNwbGF5TmFtZSI6Ikdyb29tIiwiZGVzY3JpcHRpb24iOiIzRCBncm9vbSAoNiBmdCB0YWxsKS4gVXNlZnVsIGZvciBjZXJlbW9ueSBtb2NrdXBzLCBlbnRyYW5jZXMsIGFuZCBzcGFjaW5nIHZpc3VhbHMuIn0sInBlcnNvbi1icmlkZSI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoyLjUsImhlaWdodCI6Mi41LCJzZWF0cyI6MCwiY29sb3IiOiIjZmI3MTg1IiwiZGlzcGxheU5hbWUiOiJCcmlkZSIsImRlc2NyaXB0aW9uIjoiM0QgYnJpZGUgKDUgZnQgNSBpbikuIFVzZWZ1bCBmb3IgY2VyZW1vbnkgbW9ja3VwcywgZW50cmFuY2VzLCBhbmQgc3BhY2luZyB2aXN1YWxzLiJ9LCJwZXJzb24tanVzdGljZS1vZi1wZWFjZSI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoyLjUsImhlaWdodCI6Mi41LCJzZWF0cyI6MCwiY29sb3IiOiIjYTc4YmZhIiwiZGlzcGxheU5hbWUiOiJKdXN0aWNlIG9mIHRoZSBQZWFjZSIsImRlc2NyaXB0aW9uIjoiM0Qgb2ZmaWNpYW50IHBsYWNlaG9sZGVyICg2IGZ0KS4gSGVscHMgdmlzdWFsaXplIGNlcmVtb255IGZvY2FsIHBvaW50IGFuZCBhaXNsZSBhbGlnbm1lbnQuIn0sImJhci0zLWJhcnJlbCI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo4LCJoZWlnaHQiOjIuNSwic2VhdHMiOjAsImNvbG9yIjoiIzdCM0Y2MSIsImRpc3BsYXlOYW1lIjoiMyBCYXJyZWwgQmFyICg4IGZ0KSIsImRlc2NyaXB0aW9uIjoiMy1iYXJyZWwgYmFyIHNlcnZpY2UgY291bnRlciAoOCBmdCBsb25nKS4gR3JlYXQgZm9yIGJldmVyYWdlIHNlcnZpY2UsIGNvY2t0YWlsIGhvdXIsIG9yIGZlYXR1cmUgYmFyIHNldHVwcy4ifSwicGF0aW8taGVhdGVyIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjIsImhlaWdodCI6Miwic2VhdHMiOjAsImNvbG9yIjoiIzY0NzQ4YiIsImRpc3BsYXlOYW1lIjoiUGF0aW8gSGVhdGVyIiwiZGVzY3JpcHRpb24iOiJTdGFuZGluZyBwYXRpbyBoZWF0ZXIgKDcgZnQgdGFsbCkuIFVzZSBmb3Igb3V0ZG9vciBsb3VuZ2VzLCB0ZW50IGVkZ2VzLCBvciBlbnRyYW5jZSBjb21mb3J0IHpvbmVzLiJ9LCJvZmZpY2UtY2hhaXIiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6MiwiaGVpZ2h0IjoyLCJzZWF0cyI6MCwiY29sb3IiOiIjZTVlN2ViIiwiZGlzcGxheU5hbWUiOiJPZmZpY2UgQ2hhaXIiLCJkZXNjcmlwdGlvbiI6IlN0YW5kYXJkIG9mZmljZSBjaGFpciAoMzUgaW4gdGFsbCkuIFVzZWZ1bCBmb3IgYmFja3N0YWdlLCB0ZWNoIHRhYmxlcywgcmVnaXN0cmF0aW9uLCBvciBvZmZpY2Utc3R5bGUgbGF5b3V0cy4ifSwiZGVjb3ItY2lyY2xlLWFyY2giOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6NywiaGVpZ2h0IjoxLjUsInNlYXRzIjowLCJjb2xvciI6IiNkOTQ2ZWYiLCJkaXNwbGF5TmFtZSI6IkNpcmNsZSBBcmNoIiwiZGVzY3JpcHRpb24iOiJDaXJjbGUgY2VyZW1vbnkgYXJjaCAoNyBmdCB0YWxsKS4gVXNlIGZvciBiYWNrZHJvcHMsIHBob3RvIG1vbWVudHMsIG9yIGNlcmVtb255IGZvY2FsIHBvaW50cy4ifSwiZGVjb3ItYmFycmVsLWFyY2giOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0IjoyLCJzZWF0cyI6MCwiY29sb3IiOiIjYzAyNmQzIiwiZGlzcGxheU5hbWUiOiJCYXJyZWwgQXJjaCIsImRlc2NyaXB0aW9uIjoiQmFycmVsIGFyY2ggYmFja2Ryb3AgKDggZnQgdGFsbCkuIFN0cm9uZyBzdGF0ZW1lbnQgcGllY2UgZm9yIGNlcmVtb25pZXMsIHBob3RvIG9wcywgb3IgZW50cmFuY2VzLiJ9LCJpbmZsYXRhYmxlLW9ic3RhY2xlLWNvdXJzZSI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoyMCwiaGVpZ2h0IjoxMCwic2VhdHMiOjAsImNvbG9yIjoiIzIyYzU1ZSIsImRpc3BsYXlOYW1lIjoiT2JzdGFjbGUgQ291cnNlIChDb2xvcmZ1bCkiLCJkZXNjcmlwdGlvbiI6IkNvbG9yZnVsIGluZmxhdGFibGUgb2JzdGFjbGUgY291cnNlLiBVc2UgZm9yIGZlc3RpdmFscywgc2Nob29sIGV2ZW50cywgYW5kIGJpZyBiYWNreWFyZCBwYXJ0aWVzLiJ9LCJmb2xpYWdlLWhlZGdlIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjQsImhlaWdodCI6MS41LCJzZWF0cyI6MCwiY29sb3IiOiIjMTZhMzRhIiwiZGlzcGxheU5hbWUiOiJHcmVlbiBIZWRnZSAoNCBmdCkiLCJkZXNjcmlwdGlvbiI6IjQgZnQgdGFsbCBoZWRnZSBwYW5lbC4gVXNlIGZvciBiYWNrZHJvcCB3YWxscywgZW50cmFuY2UgcnVucywgb3Igc3BhY2UgZGl2aWRlcnMuIn0sImRqLXRhYmxlIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjYsImhlaWdodCI6Mi41LCJzZWF0cyI6MCwiY29sb3IiOiIjNzA4MDkwIiwiZGlzcGxheU5hbWUiOiJESiBUYWJsZSIsImRlc2NyaXB0aW9uIjoiU3BlY2lhbGl6ZWQgYm9vdGggZm9yIG11c2ljIGVxdWlwbWVudC4gUG9zaXRpb25lZCBuZWFyIHRoZSBkYW5jZSBmbG9vciB0byBjZW50cmFsaXplIHNvdW5kIGNvbnRyb2wgYW5kIGVudGVydGFpbm1lbnQuIn0sImdpZnQtdGFibGUiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6NiwiaGVpZ2h0IjoyLjUsInNlYXRzIjowLCJjb2xvciI6IiNDMDQwMDAiLCJkaXNwbGF5TmFtZSI6IkdpZnQgVGFibGUiLCJkZXNjcmlwdGlvbiI6IkRlc2lnbmF0ZWQgYXJlYSBmb3IgZ3Vlc3QgY29udHJpYnV0aW9ucy4gVXN1YWxseSBwbGFjZWQgbmVhciB0aGUgZW50cmFuY2UgdG8gc3RyZWFtbGluZSBndWVzdCBhcnJpdmFsIGFuZCBncmVldGluZ3MuIn0sImNvZmZlZS1zdGF0aW9uIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjYsImhlaWdodCI6Mi41LCJzZWF0cyI6MCwiY29sb3IiOiIjM0YzQjFCIiwiZGlzcGxheU5hbWUiOiJDb2ZmZWUgU3RhdGlvbiIsImRlc2NyaXB0aW9uIjoiUmVmcmVzaG1lbnQgaHViLiBEZXNpZ25lZCB0byBob2xkIHVybnMsIGNyZWFtZXJzLCBhbmQgc3RpcnJlcnMgZm9yIGJldmVyYWdlIHNlcnZpY2UgdGhyb3VnaG91dCB0aGUgZXZlbnQuIn0sImJhci1iYWNrLXRhYmxlIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjYsImhlaWdodCI6Mi41LCJzZWF0cyI6MCwiY29sb3IiOiIjNjk0NTM0IiwiZGlzcGxheU5hbWUiOiJCYXIgQmFjayIsImRlc2NyaXB0aW9uIjoiSGlkZGVuIHV0aWxpdHkgdGFibGUgcGxhY2VkIGJlaGluZCB0aGUgbWFpbiBiYXIuIFByb3ZpZGVzIGVzc2VudGlhbCBzdG9yYWdlIGZvciBnbGFzc3dhcmUsIGljZSwgYW5kIGJhY2t1cCBpbnZlbnRvcnkuIn0sImNlZGFyLWJhciI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo1LCJoZWlnaHQiOjIsInNlYXRzIjowLCJjb2xvciI6IiNDRDg1M0YiLCJkaXNwbGF5TmFtZSI6IkNlZGFyIEJhciIsImRlc2NyaXB0aW9uIjoiUnVzdGljIHNlcnZpY2UgY291bnRlci4gSGFuZGNyYWZ0ZWQgd29vZCBmaW5pc2ggdXNlZCBmb3Igc2VydmluZyBhbGNvaG9sIG9yIHNwZWNpYWx0eSBjb2NrdGFpbHMgd2l0aCBoaWdoIHZpc3VhbCBhcHBlYWwuIn0sImluZmluaXR5LWJhciI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo2LCJoZWlnaHQiOjMsInNlYXRzIjowLCJjb2xvciI6IiM3QjNGNjEiLCJkaXNwbGF5TmFtZSI6IkluZmluaXR5IEJhciIsImRlc2NyaXB0aW9uIjoiTW9kZXJuLCBoaWdoLWdsb3NzIHNlcnZpY2UgY291bnRlci4gTGFyZ2Ugc3VyZmFjZSBhcmVhIGRlc2lnbmVkIGZvciBmYXN0LXBhY2VkIGRyaW5rIHNlcnZpY2UgYW5kIHByZW1pdW0gYnJhbmRpbmcuIn0sImRhbmNlLWZsb29yLTEyeDEyIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjEyLCJoZWlnaHQiOjEyLCJzZWF0cyI6MCwiY29sb3IiOiIjOEI0NTEzIiwiZGlzcGxheU5hbWUiOiIxMngxMiBGbG9vciIsImRlc2NyaXB0aW9uIjoiQ29tcGFjdCBkYW5jZSBhcmVhLiBTdWl0YWJsZSBmb3IgaW50aW1hdGUgcGFydGllcyBvZiB1cCB0byAzMCBwZW9wbGUgdG8gZW5qb3kgZGFuY2luZyBpbiBhIHNtYWxsZXIgdmVudWUgZm9vdHByaW50LiJ9LCJkYW5jZS1mbG9vci0xNXgxNSI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoxNSwiaGVpZ2h0IjoxNSwic2VhdHMiOjAsImNvbG9yIjoiIzhCNDUxMyIsImRpc3BsYXlOYW1lIjoiMTV4MTUgRmxvb3IiLCJkZXNjcmlwdGlvbiI6Ik1lZGl1bSBkYW5jZSBmbG9vci4gVGhlIG1vc3QgcG9wdWxhciBzaXplIGZvciBtaWQtc2l6ZWQgd2VkZGluZ3MsIGFjY29tbW9kYXRpbmcgYXBwcm94aW1hdGVseSA0MC01MCBkYW5jZXJzIGF0IG9uY2UuIn0sImRhbmNlLWZsb29yLTE4eDE4Ijp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjE4LCJoZWlnaHQiOjE4LCJzZWF0cyI6MCwiY29sb3IiOiIjOEI0NTEzIiwiZGlzcGxheU5hbWUiOiIxOHgxOCBGbG9vciIsImRlc2NyaXB0aW9uIjoiTGFyZ2UgcHJvZmVzc2lvbmFsIGRhbmNlIGZsb29yLiBCdWlsdCBmb3IgY29ycG9yYXRlIGV2ZW50cyBhbmQgbGFyZ2VyIHdlZGRpbmdzIG9mIG92ZXIgMTUwIGd1ZXN0cy4ifSwiZGFuY2UtZmxvb3ItMjF4MjEiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6MjEsImhlaWdodCI6MjEsInNlYXRzIjowLCJjb2xvciI6IiM4QjQ1MTMiLCJkaXNwbGF5TmFtZSI6IjIxeDIxIEZsb29yIiwiZGVzY3JpcHRpb24iOiJQcmVtaWVyIHNpemVkIGRhbmNlIGFyZWEuIERlc2lnbmVkIGZvciBoaWdoLWNhcGFjaXR5IGV2ZW50cyByZXF1aXJpbmcgYSBncmFuZCBjZW50ZXItc3RhZ2UgZm9yIGVudGVydGFpbm1lbnQgYW5kIG1vdmVtZW50LiJ9LCJzdGFnZS00eDQiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6NCwiaGVpZ2h0Ijo0LCJzZWF0cyI6MCwiY29sb3IiOiIjMTExMTExIiwiZGlzcGxheU5hbWUiOiI0eDQgU3RhZ2UiLCJkZXNjcmlwdGlvbiI6IlNpbmdsZSBCaWwtSmF4IHN0YWdlIG1vZHVsZS4gVXNlZCBhcyBhIHBvZGl1bSBiYXNlLCBkcnVtIHJpc2VyLCBvciBhcyBhIGJ1aWxkaW5nIGJsb2NrIGZvciBsYXJnZXIgY3VzdG9tIHN0YWdlIGNvbmZpZ3VyYXRpb25zLiJ9LCJzdGFnZS04eDgiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0Ijo4LCJzZWF0cyI6MCwiY29sb3IiOiIjMTExMTExIiwiZGlzcGxheU5hbWUiOiI4eDggU3RhZ2UiLCJkZXNjcmlwdGlvbiI6IlNxdWFyZSBwZXJmb3JtYW5jZSBwbGF0Zm9ybS4gSWRlYWwgZm9yIHNvbG8gcGVyZm9ybWVycywgc21hbGwgYWNvdXN0aWMgZHVvcywgb3IgZWxldmF0ZWQgVklQIGxvdW5nZSBhcmVhcy4ifSwic3RhZ2UtOHgxMiI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoxMiwiaGVpZ2h0Ijo4LCJzZWF0cyI6MCwiY29sb3IiOiIjMTExMTExIiwiZGlzcGxheU5hbWUiOiI4eDEyIFN0YWdlIiwiZGVzY3JpcHRpb24iOiJQcm9mZXNzaW9uYWwgcmVjdGFuZ3VsYXIgc3RhZ2UuIEFtcGxlIHNwYWNlIGZvciBzbWFsbCBiYW5kcyBvciBsYXJnZSBwcmVzZW50ZXIgcGFuZWxzIHdpdGggbXVsdGlwbGUgY2hhaXJzLiJ9LCJzdGFnZS0xMngxNiI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoxNiwiaGVpZ2h0IjoxMiwic2VhdHMiOjAsImNvbG9yIjoiIzExMTExMSIsImRpc3BsYXlOYW1lIjoiMTJ4MTYgU3RhZ2UiLCJkZXNjcmlwdGlvbiI6IkdyYW5kIHBlcmZvcm1hbmNlIHN0YWdlLiBTdWl0YWJsZSBmb3IgZnVsbCA1LTYgcGllY2UgYmFuZHMgd2l0aCBzb3VuZCBlcXVpcG1lbnQgYW5kIGxpZ2h0aW5nIHJpZ3MuIn0sInN0YWdlLTEyeDI0Ijp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjI0LCJoZWlnaHQiOjEyLCJzZWF0cyI6MCwiY29sb3IiOiIjMTExMTExIiwiZGlzcGxheU5hbWUiOiIxMngyNCBTdGFnZSIsImRlc2NyaXB0aW9uIjoiUHJlbWllciBjb25jZXJ0LXNpemVkIHN0YWdlLiBEZXNpZ25lZCBmb3IgbWFqb3IgY29ycG9yYXRlIHByZXNlbnRhdGlvbnMsIHJ1bndheSBmYXNoaW9uIHNob3dzLCBvciBvcmNoZXN0cmFsIGVuc2VtYmxlcy4ifSwiY3VzdG9tLTRmdCI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo0LCJoZWlnaHQiOjIuNSwic2VhdHMiOjQsImNvbG9yIjoiIzU1NSIsImRpc3BsYXlOYW1lIjoiQ3VzdG9tIDRmdCIsImRlc2NyaXB0aW9uIjoiVXNlci1kZWZpbmVkIDRmdCB0YWJsZS4gRnVsbHkgY3VzdG9taXphYmxlIGxhYmVsIGZvciBzcGVjaWZpYyBsb2dpc3RpY2FsIG5lZWRzIGxpa2UgJ0Nha2UgVGFibGUnIG9yICdFc2NvcnQgQ2FyZHMnLiJ9LCJjdXN0b20tNmZ0Ijp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjYsImhlaWdodCI6Mi41LCJzZWF0cyI6NiwiY29sb3IiOiIjNTU1IiwiZGlzcGxheU5hbWUiOiJDdXN0b20gNmZ0IiwiZGVzY3JpcHRpb24iOiJVc2VyLWRlZmluZWQgNmZ0IHRhYmxlLiBGbGV4aWJsZSByZWN0YW5ndWxhciB1dGlsaXR5IHRoYXQgY2FuIGJlIG5hbWVkIHRvIGZpdCBhbnkgZXZlbnQtc3BlY2lmaWMgcm9sZS4ifSwiY3VzdG9tLThmdCI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo4LCJoZWlnaHQiOjIuNSwic2VhdHMiOjgsImNvbG9yIjoiIzU1NSIsImRpc3BsYXlOYW1lIjoiQ3VzdG9tIDhmdCIsImRlc2NyaXB0aW9uIjoiVXNlci1kZWZpbmVkIDhmdCB0YWJsZS4gTWF4aW1pemVzIHN1cmZhY2UgYXJlYSBmb3IgY3VzdG9tIHJlcXVpcmVtZW50cyBsaWtlICdTaWxlbnQgQXVjdGlvbicgb3IgJ01haW4gQnVmZmV0Jy4ifSwiZHJhcGUtcGlwZS1hbmQtYmFzZSI6eyJ0eXBlIjoiZHJhcGUiLCJzZWF0cyI6MCwiY29sb3IiOiIjMzMzIiwiZGlzcGxheU5hbWUiOiJQaXBlICYgRHJhcGUiLCJkZXNjcmlwdGlvbiI6Ik1vZHVsYXIgZmFicmljIHdhbGwgc3lzdGVtLiBVc2VkIGZvciByb29tIGRpdmlzaW9uLCBtYXNraW5nIHVuc2lnaHRseSBhcmVhcywgb3IgY3JlYXRpbmcgZHJhbWF0aWMgYmFja2Ryb3BzIGJlaGluZCBzdGFnZXMuIn0sIm1vZGVybi1sb3VuZ2UtYXJtbGVzcyI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjozLCJoZWlnaHQiOjMsInNlYXRzIjowLCJjb2xvciI6IiMxMTExMTEiLCJkaXNwbGF5TmFtZSI6IkFybWxlc3MgTG91bmdlIiwiZGVzY3JpcHRpb24iOiJBIHNsZWVrIHN0YW5kYWxvbmUgYXJtbGVzcyBsb3VuZ2UgY2hhaXIgdGhhdCBhbHNvIGludGVncmF0ZXMgc2VhbWxlc3NseSBpbnRvIG1vZHVsYXIgbG91bmdlIHNldHVwcy4ifSwibW9kZXJuLWxvdW5nZS1vdHRvbWFuIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjMsImhlaWdodCI6Mywic2VhdHMiOjAsImNvbG9yIjoiIzExMTExMSIsImRpc3BsYXlOYW1lIjoiTG91bmdlIE90dG9tYW4iLCJkZXNjcmlwdGlvbiI6IkEgc2xlZWsgbW9kdWxhciBvdHRvbWFuIGRlc2lnbmVkIHRvIHBhaXIgd2l0aCBvdXIgTW9kZXJuIExvdW5nZSBjb2xsZWN0aW9uLiJ9LCJtb2Rlcm4tbG91bmdlLWNvcm5lciI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjozLCJoZWlnaHQiOjMsInNlYXRzIjowLCJjb2xvciI6IiMxMTExMTEiLCJkaXNwbGF5TmFtZSI6IkNvcm5lciBMb3VuZ2UiLCJkZXNjcmlwdGlvbiI6IkEgcHJlbWl1bSBtb2R1bGFyIGNvcm5lciBjaGFpciBmb3IgVklQIGFyZWFzLCBjb3Jwb3JhdGUgbG91bmdlcywgd2VkZGluZ3MsIGFuZCB1cHNjYWxlIGV2ZW50cy4ifSwibW9kZXJuLWxvdW5nZS1sb3Zlc2VhdC1pdm9yeSI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo1LCJoZWlnaHQiOjIuNSwic2VhdHMiOjIsImNvbG9yIjoiI2ZmZmZmMCIsImRpc3BsYXlOYW1lIjoiSXZvcnkgTG92ZXNlYXQiLCJkZXNjcmlwdGlvbiI6Ikx1eHVyaW91cyBpdm9yeSBmYXV4LWxlYXRoZXIgbG92ZXNlYXQgd2l0aCBhIGhpZ2ggdHVmdGVkIGJhY2suIFNlYXRzIDIgZ3Vlc3RzLiJ9LCJtb2Rlcm4tbG91bmdlLWNvZmZlZS1pbmZpbml0eSI6eyJ0eXBlIjoicm91bmQiLCJkaWFtZXRlciI6Mywic2VhdHMiOjAsImNvbG9yIjoiIzExMTExMSIsImRpc3BsYXlOYW1lIjoiSW5maW5pdHkgTEVEIFRhYmxlIiwiZGVzY3JpcHRpb24iOiJtZXNtZXJpYyBjaXJjdWxhciBjb2ZmZWUgdGFibGUgd2l0aCBpbmZpbml0eSBtaXJyb3IgTEVEIGVmZmVjdHMuIn0sIm1vZGVybi1sb3VuZ2UtY29mZmVlLWxlZCI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo0LCJoZWlnaHQiOjIsInNlYXRzIjowLCJjb2xvciI6IiNlMGYyZmUiLCJkaXNwbGF5TmFtZSI6IkxFRCBDb2ZmZWUgVGFibGUiLCJkZXNjcmlwdGlvbiI6IlJlY3Rhbmd1bGFyIGNvZmZlZSB0YWJsZSB3aXRoIHNvZnQgaW50ZXJuYWwgTEVEIGlsbHVtaW5hdGlvbi4ifSwibW9kZXJuLWxvdW5nZS1jdWJlLWxlZCI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoxLjMzLCJoZWlnaHQiOjEuMzMsInNlYXRzIjoxLCJjb2xvciI6IiMwMGYyZmYiLCJkaXNwbGF5TmFtZSI6IkxFRCBHbG93IEN1YmUiLCJkZXNjcmlwdGlvbiI6IldpcmVsZXNzIDE2LWluY2ggUkdCIGdsb3dpbmcgY3ViZS4gVXNlIGFzIGEgY2hhaXIgb3IgYWNjZW50IHRhYmxlLiJ9LCJtb2Rlcm4tbG91bmdlLWVuZC10YWJsZS1ibGFjayI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoyLCJoZWlnaHQiOjIsInNlYXRzIjowLCJjb2xvciI6IiMxMTExMTEiLCJkaXNwbGF5TmFtZSI6IkJsYWNrIEVuZCBUYWJsZSIsImRlc2NyaXB0aW9uIjoiQ2xhc3NpYyAyNC1pbmNoIGJsYWNrIHNxdWFyZSBlbmQgdGFibGUgZm9yIGxvdW5nZSBncm91cHMuIn0sIm1vZGVybi1sb3VuZ2UtY2x1Yi1jaGFpci1ibGFjayI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoyLjUsImhlaWdodCI6Mi41LCJzZWF0cyI6MSwiY29sb3IiOiIjMTExMTExIiwiZGlzcGxheU5hbWUiOiJCbGFjayBDbHViIENoYWlyIiwiZGVzY3JpcHRpb24iOiJTdGF0ZWx5IGJsYWNrIGJvbmRlZCBsZWF0aGVyIGNsdWIgY2hhaXIgd2l0aCBkZWVwIHNlYXRpbmcgY29tZm9ydC4ifSwidHJ1c3Mtc2VjdGlvbiI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoxMCwiaGVpZ2h0IjoxLCJzZWF0cyI6MCwiY29sb3IiOiIjZTJlOGYwIiwiZGlzcGxheU5hbWUiOiIxMGZ0IFRydXNzIiwiZGVzY3JpcHRpb24iOiJIb3Jpem9udGFsIDEyaW4gc3F1YXJlIHR1YnVsYXIgdHJ1c3Npbmcgc2VjdGlvbi4ifSwidHJ1c3MtdG90ZW0iOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6Mi41LCJoZWlnaHQiOjIuNSwic2VhdHMiOjAsImNvbG9yIjoiI2NiZDVlMSIsImRpc3BsYXlOYW1lIjoiVHJ1c3MgVG90ZW0iLCJkZXNjcmlwdGlvbiI6IlZlcnRpY2FsIDEyaW4gYm94IHRydXNzIG1vdW50ZWQgb24gYSBoZWF2eSBiYXNlIHBsYXRlLiBJZGVhbCBmb3IgbGlnaHRpbmcgZml4dHVyZXMgb3IgVFYgbW91bnRzLiJ9LCJwaWNuaWMtdGFibGUtY2xhc3NpYyI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo4LCJoZWlnaHQiOjUsInNlYXRzIjo4LCJjb2xvciI6IiM4QjVFM0MiLCJkaXNwbGF5TmFtZSI6IlBpY25pYyBUYWJsZSIsImRlc2NyaXB0aW9uIjoiQ2xhc3NpYyBwaWNuaWMgdGFibGUgd2l0aCBhdHRhY2hlZCBiZW5jaGVzLiJ9LCJmYXJtLXRhYmxlLThmdCI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo4LCJoZWlnaHQiOjMsInNlYXRzIjo4LCJjb2xvciI6IiM4QjVFM0MiLCJkaXNwbGF5TmFtZSI6IkZhcm0gVGFibGUgKDhmdCkiLCJkZXNjcmlwdGlvbiI6IlJ1c3RpYy1zdHlsZSBmYXJtIHRhYmxlLiJ9LCJidWZmZXQtdGFibGUtc2V0dXAiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0IjozLCJzZWF0cyI6MCwiY29sb3IiOiIjOEI1RTNDIiwiZGlzcGxheU5hbWUiOiJCdWZmZXQgVGFibGUgU2V0dXAiLCJkZXNjcmlwdGlvbiI6IkJ1ZmZldCBzZXR1cCAodGFibGUgKyBjYXRlcmluZyBsYXlvdXQpLiJ9LCJjdXJ2ZWQtZm9sZGluZy10YWJsZXMiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6MTAsImhlaWdodCI6NCwic2VhdHMiOjAsImNvbG9yIjoiIzhCNUUzQyIsImRpc3BsYXlOYW1lIjoiQ3VydmVkIEZvbGRpbmcgVGFibGVzIChTZXQpIiwiZGVzY3JpcHRpb24iOiJDdXJ2ZWQgZm9sZGluZyB0YWJsZXMgKHNlcnBlbnRpbmUtc3R5bGUpLiJ9LCJyb3VuZC10YWJsZS01ZnQtZm9sZGluZyI6eyJ0eXBlIjoicm91bmQiLCJkaWFtZXRlciI6NSwic2VhdHMiOjgsImNvbG9yIjoiIzhCNUUzQyIsImRpc3BsYXlOYW1lIjoiNScgUm91bmQgRm9sZGluZyBUYWJsZSAoV29vZCkiLCJkZXNjcmlwdGlvbiI6Ildvb2QgZm9sZGluZyByb3VuZCB0YWJsZSAobm8gbGluZW4pLiJ9LCJiYW5xdWV0LXRhYmxlLThmdC13b29kIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjgsImhlaWdodCI6Mi41LCJzZWF0cyI6MTAsImNvbG9yIjoiIzhCNUUzQyIsImRpc3BsYXlOYW1lIjoiOCcgRm9sZGluZyBUYWJsZSAoV29vZCkiLCJkZXNjcmlwdGlvbiI6Ildvb2QgZm9sZGluZyBiYW5xdWV0IHRhYmxlIChubyBsaW5lbikuIn0sImZvbGlhZ2UtYm94d29vZC1oZWRnZS13YWxsIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjgsImhlaWdodCI6MSwic2VhdHMiOjAsImNvbG9yIjoiIzJFN0QzMiIsImRpc3BsYXlOYW1lIjoiQm94d29vZCBIZWRnZSBXYWxsIiwiZGVzY3JpcHRpb24iOiJHcmVlbiBib3h3b29kIGhlZGdlIHdhbGwgYmFja2Ryb3AuIn0sImRlY29yLXdoaXNrZXktYmFycmVsIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjIsImhlaWdodCI6Miwic2VhdHMiOjAsImNvbG9yIjoiIzhCNUUzQyIsImRpc3BsYXlOYW1lIjoiV2hpc2tleSBCYXJyZWwiLCJkZXNjcmlwdGlvbiI6IldoaXNrZXkgYmFycmVsLiJ9LCJkZWNvci1iYXJyZWwtbGlnaHQtcG9zdCI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoyLCJoZWlnaHQiOjIsInNlYXRzIjowLCJjb2xvciI6IiM4QjVFM0MiLCJkaXNwbGF5TmFtZSI6IkJhcnJlbCBMaWdodCBQb3N0IiwiZGVzY3JpcHRpb24iOiJEZWNvcmF0aXZlIGJhcnJlbCBsaWdodCBwb3N0LiJ9LCJzdGF0aW9uLXBvcnRhYmxlLXJlc3Ryb29tLXRyYWlsZXIiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6MTgsImhlaWdodCI6OC41LCJzZWF0cyI6MCwiY29sb3IiOiIjQjBCRUM1IiwiZGlzcGxheU5hbWUiOiJQb3J0YWJsZSBSZXN0cm9vbSBUcmFpbGVyIiwiZGVzY3JpcHRpb24iOiJQb3J0YWJsZSByZXN0cm9vbSB0cmFpbGVyLiJ9LCJzdGF0aW9uLWJicSI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo2LCJoZWlnaHQiOjIuNSwic2VhdHMiOjAsImNvbG9yIjoiIzQ1NUE2NCIsImRpc3BsYXlOYW1lIjoiQkJRIiwiZGVzY3JpcHRpb24iOiJCQlEgLyBncmlsbC4ifSwic3RhdGlvbi1jb2ZmZWUtdXJuIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjEsImhlaWdodCI6MSwic2VhdHMiOjAsImNvbG9yIjoiIzQ1NUE2NCIsImRlZmF1bHRFbGV2YXRpb24iOjIuNSwiZGlzcGxheU5hbWUiOiJDb2ZmZWUgVXJuIChUYWJsZXRvcCkiLCJkZXNjcmlwdGlvbiI6IlRhYmxldG9wIGNvZmZlZSB1cm4gKGRlZmF1bHRzIHRvIHRhYmxlIGhlaWdodCBlbGV2YXRpb24pLiJ9LCJzdGF0aW9uLXRyYXNoLWNvbnRhaW5lciI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjozLCJoZWlnaHQiOjMsInNlYXRzIjowLCJjb2xvciI6IiM2MDdEOEIiLCJkaXNwbGF5TmFtZSI6IlRyYXNoIENvbnRhaW5lciIsImRlc2NyaXB0aW9uIjoiVHJhc2ggLyB3YXN0ZSBjb250YWluZXIuIn0sImRqLXNwZWFrZXItb24tc3RhbmQiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6MiwiaGVpZ2h0IjoyLCJzZWF0cyI6MCwiY29sb3IiOiIjNDU1QTY0IiwiZGlzcGxheU5hbWUiOiJTcGVha2VyIG9uIFN0YW5kIiwiZGVzY3JpcHRpb24iOiJQQSBzcGVha2VyIG9uIHN0YW5kLiJ9LCJkai1rYXJhb2tlLW1hY2hpbmUiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6MiwiaGVpZ2h0IjoyLCJzZWF0cyI6MCwiY29sb3IiOiIjNDU1QTY0IiwiZGlzcGxheU5hbWUiOiJLYXJhb2tlIE1hY2hpbmUiLCJkZXNjcmlwdGlvbiI6IkthcmFva2UgcGFydHkgc3BlYWtlciBzZXR1cC4ifSwiZGotcHJvamVjdGlvbi1zY3JlZW4iOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0IjoyLjUsInNlYXRzIjowLCJjb2xvciI6IiNDRkQ4REMiLCJkaXNwbGF5TmFtZSI6IlByb2plY3Rpb24gU2NyZWVuIiwiZGVzY3JpcHRpb24iOiJQcm9qZWN0aW9uIHNjcmVlbi4ifSwiZGotcG9kaXVtIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjIsImhlaWdodCI6Miwic2VhdHMiOjAsImNvbG9yIjoiIzhCNUUzQyIsImRpc3BsYXlOYW1lIjoiUG9kaXVtIiwiZGVzY3JpcHRpb24iOiJQb2RpdW0gLyBsZWN0ZXJuLiJ9LCJzdGF0aW9uLXBob3RvLWJvb3RoLXNldHVwIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjgsImhlaWdodCI6OCwic2VhdHMiOjAsImNvbG9yIjoiI0IwQkVDNSIsImRpc3BsYXlOYW1lIjoiUGhvdG8gQm9vdGggU2V0dXAiLCJkZXNjcmlwdGlvbiI6IkZ1bGwgcGhvdG8gYm9vdGggc2V0dXAuIn0sInN0YXRpb24tcGhvdG8tYm9vdGgtdGFibGV0b3AiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6MSwiaGVpZ2h0IjoxLCJzZWF0cyI6MCwiY29sb3IiOiIjQjBCRUM1IiwiZGVmYXVsdEVsZXZhdGlvbiI6Mi41LCJkaXNwbGF5TmFtZSI6IlBob3RvIEJvb3RoIChUYWJsZXRvcCkiLCJkZXNjcmlwdGlvbiI6IlRhYmxldG9wIHBob3RvIGJvb3RoIChkZWZhdWx0cyB0byB0YWJsZSBoZWlnaHQgZWxldmF0aW9uKS4ifSwic3RhdGlvbi1odW50ZXItYXJjYWRlIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjMsImhlaWdodCI6Mywic2VhdHMiOjAsImNvbG9yIjoiIzQ1NUE2NCIsImRpc3BsYXlOYW1lIjoiSHVudGVyIEFyY2FkZSIsImRlc2NyaXB0aW9uIjoiQXJjYWRlIG1hY2hpbmUuIn0sImluZmxhdGFibGUtYm91bmN5LWhvdXNlLWJsb2NrcyI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoxNCwiaGVpZ2h0IjoxNCwic2VhdHMiOjAsImNvbG9yIjoiI0ZGQjc0RCIsImRpc3BsYXlOYW1lIjoiQm91bmN5IEhvdXNlIChCbG9ja3MpIiwiZGVzY3JpcHRpb24iOiJCbG9ja3MtdGhlbWVkIGJvdW5jeSBob3VzZS4ifSwiY2hhaXItc2xlZWstc3dpdmVsLXN0b29sIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjEuNSwiaGVpZ2h0IjoxLjUsInNlYXRzIjoxLCJjb2xvciI6IiM3ODkwOUMiLCJkaXNwbGF5TmFtZSI6IlNsZWVrIFN3aXZlbCBTdG9vbCIsImRlc2NyaXB0aW9uIjoiU3dpdmVsIHN0b29sLiJ9LCJjaGFpci1zdG9vbC1zY29vcGVyLXdoaXRlIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjEuNSwiaGVpZ2h0IjoxLjUsInNlYXRzIjoxLCJjb2xvciI6IiNFQ0VGRjEiLCJkaXNwbGF5TmFtZSI6IlNjb29wZXIgU3Rvb2wgKFdoaXRlKSIsImRlc2NyaXB0aW9uIjoiV2hpdGUgc2Nvb3BlciBzdG9vbC4ifSwicGljbmljLXRhYmxlLWtpZHMtZ3JlZW4iOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6NCwiaGVpZ2h0IjozLCJzZWF0cyI6MCwiY29sb3IiOiIjMTZhMzRhIiwiZGlzcGxheU5hbWUiOiJLaWRzIFBpY25pYyBUYWJsZSAoR3JlZW4pIiwiZGVzY3JpcHRpb24iOiJLaWRzLXNpemVkIHBpY25pYyB0YWJsZS4ifSwicGljbmljLXRhYmxlLXBsYXN0aWMiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6NiwiaGVpZ2h0Ijo1LCJzZWF0cyI6MCwiY29sb3IiOiIjMGVhNWU5IiwiZGlzcGxheU5hbWUiOiJQbGFzdGljIFBpY25pYyBUYWJsZSIsImRlc2NyaXB0aW9uIjoiRnVsbC1zaXplIHBsYXN0aWMgcGljbmljIHRhYmxlLiJ9LCJwaWNuaWMtb2FzaXMiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0Ijo2LCJzZWF0cyI6MCwiY29sb3IiOiIjMjJjNTVlIiwiZGlzcGxheU5hbWUiOiJQaWNuaWMgT2FzaXMgKExvdyBQaWNuaWMpIiwiZGVzY3JpcHRpb24iOiJMb3cgcGljbmljLXN0eWxlIHNldHVwIGZvb3RwcmludC4ifSwiaGVhZC10YWJsZS04ZnQtc2tpcnRlZCI6eyJ0eXBlIjoiaGVhZCIsIndpZHRoIjo4LCJoZWlnaHQiOjIuNSwic2VhdHMiOjQsImNvbG9yIjoiIzRCMDA4MiIsImRpc3BsYXlOYW1lIjoiOCBmdCBIZWFkIFRhYmxlIChTa2lydGVkKSIsImRlc2NyaXB0aW9uIjoiOCBmdCBoZWFkIHRhYmxlIHdpdGggc2tpcnRpbmcgKHRhYmxlIGhlaWdodCAzMCBpbikuIn0sIndoaXRlLW1pbmltYWxpc3QtdGFibGUiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6NiwiaGVpZ2h0IjoyLjUsInNlYXRzIjowLCJjb2xvciI6IiNlMmU4ZjAiLCJkaXNwbGF5TmFtZSI6IldoaXRlIE1pbmltYWxpc3QgVGFibGUiLCJkZXNjcmlwdGlvbiI6IkNsZWFuIHdoaXRlIHRhYmxlIChhcHByb3guIHN0YW5kYXJkIHRhYmxlIGhlaWdodCkuIn0sIndpcmVmcmFtZS1jb2NrdGFpbC10YWJsZSI6eyJ0eXBlIjoicm91bmQiLCJkaWFtZXRlciI6Mi41LCJzZWF0cyI6MCwiY29sb3IiOiIjMkY0RjRGIiwiZGlzcGxheU5hbWUiOiJDb2NrdGFpbCBUYWJsZSAoV2lyZWZyYW1lKSIsImRlc2NyaXB0aW9uIjoiSGlnaC10b3AgY29ja3RhaWwgdGFibGUgKDQyIGluIHRhbGwpLiJ9LCJjb2NrdGFpbC10YWJsZS1tb2Rlcm4tbWluaW1hbGlzdCI6eyJ0eXBlIjoicm91bmQiLCJkaWFtZXRlciI6Mi41LCJzZWF0cyI6MCwiY29sb3IiOiIjMkY0RjRGIiwiZGlzcGxheU5hbWUiOiJDb2NrdGFpbCBUYWJsZSAoTW9kZXJuIE1pbmltYWxpc3QpIiwiZGVzY3JpcHRpb24iOiJIaWdoLXRvcCBjb2NrdGFpbCB0YWJsZSAoNDIgaW4gdGFsbCkuIn0sImNvY2t0YWlsLXRhYmxlLWx1bWlub3VzIjp7InR5cGUiOiJyb3VuZCIsImRpYW1ldGVyIjoyLjUsInNlYXRzIjowLCJjb2xvciI6IiMyRjRGNEYiLCJkaXNwbGF5TmFtZSI6IkNvY2t0YWlsIFRhYmxlIChMdW1pbm91cykiLCJkZXNjcmlwdGlvbiI6IkhpZ2gtdG9wIGNvY2t0YWlsIHRhYmxlICg0MiBpbiB0YWxsKS4ifSwidHJ1c3Mtc3RhZ2UtbGlnaHQtcHVycGxlIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjEuNSwiaGVpZ2h0IjoxLjUsInNlYXRzIjowLCJjb2xvciI6IiNhODU1ZjciLCJkaXNwbGF5TmFtZSI6IlN0YWdlIExpZ2h0IChQdXJwbGUpIiwiZGVzY3JpcHRpb24iOiJTdGFnZSBsaWdodCBwcm9wLiJ9LCJ0cnVzcy10di1zdGFuZCI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo0LCJoZWlnaHQiOjIsInNlYXRzIjowLCJjb2xvciI6IiM2NDc0OGIiLCJkaXNwbGF5TmFtZSI6IlRWIG9uIFRydXNzIFN0YW5kIiwiZGVzY3JpcHRpb24iOiJUViBvbiBhIHRydXNzIHN0YW5kIChmcmVlc3RhbmRpbmcpLiJ9LCJzdGF0aW9uLWZyaWRnZS1vbi13aGVlbHMiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6MiwiaGVpZ2h0IjoyLCJzZWF0cyI6MCwiY29sb3IiOiIjNDc1NTY5IiwiZGlzcGxheU5hbWUiOiJGcmlkZ2UgKE9uIFdoZWVscykiLCJkZXNjcmlwdGlvbiI6Ik1vYmlsZSBmcmlkZ2UgZm9yIGJhciAvIHNlcnZpY2UgYXJlYXMuIn0sInN0YXRpb24tcG9wY29ybi1jYXJ0Ijp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjQsImhlaWdodCI6Miwic2VhdHMiOjAsImNvbG9yIjoiI2Y5NzMxNiIsImRpc3BsYXlOYW1lIjoiUG9wY29ybiBDYXJ0IiwiZGVzY3JpcHRpb24iOiJQb3Bjb3JuIGNhcnQgc3RhdGlvbi4ifSwic3RhdGlvbi1hcmNhZGUtcmFjaW5nLWNsYXNzaWMiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6NiwiaGVpZ2h0Ijo0LCJzZWF0cyI6MCwiY29sb3IiOiIjZmI3MTg1IiwiZGlzcGxheU5hbWUiOiJBcmNhZGUgUmFjaW5nIChDbGFzc2ljKSIsImRlc2NyaXB0aW9uIjoiUmFjaW5nIGFyY2FkZSBtYWNoaW5lLiJ9LCJzdGF0aW9uLWFyY2FkZS1ydXNoLXJhY2luZyI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo2LCJoZWlnaHQiOjQsInNlYXRzIjowLCJjb2xvciI6IiNmYjcxODUiLCJkaXNwbGF5TmFtZSI6IkFyY2FkZSBSdXNoIFJhY2luZyIsImRlc2NyaXB0aW9uIjoiUmFjaW5nIGFyY2FkZSBtYWNoaW5lLiJ9LCJzdGF0aW9uLXJhY2luZy1zaW0iOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6NiwiaGVpZ2h0Ijo0LCJzZWF0cyI6MCwiY29sb3IiOiIjZmI3MTg1IiwiZGlzcGxheU5hbWUiOiJSYWNpbmcgU2ltdWxhdG9yIiwiZGVzY3JpcHRpb24iOiJSYWNpbmcgc2ltdWxhdG9yIHN0YXRpb24uIn0sImJhci1tb2Rlcm4iOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0IjoyLjUsInNlYXRzIjowLCJjb2xvciI6IiM3QjNGNjEiLCJkaXNwbGF5TmFtZSI6IkJhciAoTW9kZXJuKSIsImRlc2NyaXB0aW9uIjoiQmFyIGNvdW50ZXIgKGFwcHJveC4gNDIgaW4gdGFsbCkuIn0sImJhci13aGl0ZS1iYWNrLWJhciI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo4LCJoZWlnaHQiOjIsInNlYXRzIjowLCJjb2xvciI6IiM5NGEzYjgiLCJkaXNwbGF5TmFtZSI6IldoaXRlIEJhY2sgQmFyIiwiZGVzY3JpcHRpb24iOiJCYWNrIGJhciBzaGVsdmluZyAvIGRpc3BsYXkgdW5pdC4ifSwiZGVjb3ItY3VwY2FrZS1zdGFuZCI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoxLCJoZWlnaHQiOjEsInNlYXRzIjowLCJjb2xvciI6IiNmNDcyYjYiLCJkZWZhdWx0RWxldmF0aW9uIjoyLjUsImRpc3BsYXlOYW1lIjoiQ3VwY2FrZSBTdGFuZCAoVGFibGV0b3ApIiwiZGVzY3JpcHRpb24iOiJUYWJsZXRvcCBwcm9wIChhdXRvLWVsZXZhdGVkIHRvIHRhYmxlIGhlaWdodCkuIn0sImRlY29yLWNhbnZhcy1lYXNlbCI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoyLCJoZWlnaHQiOjIsInNlYXRzIjowLCJjb2xvciI6IiNmNTllMGIiLCJkaXNwbGF5TmFtZSI6IkJsYW5rIENhbnZhcyBvbiBFYXNlbCIsImRlc2NyaXB0aW9uIjoiQmxhbmsgY2FudmFzIG9uIGFuIGVhc2VsLiJ9LCJkZWNvci1oZXgtc2hlbGYiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6NSwiaGVpZ2h0IjoxLjUsInNlYXRzIjowLCJjb2xvciI6IiNlYWIzMDgiLCJkaXNwbGF5TmFtZSI6IkhleGFnb25hbCBTaGVsZiIsImRlc2NyaXB0aW9uIjoiSGV4YWdvbmFsIHNoZWxmIC8gZGlzcGxheSB1bml0LiJ9LCJkZWNvci1tZXRhbC1ib29rc2hlbGYiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6MywiaGVpZ2h0IjoxLCJzZWF0cyI6MCwiY29sb3IiOiIjNjQ3NDhiIiwiZGlzcGxheU5hbWUiOiJNZXRhbCBCb29rc2hlbGYiLCJkZXNjcmlwdGlvbiI6Ik1ldGFsIGJvb2tzaGVsZiAvIGRpc3BsYXkgc2hlbHZpbmcuIn0sImRlY29yLWdvbGRlbi1zaGVsdmluZy11bml0Ijp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjUsImhlaWdodCI6MS41LCJzZWF0cyI6MCwiY29sb3IiOiIjZmJiZjI0IiwiZGlzcGxheU5hbWUiOiJHb2xkZW4gU2hlbHZpbmcgVW5pdCIsImRlc2NyaXB0aW9uIjoiR29sZCBzaGVsdmluZyAvIGRpc3BsYXkgdW5pdC4ifSwiZGVjb3ItdW1icmVsbGEtc2hhZGUiOnsidHlwZSI6InJvdW5kIiwiZGlhbWV0ZXIiOjksInNlYXRzIjowLCJjb2xvciI6IiMzOGJkZjgiLCJkaXNwbGF5TmFtZSI6IlVtYnJlbGxhIFNoYWRlIiwiZGVzY3JpcHRpb24iOiJQYXRpbyB1bWJyZWxsYSAvIHNoYWRlIChhcHByb3guIDggZnQgdGFsbCkuIn0sImRlY29yLXN0YWdlLXN0ZXBzLWFsdW1pbnVtIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjQsImhlaWdodCI6NCwic2VhdHMiOjAsImNvbG9yIjoiI2NiZDVlMSIsImRpc3BsYXlOYW1lIjoiU3RhZ2UgU3RlcHMgKEFsdW1pbnVtKSIsImRlc2NyaXB0aW9uIjoiU3RhZ2Ugc3RlcHMgLyBzdGFpcnMuIn0sImRlY29yLWJsZWFjaGVycy11bmZ1cmxlZCI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjoxMCwiaGVpZ2h0Ijo2LCJzZWF0cyI6MCwiY29sb3IiOiIjOTRhM2I4IiwiZGlzcGxheU5hbWUiOiJCbGVhY2hlcnMgKFVuZnVybGVkKSIsImRlc2NyaXB0aW9uIjoiQmxlYWNoZXJzIHNlYXRpbmcgdW5pdC4ifSwibW9kZXJuLWxvdW5nZS1zb2ZhLWN1cnZlZC12ZWx2ZXQtYmxhY2siOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0IjozLjUsInNlYXRzIjowLCJjb2xvciI6IiMwZjE3MmEiLCJkaXNwbGF5TmFtZSI6IkN1cnZlZCBWZWx2ZXQgU29mYSAoQmxhY2spIiwiZGVzY3JpcHRpb24iOiJDdXJ2ZWQgc29mYSAoMzIgaW4gdGFsbCkuIn0sIm1vZGVybi1sb3VuZ2Utc29mYS1jdXJ2eS1ncmVlbiI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo4LCJoZWlnaHQiOjMuNSwic2VhdHMiOjAsImNvbG9yIjoiIzE2YTM0YSIsImRpc3BsYXlOYW1lIjoiQ3VydnkgU29mYSAoR3JlZW4pIiwiZGVzY3JpcHRpb24iOiJDdXJ2ZWQgc29mYSAoMzIgaW4gdGFsbCkuIn0sIm1vZGVybi1sb3VuZ2Utc29mYS1jdXJ2ZWQtZWxlZ2FuY2Utd2hpdGUtYSI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo4LCJoZWlnaHQiOjMuNSwic2VhdHMiOjAsImNvbG9yIjoiI2Y4ZmFmYyIsImRpc3BsYXlOYW1lIjoiQ3VydmVkIEVsZWdhbmNlIFNvZmEgKFdoaXRlIEEpIiwiZGVzY3JpcHRpb24iOiJDdXJ2ZWQgc29mYSAoMzIgaW4gdGFsbCkuIn0sIm1vZGVybi1sb3VuZ2Utc29mYS1sLXNoYXBlZC1tb2Rlcm4tYmxhY2siOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0Ijo4LCJzZWF0cyI6MCwiY29sb3IiOiIjMTExODI3IiwiZGlzcGxheU5hbWUiOiJMLVNoYXBlZCBNb2Rlcm4gU29mYSAoQmxhY2spIiwiZGVzY3JpcHRpb24iOiJTZWN0aW9uYWwgc29mYSAoMzIgaW4gdGFsbCkuIn0sIm1vZGVybi1sb3VuZ2Utc29mYS1zZWN0aW9uYWwtY3JlYW0iOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6MTAsImhlaWdodCI6OCwic2VhdHMiOjAsImNvbG9yIjoiI2Y1ZjVmNCIsImRpc3BsYXlOYW1lIjoiU2VjdGlvbmFsIFNvZmEgKENyZWFtKSIsImRlc2NyaXB0aW9uIjoiU2VjdGlvbmFsIHNvZmEgKDMyIGluIHRhbGwpLiJ9LCJtb2Rlcm4tbG91bmdlLXNvZmEtY3VydmVkLWdyZXkiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0IjozLjUsInNlYXRzIjowLCJjb2xvciI6IiM2NDc0OGIiLCJkaXNwbGF5TmFtZSI6IkN1cnZlZCBTb2ZhIChHcmV5KSIsImRlc2NyaXB0aW9uIjoiQ3VydmVkIHNvZmEgKDMyIGluIHRhbGwpLiJ9LCJtb2Rlcm4tbG91bmdlLXNvZmEtY3Jlc2NlbnQtd2hpdGUiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0Ijo0LCJzZWF0cyI6MCwiY29sb3IiOiIjZjhmYWZjIiwiZGlzcGxheU5hbWUiOiJDcmVzY2VudCBTb2ZhIChXaGl0ZSkiLCJkZXNjcmlwdGlvbiI6IkNyZXNjZW50IHNvZmEgKDMyIGluIHRhbGwpLiJ9LCJtb2Rlcm4tbG91bmdlLXNvZmEtY3VydmVkLWVsZWdhbmNlLXdoaXRlLWIiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0IjozLjUsInNlYXRzIjowLCJjb2xvciI6IiNmOGZhZmMiLCJkaXNwbGF5TmFtZSI6IkN1cnZlZCBFbGVnYW5jZSBTb2ZhIChXaGl0ZSBCKSIsImRlc2NyaXB0aW9uIjoiQ3VydmVkIHNvZmEgKDMyIGluIHRhbGwpLiJ9LCJtb2Rlcm4tbG91bmdlLXNvZmEtY3VydmUtZ3JlZW4iOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6OCwiaGVpZ2h0IjozLjUsInNlYXRzIjowLCJjb2xvciI6IiMxNmEzNGEiLCJkaXNwbGF5TmFtZSI6IkN1cnZlIFNvZmEgKEdyZWVuKSIsImRlc2NyaXB0aW9uIjoiQ3VydmVkIHNvZmEgKDMyIGluIHRhbGwpLiJ9LCJtb2Rlcm4tbG91bmdlLXNvZmEtZWxlZ2FudC1ibGFjayI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo4LCJoZWlnaHQiOjMuNSwic2VhdHMiOjAsImNvbG9yIjoiIzBmMTcyYSIsImRpc3BsYXlOYW1lIjoiRWxlZ2FudCBTb2ZhIChCbGFjaykiLCJkZXNjcmlwdGlvbiI6IlNvZmEgKDMyIGluIHRhbGwpLiJ9LCJtb2Rlcm4tbG91bmdlLXNvZmEtY29ybmVyLWNvbWZvcnQtZ3JlZW4iOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6NCwiaGVpZ2h0Ijo0LCJzZWF0cyI6MCwiY29sb3IiOiIjMTZhMzRhIiwiZGlzcGxheU5hbWUiOiJDb3JuZXIgQ29tZm9ydCAoR3JlZW4pIiwiZGVzY3JpcHRpb24iOiJDb3JuZXIgc29mYSBwaWVjZSAoMzIgaW4gdGFsbCkuIn0sIm1vZGVybi1sb3VuZ2Utc29mYS1zZWN0aW9uYWwtd2hpdGUiOnsidHlwZSI6InJlY3QiLCJ3aWR0aCI6MTAsImhlaWdodCI6OCwic2VhdHMiOjAsImNvbG9yIjoiI2Y4ZmFmYyIsImRpc3BsYXlOYW1lIjoiU2VjdGlvbmFsIFNvZmEgKFdoaXRlKSIsImRlc2NyaXB0aW9uIjoiU2VjdGlvbmFsIHNvZmEgKDMyIGluIHRhbGwpLiJ9LCJtb2Rlcm4tbG91bmdlLXNvZmEtY29tZm9ydC13aGl0ZSI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo4LCJoZWlnaHQiOjMuNSwic2VhdHMiOjAsImNvbG9yIjoiI2Y4ZmFmYyIsImRpc3BsYXlOYW1lIjoiQ29tZm9ydCBTb2ZhIChXaGl0ZSkiLCJkZXNjcmlwdGlvbiI6IlNvZmEgKDMyIGluIHRhbGwpLiJ9LCJtb2Rlcm4tbG91bmdlLXNvZmEtaGFybW9ueS1ncmVlbiI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjo4LCJoZWlnaHQiOjMuNSwic2VhdHMiOjAsImNvbG9yIjoiIzE2YTM0YSIsImRpc3BsYXlOYW1lIjoiSGFybW9ueSBTb2ZhIChHcmVlbikiLCJkZXNjcmlwdGlvbiI6IlNvZmEgKDMyIGluIHRhbGwpLiJ9LCJtb2Rlcm4tbG91bmdlLW90dG9tYW4tY3ViZS13aGl0ZSI6eyJ0eXBlIjoicmVjdCIsIndpZHRoIjozLCJoZWlnaHQiOjMsInNlYXRzIjowLCJjb2xvciI6IiNmOGZhZmMiLCJkaXNwbGF5TmFtZSI6IkN1YmUgT3R0b21hbiAoV2hpdGUpIiwiZGVzY3JpcHRpb24iOiJDdWJlIG90dG9tYW4gKDE3IGluIHRhbGwpLiJ9LCJjaGFpci1hZGlyb25kYWNrIjp7InR5cGUiOiJyZWN0Iiwid2lkdGgiOjMsImhlaWdodCI6Mywic2VhdHMiOjAsImNvbG9yIjoiIzg0Y2MxNiIsImRpc3BsYXlOYW1lIjoiQWRpcm9uZGFjayBDaGFpciIsImRlc2NyaXB0aW9uIjoiU3RhbmRhbG9uZSBBZGlyb25kYWNrIGNoYWlyIChub24tZ2xvYmFsIGNoYWlyIHByb3ApLiJ9LCJ0ZW50LWl0ZW0tMTB4MTAtcG9wdXAiOnsidHlwZSI6InN0cnVjdHVyZSIsIndpZHRoIjoxMCwiaGVpZ2h0IjoxMCwic2VhdHMiOjAsImNvbG9yIjoiI2ZmZmZmZiIsImRpc3BsYXlOYW1lIjoiMTB4MTAgUG9wdXAiLCJ0ZW50VHlwZSI6IlBvcHVwIiwiZGVzY3JpcHRpb24iOiJBIGNvbXBhY3QgMTB4MTAgY2Fub3B5IHRlbnQuIFVzZWZ1bCBmb3IgdmVuZG9yIGJvb3RocywgcmVnaXN0cmF0aW9uLCBvciBzbWFsbCBjb3ZlcmFnZSBhcmVhcy4ifSwidGVudC1pdGVtLTEweDIwLXBvcHVwIjp7InR5cGUiOiJzdHJ1Y3R1cmUiLCJ3aWR0aCI6MjAsImhlaWdodCI6MTAsInNlYXRzIjowLCJjb2xvciI6IiNmZmZmZmYiLCJkaXNwbGF5TmFtZSI6IjEweDIwIFBvcHVwIiwidGVudFR5cGUiOiJQb3B1cCIsImRlc2NyaXB0aW9uIjoiRG91YmxlLXdpZGUgMTB4MjAgY2Fub3B5IHRlbnQuIFByb3ZpZGVzIGV4dGVuZGVkIGNvdmVyYWdlIGZvciBmb29kIHNlcnZpY2Ugb3IgbGFyZ2VyIGJvb3Rocy4ifSwidGVudC1pdGVtLTIweDIwLW1hcnF1ZWUiOnsidHlwZSI6InN0cnVjdHVyZSIsIndpZHRoIjoyMCwiaGVpZ2h0IjoyMCwic2VhdHMiOjAsImNvbG9yIjoiI2ZmZmZmZiIsImRpc3BsYXlOYW1lIjoiMjB4MjAgTWFycXVlZSIsInRlbnRUeXBlIjoiTWFycXVlZSIsImRlc2NyaXB0aW9uIjoiSGlnaC1wZWFrIGZyYW1lIHRlbnQuIElkZWFsIGZvciBzbWFsbCBwYXJ0aWVzIG9yIGFzIGFuIGVudHJhbmNlIGZveWVyIHRvIGEgbGFyZ2VyIHN0cnVjdHVyZS4ifSwidGVudC1pdGVtLTIweDMwLW1hcnF1ZWUiOnsidHlwZSI6InN0cnVjdHVyZSIsIndpZHRoIjozMCwiaGVpZ2h0IjoyMCwic2VhdHMiOjAsImNvbG9yIjoiI2ZmZmZmZiIsImRpc3BsYXlOYW1lIjoiMjB4MzAgTWFycXVlZSIsInRlbnRUeXBlIjoiTWFycXVlZSIsImRlc2NyaXB0aW9uIjoiTWlkLXNpemVkIGhpZ2gtcGVhayB0ZW50LiBDb3ZlcnMgYXBwcm94IDYwMCBzcSBmdC4ifSwidGVudC1pdGVtLTIweDQwLW1hcnF1ZWUiOnsidHlwZSI6InN0cnVjdHVyZSIsIndpZHRoIjo0MCwiaGVpZ2h0IjoyMCwic2VhdHMiOjAsImNvbG9yIjoiI2ZmZmZmZiIsImRpc3BsYXlOYW1lIjoiMjB4NDAgTWFycXVlZSIsInRlbnRUeXBlIjoiTWFycXVlZSIsImRlc2NyaXB0aW9uIjoiTGFyZ2UgaGlnaC1wZWFrIGZyYW1lIHRlbnQuIENvdmVycyBhcHByb3ggODAwIHNxIGZ0LiJ9LCJ0ZW50LWl0ZW0tMzR4NDAtaGV4Ijp7InR5cGUiOiJzdHJ1Y3R1cmUiLCJ3aWR0aCI6MzQuNjQxLCJoZWlnaHQiOjQwLCJzZWF0cyI6MCwiY29sb3IiOiIjZmZmZmZmIiwiZGlzcGxheU5hbWUiOiIzNCcgeCA0MCcgSGV4IFRlbnQiLCJ0ZW50VHlwZSI6IkhleCIsInNpZGVMZW5ndGgiOjIwLCJkZXNjcmlwdGlvbiI6IjM0JyAoZmxhdC10by1mbGF0KSB4IDQwJyAocG9pbnQtdG8tcG9pbnQpIHJlZ3VsYXIgaGV4YWdvbiBoaWdoLXBlYWsgbWFycXVlZSB3aXRoIGEgZmxvYXRpbmcgY2VudGVyIHBvbGUgc3VwcG9ydGVkIGJ5IGNyb3NzLWNhYmxlcy4gQWNjZXB0cyA4JyB4IDIwJyB3YWxsIHNlY3Rpb25zLiJ9LCJ0ZW50LWl0ZW0tNDB4NDAtcG9sZSI6eyJ0eXBlIjoic3RydWN0dXJlIiwid2lkdGgiOjQwLCJoZWlnaHQiOjQwLCJzZWF0cyI6MCwiY29sb3IiOiIjZmZmZmZmIiwiZGlzcGxheU5hbWUiOiI0MHg0MCBQb2xlIiwidGVudFR5cGUiOiJQb2xlIiwiZGVzY3JpcHRpb24iOiJDbGFzc2ljIHBvbGUgdGVudCB3aXRoIGNlbnRlciBwb2xlcy4gUmVxdWlyZXMgc3Rha2luZy4ifSwidGVudC1pdGVtLTQweDYwLXBvbGUiOnsidHlwZSI6InN0cnVjdHVyZSIsIndpZHRoIjo2MCwiaGVpZ2h0Ijo0MCwic2VhdHMiOjAsImNvbG9yIjoiI2ZmZmZmZiIsImRpc3BsYXlOYW1lIjoiNDB4NjAgUG9sZSIsInRlbnRUeXBlIjoiUG9sZSIsImRlc2NyaXB0aW9uIjoiTWVkaXVtIHBvbGUgdGVudC4gMiBDZW50ZXIgcG9sZXMuIn0sInRlbnQtaXRlbS00MHg4MC1wb2xlIjp7InR5cGUiOiJzdHJ1Y3R1cmUiLCJ3aWR0aCI6ODAsImhlaWdodCI6NDAsInNlYXRzIjowLCJjb2xvciI6IiNmZmZmZmYiLCJkaXNwbGF5TmFtZSI6IjQweDgwIFBvbGUiLCJ0ZW50VHlwZSI6IlBvbGUiLCJkZXNjcmlwdGlvbiI6IkxhcmdlIHBvbGUgdGVudC4gMyBDZW50ZXIgcG9sZXMuIn0sInRlbnQtaXRlbS00MHgxMDAtcG9sZSI6eyJ0eXBlIjoic3RydWN0dXJlIiwid2lkdGgiOjEwMCwiaGVpZ2h0Ijo0MCwic2VhdHMiOjAsImNvbG9yIjoiI2ZmZmZmZiIsImRpc3BsYXlOYW1lIjoiNDB4MTAwIFBvbGUiLCJ0ZW50VHlwZSI6IlBvbGUiLCJkZXNjcmlwdGlvbiI6IkdyYW5kIHBvbGUgdGVudC4gNCBDZW50ZXIgcG9sZXMuIn0sInRlbnQtaXRlbS00MHgxMjAtcG9sZSI6eyJ0eXBlIjoic3RydWN0dXJlIiwid2lkdGgiOjEyMCwiaGVpZ2h0Ijo0MCwic2VhdHMiOjAsImNvbG9yIjoiI2ZmZmZmZiIsImRpc3BsYXlOYW1lIjoiNDB4MTIwIFBvbGUiLCJ0ZW50VHlwZSI6IlBvbGUiLCJkZXNjcmlwdGlvbiI6Ik1hc3NpdmUgcG9sZSB0ZW50LiA1IENlbnRlciBwb2xlcy4ifSwidGVudC1pdGVtLTQweDE0MC1wb2xlIjp7InR5cGUiOiJzdHJ1Y3R1cmUiLCJ3aWR0aCI6MTQwLCJoZWlnaHQiOjQwLCJzZWF0cyI6MCwiY29sb3IiOiIjZmZmZmZmIiwiZGlzcGxheU5hbWUiOiI0MHgxNDAgUG9sZSIsInRlbnRUeXBlIjoiUG9sZSIsImRlc2NyaXB0aW9uIjoiRXh0ZW5zaXZlIHBvbGUgdGVudC4gNiBDZW50ZXIgcG9sZXMuIn0sInRlbnQtaXRlbS00MHgxNjAtcG9sZSI6eyJ0eXBlIjoic3RydWN0dXJlIiwid2lkdGgiOjE2MCwiaGVpZ2h0Ijo0MCwic2VhdHMiOjAsImNvbG9yIjoiI2ZmZmZmZiIsImRpc3BsYXlOYW1lIjoiNDB4MTYwIFBvbGUiLCJ0ZW50VHlwZSI6IlBvbGUiLCJkZXNjcmlwdGlvbiI6IkZlc3RpdmFsIHNpemUgcG9sZSB0ZW50LiA3IENlbnRlciBwb2xlcy4ifX07CiAgICAgICAgY29uc3QgTU9ERSA9ICJvdXRzaWRlIjsKICAgICAgICBsZXQgU1RBVEUgPSB7CiAgICAgICAgICAgIHRlbnQ6IHsid2lkdGgiOjIwLCJoZWlnaHQiOjIwLCJsYWJlbCI6IjIweDIwIE1hcnF1ZWUiLCJ0eXBlIjoiTWFycXVlZSIsInNpZGV3YWxscyI6W119LAogICAgICAgICAgICByb29tOiB7IndpZHRoIjoxMDAsImRlcHRoIjo1MCwiZmxvb3JDb2xvciI6IiNlMmU4ZjAiLCJ3YWxsQ29sb3IiOiIjZjhmYWZjIiwiZXh0ZXJpb3JXYWxsQ29sb3IiOiIjZTJlOGYwIiwicm9vZlN0eWxlIjoiZ2FibGUifSwKICAgICAgICAgICAgaXRlbXM6IFt7ImlkIjoiYWZvajRjaGVjIiwibmFtZSI6InJvdW5kLXRhYmxlLTVmdCIsIngiOjIwNjAsInkiOjIwNjAsImFuZ2xlIjowLCJjb2xvciI6IiM1NTZCMkYiLCJzZWF0cyI6OCwibG9ja2VkIjpmYWxzZSwibGluZW4iOiJ3aGl0ZSJ9LHsiaWQiOiI4aXc2MDYwd3UiLCJuYW1lIjoicm91bmQtdGFibGUtNWZ0IiwieCI6MjI0MCwieSI6MjA2MCwiYW5nbGUiOjAsImNvbG9yIjoiIzU1NkIyRiIsInNlYXRzIjo4LCJsb2NrZWQiOmZhbHNlLCJsaW5lbiI6IndoaXRlIn0seyJpZCI6InJoOHUyN2UwZyIsIm5hbWUiOiJyb3VuZC10YWJsZS01ZnQiLCJ4IjoyMjQwLCJ5IjoyMjQwLCJhbmdsZSI6MCwiY29sb3IiOiIjNTU2QjJGIiwic2VhdHMiOjgsImxvY2tlZCI6ZmFsc2UsImxpbmVuIjoid2hpdGUifSx7ImlkIjoicTMwZnUwcXZkIiwibmFtZSI6InJvdW5kLXRhYmxlLTVmdCIsIngiOjIwNjAsInkiOjIyNDAsImFuZ2xlIjowLCJjb2xvciI6IiM1NTZCMkYiLCJzZWF0cyI6OCwibG9ja2VkIjpmYWxzZSwibGluZW4iOiJ3aGl0ZSJ9XSwKICAgICAgICAgICAgdmlldzogJzJkJywKICAgICAgICAgICAgc2NhbGU6IDEsCiAgICAgICAgICAgIHBhbjogeyB4OiAwLCB5OiAwIH0sCiAgICAgICAgICAgIHJvdGF0aW9uOiAwLAogICAgICAgICAgICBzZWxlY3RlZElkczogW10sCiAgICAgICAgICAgIGRyb25lTW9kZTogZmFsc2UsCiAgICAgICAgICAgIHR1dG9yaWFsQWN0aXZlOiBmYWxzZSwKICAgICAgICAgICAgaXNOaWdodE1vZGU6IGZhbHNlLAogICAgICAgICAgICBjaGFpclN0eWxlOiAnd2hpdGVfZmFuYmFjaycsCiAgICAgICAgICAgIGNoaWF2YXJpQ3VzaGlvbjogZmFsc2UsCiAgICAgICAgICAgIHNob3dXYWxsczogZmFsc2UsCiAgICAgICAgICAgIHNob3dSb29mOiB0cnVlLAogICAgICAgICAgICAvLyBUYXBlIE1lYXN1cmUKICAgICAgICAgICAgaXNUYXBlQWN0aXZlOiBmYWxzZSwKICAgICAgICAgICAgdGFwZVBvaW50czogeyBzdGFydDogbnVsbCwgZW5kOiBudWxsIH0KICAgICAgICB9OwoKICAgICAgICBjb25zdCBUVVRPUklBTF9GTEFHID0gdHJ1ZTsKICAgICAgICBjb25zdCBzZWVuVGlwcyA9IG5ldyBTZXQoKTsKICAgICAgICBjb25zdCBUSVBTID0gewogICAgICAgICAgJ2l0ZW0nOiAnRHJhZyBpdGVtcyB0byByZXBvc2l0aW9uLiBDbGljayB0byByZXZlYWwgbGluZW5zLCByb3RhdGlvbiwgYW5kIGR1cGxpY2F0aW9uIHRvb2xzLicsCiAgICAgICAgICAncm90YXRlJzogJ0NsaWNrIHRoZSDwn5SEIGhhbmRsZSB0byByb3RhdGUgc2VsZWN0ZWQgaXRlbXMgYnkgMjIuNSBkZWdyZWVzLicsCiAgICAgICAgICAnbGluZW4nOiAnQ2xpY2sgdGhlIHBhbGV0dGUgaWNvbiB0byBjaGFuZ2UgdGFibGVjbG90aCBjb2xvcnMuJywKICAgICAgICAgICdkdXBsaWNhdGUnOiAnQ2xvbmUgc2VsZWN0aW9uIHRvIHF1aWNrbHkgZmlsbCB0aGUgc3BhY2UuJywKICAgICAgICAgICdkZWxldGUnOiAnUGVybWFuZW50bHkgcmVtb3ZlIHNlbGVjdGVkIGl0ZW1zLicsCiAgICAgICAgICAnM2QnOiAnU3dpdGNoIHRvIDNEIG1vZGUgdG8gd2FsayB0aHJvdWdoIHlvdXIgZXZlbnQgc3BhY2UgaW4gZmlyc3QtcGVyc29uLicsCiAgICAgICAgICAnd2FsbHMnOiAnQ2xpY2sgZGFzaGVkIHBlcmltZXRlciBsaW5lcyB0byB0b2dnbGUgd2luZG93ZWQgc2lkZXdhbGxzLicsCiAgICAgICAgICAndGFsbHknOiAnVGhlIHRhbGx5IHBhbmVsIHVwZGF0ZXMgaW4gcmVhbC10aW1lIGFzIHlvdSBtb2RpZnkgdGhlIGxheW91dC4nLAogICAgICAgICAgJ3RhcGUnOiAnQ2xpY2sgdHdpY2UgdG8gbWVhc3VyZSBkaXN0YW5jZSBpbiBmZWV0LicKICAgICAgICB9OwoKICAgICAgICBsZXQgaGlzdG9yeVN0YWNrID0gW107CiAgICAgICAgbGV0IHJlZG9TdGFjayA9IFtdOwoKICAgICAgICBmdW5jdGlvbiBwdXNoSGlzdG9yeSgpIHsKICAgICAgICAgICAgaGlzdG9yeVN0YWNrLnB1c2goSlNPTi5zdHJpbmdpZnkoeyAKICAgICAgICAgICAgICAgIGl0ZW1zOiBTVEFURS5pdGVtcywgCiAgICAgICAgICAgICAgICBzaWRld2FsbHM6IFNUQVRFLnRlbnQ/LnNpZGV3YWxscyB8fCBbXSAKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBpZiAoaGlzdG9yeVN0YWNrLmxlbmd0aCA+IDUwKSBoaXN0b3J5U3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgcmVkb1N0YWNrID0gW107CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB1bmRvKCkgewogICAgICAgICAgICBpZiAoIWhpc3RvcnlTdGFjay5sZW5ndGgpIHJldHVybjsKICAgICAgICAgICAgcmVkb1N0YWNrLnB1c2goSlNPTi5zdHJpbmdpZnkoeyAKICAgICAgICAgICAgICAgIGl0ZW1zOiBTVEFURS5pdGVtcywgCiAgICAgICAgICAgICAgICBzaWRld2FsbHM6IFNUQVRFLnRlbnQ/LnNpZGV3YWxscyB8fCBbXSAKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBjb25zdCBwcmV2ID0gSlNPTi5wYXJzZShoaXN0b3J5U3RhY2sucG9wKCkpOwogICAgICAgICAgICBTVEFURS5pdGVtcyA9IHByZXYuaXRlbXM7CiAgICAgICAgICAgIGlmKFNUQVRFLnRlbnQpIFNUQVRFLnRlbnQuc2lkZXdhbGxzID0gcHJldi5zaWRld2FsbHM7CiAgICAgICAgICAgIHJlbmRlcjJEKCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiByZWRvKCkgewogICAgICAgICAgICBpZiAoIXJlZG9TdGFjay5sZW5ndGgpIHJldHVybjsKICAgICAgICAgICAgaGlzdG9yeVN0YWNrLnB1c2goSlNPTi5zdHJpbmdpZnkoeyAKICAgICAgICAgICAgICAgIGl0ZW1zOiBTVEFURS5pdGVtcywgCiAgICAgICAgICAgICAgICBzaWRld2FsbHM6IFNUQVRFLnRlbnQ/LnNpZGV3YWxscyB8fCBbXSAKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBjb25zdCBuZXh0ID0gSlNPTi5wYXJzZShyZWRvU3RhY2sucG9wKCkpOwogICAgICAgICAgICBTVEFURS5pdGVtcyA9IG5leHQuaXRlbXM7CiAgICAgICAgICAgIGlmKFNUQVRFLnRlbnQpIFNUQVRFLnRlbnQuc2lkZXdhbGxzID0gbmV4dC5zaWRld2FsbHM7CiAgICAgICAgICAgIHJlbmRlcjJEKCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBzaG93VGlwKGtleSkgewogICAgICAgICAgaWYgKCFTVEFURS50dXRvcmlhbEFjdGl2ZSB8fCBzZWVuVGlwcy5oYXMoa2V5KSB8fCAhVElQU1trZXldKSByZXR1cm47CiAgICAgICAgICBjb25zdCB0aXBFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC10aXAnKTsKICAgICAgICAgIHRpcEVsLmlubmVyVGV4dCA9IFRJUFNba2V5XTsKICAgICAgICAgIHRpcEVsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgICAgc2VlblRpcHMuYWRkKGtleSk7CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRpcEVsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpLCA1MDAwKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHRvZ2dsZVR1dG9yaWFsKCkgewogICAgICAgICAgU1RBVEUudHV0b3JpYWxBY3RpdmUgPSAhU1RBVEUudHV0b3JpYWxBY3RpdmU7CiAgICAgICAgICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtbW9kZS1idG4nKTsKICAgICAgICAgIGJ0bi5pbm5lclRleHQgPSAnSGVscCBNb2RlOiAnICsgKFNUQVRFLnR1dG9yaWFsQWN0aXZlID8gJ09OJyA6ICdPRkYnKTsKICAgICAgICAgIGJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdvbicsIFNUQVRFLnR1dG9yaWFsQWN0aXZlKTsKICAgICAgICAgIGlmICghU1RBVEUudHV0b3JpYWxBY3RpdmUpIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC10aXAnKS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHRvZ2dsZVRhcGVNZWFzdXJlKCkgewogICAgICAgICAgICBTVEFURS5pc1RhcGVBY3RpdmUgPSAhU1RBVEUuaXNUYXBlQWN0aXZlOwogICAgICAgICAgICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLXRhcGUtbWVhc3VyZScpOwogICAgICAgICAgICBidG4uY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgU1RBVEUuaXNUYXBlQWN0aXZlKTsKICAgICAgICAgICAgU1RBVEUudGFwZVBvaW50cyA9IHsgc3RhcnQ6IG51bGwsIGVuZDogbnVsbCB9OwogICAgICAgICAgICBpZiAoU1RBVEUuaXNUYXBlQWN0aXZlKSB7CiAgICAgICAgICAgICAgICBTVEFURS5zZWxlY3RlZElkcyA9IFtdOwogICAgICAgICAgICAgICAgc2hvd1RpcCgndGFwZScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlbmRlcjJEKCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB0b2dnbGVOaWdodE1vZGUoKSB7CiAgICAgICAgICAgIGlmIChNT0RFICE9PSAnb3V0c2lkZScpIHJldHVybjsKICAgICAgICAgICAgU1RBVEUuaXNOaWdodE1vZGUgPSAhU1RBVEUuaXNOaWdodE1vZGU7CiAgICAgICAgICAgIHVwZGF0ZU5pZ2h0TW9kZVVJKCk7CiAgICAgICAgICAgIGlmIChTVEFURS52aWV3ID09PSAnM2QnKSB7CiAgICAgICAgICAgICAgICBpbml0M0QoKTsgCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZW5kZXIyRCgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB1cGRhdGVOaWdodE1vZGVVSSgpIHsKICAgICAgICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zvb3Rlci1uaWdodC1idG4nKTsKICAgICAgICAgICAgaWYgKGJ0bikgYnRuLmlubmVyVGV4dCA9IFNUQVRFLmlzTmlnaHRNb2RlID8gJ+KYgO+4jycgOiAn8J+MmSc7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBDRUxMX1NJWkUgPSAyMDsKICAgICAgICBjb25zdCBHUkFTU19CT1JERVIgPSAxMDsKICAgICAgICBjb25zdCBPVVRTSURFX0JPUkRFUiA9IDEwMDsKICAgICAgICBjb25zdCBib3JkZXJDZWxscyA9IE1PREUgPT09ICdvdXRzaWRlJyA/IE9VVFNJREVfQk9SREVSIDogR1JBU1NfQk9SREVSOwogICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKTsKICAgICAgICBjb25zdCBjYW52YXNXcmFwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcy13cmFwJyk7CiAgICAgICAgY29uc3QgdGFwZU92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFwZS1tZWFzdXJlLW92ZXJsYXknKTsKICAgICAgICBjb25zdCB0aHJlZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aHJlZS1jb250YWluZXInKTsKICAgICAgICBjb25zdCB0aHJlZU92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhyZWUtb3ZlcmxheScpOwogICAgICAgIGNvbnN0IHNlbGVjdGlvbkJveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxlY3Rpb24tYm94Jyk7CgogICAgICAgIGZ1bmN0aW9uIHNhZmVOdW0obiwgZmFsbGJhY2spIHsKICAgICAgICAgICAgcmV0dXJuICh0eXBlb2YgbiA9PT0gJ251bWJlcicgJiYgaXNGaW5pdGUobikpID8gbiA6IGZhbGxiYWNrOwogICAgICAgIH0KCiAgICAgICAgLy8gV2hlbiB0aGVyZSBpcyBubyB0ZW50IGluIG91dHNpZGUgbW9kZSwgY29tcHV0ZSBhIHJlYXNvbmFibGUgIm9wZW4gYXJlYSIgc2l6ZQogICAgICAgIC8vIGJhc2VkIG9uIHRoZSBwbGFjZWQgaXRlbXMgc28gMkQvM0QgcHJldmlld3Mgc3RpbGwgd29yay4KICAgICAgICBmdW5jdGlvbiBjb21wdXRlT3BlbkFyZWFTaXplRnQoKSB7CiAgICAgICAgICAgIGNvbnN0IGl0ZW1zID0gQXJyYXkuaXNBcnJheShTVEFURS5pdGVtcykgPyBTVEFURS5pdGVtcyA6IFtdOwogICAgICAgICAgICBsZXQgbWF4WCA9IDA7IGxldCBtYXhZID0gMDsKICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7CiAgICAgICAgICAgICAgICBjb25zdCBkZWYgPSBJVEVNX0RFRlNbaXRlbS5uYW1lXTsKICAgICAgICAgICAgICAgIGlmICghZGVmKSBjb250aW51ZTsKCiAgICAgICAgICAgICAgICAvLyBEcmFwZSBwb2ludHMgYXJlIHN0b3JlZCBpbiBweCBvZmZzZXRzOyBpbmNsdWRlIHRoZWlyIGV4dGVudHMuCiAgICAgICAgICAgICAgICBpZiAoZGVmLnR5cGUgPT09ICdkcmFwZScgJiYgQXJyYXkuaXNBcnJheShpdGVtLmRyYXBlUG9pbnRzKSAmJiBpdGVtLmRyYXBlUG9pbnRzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSAoKGl0ZW0uYW5nbGVEZWcgfHwgMCkgKiBNYXRoLlBJKSAvIDE4MDsKICAgICAgICAgICAgICAgICAgICBjb25zdCBjb3MgPSBNYXRoLmNvcyhhKSwgc2luID0gTWF0aC5zaW4oYSk7CiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBwIG9mIGl0ZW0uZHJhcGVQb2ludHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcnggPSBwLnggKiBjb3MgLSBwLnkgKiBzaW47CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJ5ID0gcC54ICogc2luICsgcC55ICogY29zOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBweEZ0ID0gKChzYWZlTnVtKGl0ZW0ueCwgMCkgKyByeCkgLyBDRUxMX1NJWkUpIC0gYm9yZGVyQ2VsbHM7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHB5RnQgPSAoKHNhZmVOdW0oaXRlbS55LCAwKSArIHJ5KSAvIENFTExfU0laRSkgLSBib3JkZXJDZWxsczsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHB4RnQgPiBtYXhYKSBtYXhYID0gcHhGdDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHB5RnQgPiBtYXhZKSBtYXhZID0gcHlGdDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29uc3QgdyA9IHNhZmVOdW0oaXRlbS53aWR0aCwgc2FmZU51bShkZWYud2lkdGgsIHNhZmVOdW0oZGVmLmRpYW1ldGVyLCAxKSkpOwogICAgICAgICAgICAgICAgY29uc3QgaCA9IHNhZmVOdW0oaXRlbS5oZWlnaHQsIHNhZmVOdW0oZGVmLmhlaWdodCwgc2FmZU51bShkZWYuZGlhbWV0ZXIsIDEpKSk7CiAgICAgICAgICAgICAgICBjb25zdCBsZWZ0RnQgPSAoc2FmZU51bShpdGVtLngsIDApIC8gQ0VMTF9TSVpFKSAtIGJvcmRlckNlbGxzOwogICAgICAgICAgICAgICAgY29uc3QgdG9wRnQgPSAoc2FmZU51bShpdGVtLnksIDApIC8gQ0VMTF9TSVpFKSAtIGJvcmRlckNlbGxzOwogICAgICAgICAgICAgICAgY29uc3QgcmlnaHRGdCA9IGxlZnRGdCArIHc7CiAgICAgICAgICAgICAgICBjb25zdCBib3R0b21GdCA9IHRvcEZ0ICsgaDsKICAgICAgICAgICAgICAgIGlmIChyaWdodEZ0ID4gbWF4WCkgbWF4WCA9IHJpZ2h0RnQ7CiAgICAgICAgICAgICAgICBpZiAoYm90dG9tRnQgPiBtYXhZKSBtYXhZID0gYm90dG9tRnQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IHBhZEZ0ID0gNTsKICAgICAgICAgICAgY29uc3QgYmFzZSA9IDYwOwogICAgICAgICAgICBjb25zdCB3RnQgPSBNYXRoLm1heCgyMCwgTWF0aC5jZWlsKCgobWF4WCA+IDAgPyBtYXhYIDogYmFzZSkgKyBwYWRGdCkpKTsKICAgICAgICAgICAgY29uc3QgaEZ0ID0gTWF0aC5tYXgoMjAsIE1hdGguY2VpbCgoKG1heFkgPiAwID8gbWF4WSA6IGJhc2UpICsgcGFkRnQpKSk7CiAgICAgICAgICAgIHJldHVybiB7IHc6IHdGdCwgaDogaEZ0IH07CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBnZXRMYXlvdXRTaXplRnQoKSB7CiAgICAgICAgICAgIGlmIChNT0RFID09PSAnaW5zaWRlJykgewogICAgICAgICAgICAgICAgcmV0dXJuIHsgdzogc2FmZU51bShTVEFURS5yb29tPy53aWR0aCwgNjApLCBoOiBzYWZlTnVtKFNUQVRFLnJvb20/LmRlcHRoLCA2MCksIGhhc1RlbnQ6IGZhbHNlIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKFNUQVRFLnRlbnQgJiYgdHlwZW9mIFNUQVRFLnRlbnQud2lkdGggPT09ICdudW1iZXInICYmIHR5cGVvZiBTVEFURS50ZW50LmhlaWdodCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgICAgIHJldHVybiB7IHc6IHNhZmVOdW0oU1RBVEUudGVudC53aWR0aCwgNjApLCBoOiBzYWZlTnVtKFNUQVRFLnRlbnQuaGVpZ2h0LCA2MCksIGhhc1RlbnQ6IHRydWUgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBzID0gY29tcHV0ZU9wZW5BcmVhU2l6ZUZ0KCk7CiAgICAgICAgICAgIHJldHVybiB7IHc6IHMudywgaDogcy5oLCBoYXNUZW50OiBmYWxzZSB9OwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgICAgICAgaWYgKFRVVE9SSUFMX0ZMQUcpIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1tb2RlLWJ0bicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICB1cGRhdGVOaWdodE1vZGVVSSgpOwogICAgICAgICAgICByZW5kZXIyRCgpOwogICAgICAgICAgICBzZXR1cFNlbGVjdGlvbigpOwogICAgICAgICAgICBhdXRvRml0KCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoJzNkJyA9PT0gJzNkJykgewogICAgICAgICAgICAgICAgdG9nZ2xlVmlldygpOwogICAgICAgICAgICAgICAgaWYgKCFTVEFURS5kcm9uZU1vZGUpIHRvZ2dsZURyb25lTW9kZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBhdXRvRml0KCkgewogICAgICAgICAgICBjb25zdCBzID0gZ2V0TGF5b3V0U2l6ZUZ0KCk7CiAgICAgICAgICAgIGNvbnN0IHcgPSBzLnc7CiAgICAgICAgICAgIGNvbnN0IGggPSBzLmg7CiAgICAgICAgICAgIGNvbnN0IHRXID0gKHcgKyBib3JkZXJDZWxscyAqIDIpICogQ0VMTF9TSVpFOwogICAgICAgICAgICBjb25zdCB0SCA9IChoICsgYm9yZGVyQ2VsbHMgKiAyKSAqIENFTExfU0laRTsKICAgICAgICAgICAgY29uc3Qgc1cgPSB3aW5kb3cuaW5uZXJXaWR0aCAqIDAuOSAvIHRXOwogICAgICAgICAgICBjb25zdCBzSCA9IHdpbmRvdy5pbm5lckhlaWdodCAqIDAuODUgLyB0SDsKICAgICAgICAgICAgU1RBVEUuc2NhbGUgPSBNYXRoLm1pbihzVywgc0gsIDEuMik7CiAgICAgICAgICAgIHVwZGF0ZU5hdigpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gem9vbShkZWx0YSkgeyBTVEFURS5zY2FsZSA9IE1hdGgubWF4KDAuMSwgTWF0aC5taW4oMywgU1RBVEUuc2NhbGUgKyBkZWx0YSkpOyB1cGRhdGVOYXYoKTsgfQogICAgICAgIGZ1bmN0aW9uIHJlc2V0TmF2KCkgeyBTVEFURS5wYW4gPSB7eDowLCB5OjB9OyBhdXRvRml0KCk7IH0KICAgICAgICBmdW5jdGlvbiByb3RhdGVMYXlvdXQoKSB7IFNUQVRFLnJvdGF0aW9uID0gKFNUQVRFLnJvdGF0aW9uICsgOTApICUgMzYwOyB1cGRhdGVOYXYoKTsgcmVuZGVyMkQoKTsgfQogICAgICAgIGZ1bmN0aW9uIHVwZGF0ZU5hdigpIHsgY2FudmFzV3JhcC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCR7U1RBVEUucGFuLnh9cHgsICR7U1RBVEUucGFuLnl9cHgpIHNjYWxlKCR7U1RBVEUuc2NhbGV9KSByb3RhdGUoJHtTVEFURS5yb3RhdGlvbn1kZWcpYDsgfQoKICAgICAgICBmdW5jdGlvbiBzZXR1cFNlbGVjdGlvbigpIHsKICAgICAgICAgICAgbGV0IHN0YXJ0ID0gbnVsbDsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXdwb3J0LTJkJykuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGUpID0+IHsKICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KCcuaXRlbScpIHx8IGUudGFyZ2V0LmNsb3Nlc3QoJy5pdGVtLXRvb2xiYXInKSB8fCBlLnRhcmdldC5jbG9zZXN0KCcucm90YXRlLWhhbmRsZScpIHx8IGUudGFyZ2V0LmNsb3Nlc3QoJy53YWxsLXRyaWdnZXInKSB8fCBlLnRhcmdldC5jbG9zZXN0KCcuc3RhZ2UtcmFpbC10cmlnZ2VyJykgfHwgZS50YXJnZXQuY2xvc2VzdCgnLm1haW4tdG9vbGJhcicpIHx8IGUudGFyZ2V0LmNsb3Nlc3QoJy5saW5lbi1tZW51JykgfHwgZS50YXJnZXQuY2xvc2VzdCgnLnNlZy1sYWJlbC1ncm91cCcpKSByZXR1cm47CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIChTVEFURS5pc1RhcGVBY3RpdmUpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCByZWN0ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbnRlclggPSByZWN0LmxlZnQgKyByZWN0LndpZHRoIC8gMjsKICAgICAgICAgICAgICAgICAgICBjb25zdCBjZW50ZXJZID0gcmVjdC50b3AgKyByZWN0LmhlaWdodCAvIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmFkID0gKC1TVEFURS5yb3RhdGlvbiAqIE1hdGguUEkpIC8gMTgwOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlbFggPSAoZS5jbGllbnRYIC0gY2VudGVyWCkgLyBTVEFURS5zY2FsZTsKICAgICAgICAgICAgICAgICAgICBjb25zdCByZWxZID0gKGUuY2xpZW50WSAtIGNlbnRlclkpIC8gU1RBVEUuc2NhbGU7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHggPSAocmVsWCAqIE1hdGguY29zKHJhZCkgLSByZWxZICogTWF0aC5zaW4ocmFkKSkgKyBjYW52YXMub2Zmc2V0V2lkdGggLyAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHR5ID0gKHJlbFggKiBNYXRoLnNpbihyYWQpICsgcmVsWSAqIE1hdGguY29zKHJhZCkpICsgY2FudmFzLm9mZnNldEhlaWdodCAvIDI7CgogICAgICAgICAgICAgICAgICAgIGlmICghU1RBVEUudGFwZVBvaW50cy5zdGFydCB8fCAoU1RBVEUudGFwZVBvaW50cy5zdGFydCAmJiBTVEFURS50YXBlUG9pbnRzLmVuZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgU1RBVEUudGFwZVBvaW50cyA9IHsgc3RhcnQ6IHsgeDogdHgsIHk6IHR5IH0sIGVuZDogbnVsbCB9OwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFNUQVRFLnRhcGVQb2ludHMuZW5kID0geyB4OiB0eCwgeTogdHkgfTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmVuZGVyMkQoKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgc3RhcnQgPSB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07CiAgICAgICAgICAgICAgICBzZWxlY3Rpb25Cb3guc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICBzZWxlY3Rpb25Cb3guc3R5bGUud2lkdGggPSAnMCc7CiAgICAgICAgICAgICAgICBzZWxlY3Rpb25Cb3guc3R5bGUuaGVpZ2h0ID0gJzAnOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgaWYgKFNUQVRFLmlzVGFwZUFjdGl2ZSAmJiBTVEFURS50YXBlUG9pbnRzLnN0YXJ0ICYmICFTVEFURS50YXBlUG9pbnRzLmVuZCkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlY3QgPSBjYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2VudGVyWCA9IHJlY3QubGVmdCArIHJlY3Qud2lkdGggLyAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbnRlclkgPSByZWN0LnRvcCArIHJlY3QuaGVpZ2h0IC8gMjsKICAgICAgICAgICAgICAgICAgICBjb25zdCByYWQgPSAoLVNUQVRFLnJvdGF0aW9uICogTWF0aC5QSSkgLyAxODA7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVsWCA9IChlLmNsaWVudFggLSBjZW50ZXJYKSAvIFNUQVRFLnNjYWxlOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlbFkgPSAoZS5jbGllbnRZIC0gY2VudGVyWSkgLyBTVEFURS5zY2FsZTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0eCA9IChyZWxYICogTWF0aC5jb3MocmFkKSAtIHJlbFkgKiBNYXRoLnNpbihyYWQpKSArIGNhbnZhcy5vZmZzZXRXaWR0aCAvIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHkgPSAocmVsWCAqIE1hdGguc2luKHJhZCkgKyByZWxZICogTWF0aC5jb3MocmFkKSkgKyBjYW52YXMub2Zmc2V0SGVpZ2h0IC8gMjsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICByZW5kZXJUYXBlUHJldmlldyhTVEFURS50YXBlUG9pbnRzLnN0YXJ0LngsIFNUQVRFLnRhcGVQb2ludHMuc3RhcnQueSwgdHgsIHR5KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCFzdGFydCkgcmV0dXJuOwogICAgICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsKICAgICAgICAgICAgICAgIGNvbnN0IHggPSBNYXRoLm1pbihzdGFydC54LCBjdXJyZW50LngpOwogICAgICAgICAgICAgICAgY29uc3QgeSA9IE1hdGgubWluKHN0YXJ0LnksIGN1cnJlbnQueSk7CiAgICAgICAgICAgICAgICBjb25zdCB3ID0gTWF0aC5hYnMoc3RhcnQueCAtIGN1cnJlbnQueCk7CiAgICAgICAgICAgICAgICBjb25zdCBoID0gTWF0aC5hYnMoY3VycmVudC55IC0gc3RhcnQueSk7CiAgICAgICAgICAgICAgICBzZWxlY3Rpb25Cb3guc3R5bGUubGVmdCA9IHggKyAncHgnOwogICAgICAgICAgICAgICAgc2VsZWN0aW9uQm94LnN0eWxlLnRvcCA9IHkgKyAncHgnOwogICAgICAgICAgICAgICAgc2VsZWN0aW9uQm94LnN0eWxlLndpZHRoID0gdyArICdweCc7CiAgICAgICAgICAgICAgICBzZWxlY3Rpb25Cb3guc3R5bGUuaGVpZ2h0ID0gaCArICdweCc7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgaWYgKCFzdGFydCkgcmV0dXJuOwogICAgICAgICAgICAgICAgaWYgKHNlbGVjdGlvbkJveC5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVjdCA9IHNlbGVjdGlvbkJveC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVjdC53aWR0aCA8IDUgJiYgcmVjdC5oZWlnaHQgPCA1KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFNUQVRFLnNlbGVjdGVkSWRzID0gW107CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3U2VsZWN0aW9uID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgIFNUQVRFLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpdGVtLScgKyBpdGVtLmlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1SZWN0ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1SZWN0LmxlZnQgPCByZWN0LnJpZ2h0ICYmIGl0ZW1SZWN0LnJpZ2h0ID4gcmVjdC5sZWZ0ICYmIGl0ZW1SZWN0LnRvcCA8IHJlY3QuYm90dG9tICYmIGl0ZW1SZWN0LmJvdHRvbSA+IHJlY3QudG9wKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1NlbGVjdGlvbi5wdXNoKGl0ZW0uaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIFNUQVRFLnNlbGVjdGVkSWRzID0gbmV3U2VsZWN0aW9uOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZW5kZXIyRCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc3RhcnQgPSBudWxsOwogICAgICAgICAgICAgICAgc2VsZWN0aW9uQm94LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB3aW5kb3cub253aGVlbCA9IChlKSA9PiB7IHpvb20oZS5kZWx0YVkgPiAwID8gLTAuMDUgOiAwLjA1KTsgfTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHJlbmRlclRhcGVQcmV2aWV3KHgxLCB5MSwgeDIsIHkyKSB7CiAgICAgICAgICAgIHRhcGVPdmVybGF5LmlubmVySFRNTCA9ICcnOwogICAgICAgICAgICBjb25zdCBsaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsICJsaW5lIik7CiAgICAgICAgICAgIGxpbmUuc2V0QXR0cmlidXRlKCJ4MSIsIHgxKTsgbGluZS5zZXRBdHRyaWJ1dGUoInkxIiwgeTEpOwogICAgICAgICAgICBsaW5lLnNldEF0dHJpYnV0ZSgieDIiLCB4Mik7IGxpbmUuc2V0QXR0cmlidXRlKCJ5MiIsIHkyKTsKICAgICAgICAgICAgbGluZS5zZXRBdHRyaWJ1dGUoInN0cm9rZSIsICIjZmFjYzE1Iik7IGxpbmUuc2V0QXR0cmlidXRlKCJzdHJva2Utd2lkdGgiLCAiMyIpOwogICAgICAgICAgICBsaW5lLnNldEF0dHJpYnV0ZSgic3Ryb2tlLWRhc2hhcnJheSIsICI4LDQiKTsKICAgICAgICAgICAgdGFwZU92ZXJsYXkuYXBwZW5kQ2hpbGQobGluZSk7CgogICAgICAgICAgICBjb25zdCBkeCA9ICh4MiAtIHgxKSAvIENFTExfU0laRTsgY29uc3QgZHkgPSAoeTIgLSB5MSkgLyBDRUxMX1NJWkU7CiAgICAgICAgICAgIGNvbnN0IGRpc3QgPSBNYXRoLnNxcnQoZHgqZHggKyBkeSpkeSk7CiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwgInRleHQiKTsKICAgICAgICAgICAgdGV4dC5zZXRBdHRyaWJ1dGUoIngiLCAoeDEgKyB4MikgLyAyKTsgdGV4dC5zZXRBdHRyaWJ1dGUoInkiLCAoeTEgKyB5MikgLyAyIC0gMTApOwogICAgICAgICAgICB0ZXh0LnNldEF0dHJpYnV0ZSgiZmlsbCIsICIjZmFjYzE1Iik7IHRleHQuc2V0QXR0cmlidXRlKCJ0ZXh0LWFuY2hvciIsICJtaWRkbGUiKTsKICAgICAgICAgICAgdGV4dC5zdHlsZS5mb250U2l6ZSA9ICIxNnB4IjsgdGV4dC5zdHlsZS5mb250V2VpZ2h0ID0gIjkwMCI7IHRleHQuc3R5bGUuZm9udFN0eWxlID0gIml0YWxpYyI7CiAgICAgICAgICAgIHRleHQudGV4dENvbnRlbnQgPSBkaXN0LnRvRml4ZWQoMSkgKyAiJyI7CiAgICAgICAgICAgIHRhcGVPdmVybGF5LmFwcGVuZENoaWxkKHRleHQpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZ2V0V2FsbFNwYWNpbmcodGVudFR5cGUsIGxlbikgewogICAgICAgICAgICBpZiAodGVudFR5cGUgPT09ICdQb3B1cCcpIHJldHVybiAxMDsKICAgICAgICAgICAgaWYgKHRlbnRUeXBlID09PSAnUG9sZScpIHJldHVybiAyMDsKICAgICAgICAgICAgaWYgKHRlbnRUeXBlID09PSAnTWFycXVlZScpIHsKICAgICAgICAgICAgICAgaWYgKGxlbiAlIDE1ID09PSAwKSByZXR1cm4gMTU7CiAgICAgICAgICAgICAgIHJldHVybiAyMDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gMTA7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBjb21wdXRlV2FsbFNlZ21lbnRzKHRlbnRUeXBlLCBsZW5ndGgpIHsKICAgICAgICAgICAgY29uc3QgbWF4U2VnID0gZ2V0V2FsbFNwYWNpbmcodGVudFR5cGUsIGxlbmd0aCk7CiAgICAgICAgICAgIGNvbnN0IGNvdW50ID0gTWF0aC5tYXgoMSwgTWF0aC5jZWlsKGxlbmd0aCAvIG1heFNlZykpOwogICAgICAgICAgICBjb25zdCBzZWdMZW4gPSBsZW5ndGggLyBjb3VudDsKICAgICAgICAgICAgY29uc3Qgc2VncyA9IFtdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHNlZ3MucHVzaCh7IHN0YXJ0OiBpICogc2VnTGVuLCBsZW5ndGg6IHNlZ0xlbiB9KTsKICAgICAgICAgICAgcmV0dXJuIHNlZ3M7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBzeW1tZXRyaWNJbnRlcmlvclBvc2l0aW9ucyhsZW5ndGgsIG1heFNwYW4pIHsKICAgICAgICAgICAgaWYgKGxlbmd0aCA8PSBtYXhTcGFuICsgMWUtNikgcmV0dXJuIFtsZW5ndGggLyAyXTsKICAgICAgICAgICAgY29uc3Qgc2VjdGlvbnMgPSBNYXRoLmNlaWwobGVuZ3RoIC8gbWF4U3Bhbik7CiAgICAgICAgICAgIGNvbnN0IGJheSA9IGxlbmd0aCAvIHNlY3Rpb25zOwogICAgICAgICAgICBjb25zdCBvdXQgPSBbXTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBzZWN0aW9uczsgaSsrKSBvdXQucHVzaChpICogYmF5KTsKICAgICAgICAgICAgcmV0dXJuIG91dDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGNvbXB1dGVQb2xlUGVha3MyRCh3LCBoKSB7CiAgICAgICAgICAgIGNvbnN0IGxvbmdJc0ggPSBoID49IHc7CiAgICAgICAgICAgIGNvbnN0IGxvbmdMZW4gPSBNYXRoLm1heCh3LCBoKTsKICAgICAgICAgICAgY29uc3Qgc3BhbiA9IE1hdGgubWluKHcsIGgpOwogICAgICAgICAgICBjb25zdCBsb25nUG9zaXRpb25zID0gc3ltbWV0cmljSW50ZXJpb3JQb3NpdGlvbnMobG9uZ0xlbiwgMjApOwogICAgICAgICAgICBjb25zdCByb3dQb3NpdGlvbnMgPSBzcGFuIDw9IDQwID8gW3NwYW4gLyAyXSA6IHN5bW1ldHJpY0ludGVyaW9yUG9zaXRpb25zKHNwYW4sIDIwKTsKCiAgICAgICAgICAgIGNvbnN0IHBlYWtzID0gW107CiAgICAgICAgICAgIGlmIChsb25nSXNIKSB7CiAgICAgICAgICAgICAgICByb3dQb3NpdGlvbnMuZm9yRWFjaCgoeCkgPT4gbG9uZ1Bvc2l0aW9ucy5mb3JFYWNoKCh5KSA9PiBwZWFrcy5wdXNoKHsgeCwgeSB9KSkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbG9uZ1Bvc2l0aW9ucy5mb3JFYWNoKCh4KSA9PiByb3dQb3NpdGlvbnMuZm9yRWFjaCgoeSkgPT4gcGVha3MucHVzaCh7IHgsIHkgfSkpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcGVha3M7CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVRhbGx5KCkgewogICAgICAgICAgICBsZXQgdGFibGVzID0gMCwgc2VhdHMgPSAwLCBvdGhlciA9IDA7CiAgICAgICAgICAgIFNUQVRFLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoaXRlbS5uYW1lLmluY2x1ZGVzKCd0YWJsZScpIHx8IGl0ZW0ubmFtZS5pbmNsdWRlcygnY29ja3RhaWwnKSkgdGFibGVzKys7CiAgICAgICAgICAgICAgICBlbHNlIG90aGVyKys7CiAgICAgICAgICAgICAgICBzZWF0cyArPSAoaXRlbS5zZWF0cyB8fCAwKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnN0IHMgPSBnZXRMYXlvdXRTaXplRnQoKTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RhbGx5LXR5cGUtbGFiZWwnKS5pbm5lclRleHQgPSBNT0RFID09PSAnaW5zaWRlJyA/ICdSb29tJyA6IChzLmhhc1RlbnQgPyAnVGVudCcgOiAnT3V0c2lkZScpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVudC10eXBlJykuaW5uZXJUZXh0ID0gTU9ERSA9PT0gJ2luc2lkZScKICAgICAgICAgICAgICAgID8gYCR7U1RBVEUucm9vbS53aWR0aH14JHtTVEFURS5yb29tLmRlcHRofWAKICAgICAgICAgICAgICAgIDogKFNUQVRFLnRlbnQ/LmxhYmVsIHx8IGAke3Mud314JHtzLmh9IE9wZW4gQXJlYWApOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY291bnQtdGFibGVzJykuaW5uZXJUZXh0ID0gdGFibGVzOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY291bnQtc2VhdHMnKS5pbm5lclRleHQgPSBzZWF0czsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvdW50LW90aGVyJykuaW5uZXJUZXh0ID0gb3RoZXI7CiAgICAgICAgICAgIHNob3dUaXAoJ3RhbGx5Jyk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBkdXBsaWNhdGVTZWxlY3Rpb24oKSB7CiAgICAgICAgICAgIGlmIChTVEFURS5zZWxlY3RlZElkcy5sZW5ndGggPT09IDApIHJldHVybjsKICAgICAgICAgICAgcHVzaEhpc3RvcnkoKTsKICAgICAgICAgICAgY29uc3QgbmV3SWRzID0gW107CiAgICAgICAgICAgIFNUQVRFLnNlbGVjdGVkSWRzLmZvckVhY2goaWQgPT4gewogICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWwgPSBTVEFURS5pdGVtcy5maW5kKGkgPT4gaS5pZCA9PT0gaWQpOwogICAgICAgICAgICAgICAgaWYgKG9yaWdpbmFsKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3SXRlbSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgLi4ub3JpZ2luYWwsCiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSksCiAgICAgICAgICAgICAgICAgICAgICAgIHg6IG9yaWdpbmFsLnggKyBDRUxMX1NJWkUgKiAyLAogICAgICAgICAgICAgICAgICAgICAgICB5OiBvcmlnaW5hbC55ICsgQ0VMTF9TSVpFICogMgogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgU1RBVEUuaXRlbXMucHVzaChuZXdJdGVtKTsKICAgICAgICAgICAgICAgICAgICBuZXdJZHMucHVzaChuZXdJdGVtLmlkKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIFNUQVRFLnNlbGVjdGVkSWRzID0gbmV3SWRzOwogICAgICAgICAgICByZW5kZXIyRCgpOwogICAgICAgICAgICBzaG93VGlwKCdkdXBsaWNhdGUnKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZnVuY3Rpb24gZGVsZXRlU2VsZWN0aW9uKCkgewogICAgICAgICAgICBwdXNoSGlzdG9yeSgpOwogICAgICAgICAgICBTVEFURS5pdGVtcyA9IFNUQVRFLml0ZW1zLmZpbHRlcihpID0+ICFTVEFURS5zZWxlY3RlZElkcy5pbmNsdWRlcyhpLmlkKSk7CiAgICAgICAgICAgIFNUQVRFLnNlbGVjdGVkSWRzID0gW107CiAgICAgICAgICAgIHJlbmRlcjJEKCk7CiAgICAgICAgICAgIHNob3dUaXAoJ2RlbGV0ZScpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gdXBkYXRlU2VsZWN0aW9uUHJvcGVydHkodXBkYXRlcykgewogICAgICAgICAgICBwdXNoSGlzdG9yeSgpOwogICAgICAgICAgICBTVEFURS5pdGVtcyA9IFNUQVRFLml0ZW1zLm1hcChpID0+IHsKICAgICAgICAgICAgICAgIGlmIChTVEFURS5zZWxlY3RlZElkcy5pbmNsdWRlcyhpLmlkKSkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHUgPSB7IC4uLnVwZGF0ZXMgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4geyAuLi5pLCAuLi51IH07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gaTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJlbmRlcjJEKCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBhcHBseUNoYWlyMkRTdHlsZShlbCwgY2hhaXJTdHlsZU92ZXJyaWRlLCBjdXNoaW9uT3ZlcnJpZGUpIHsKICAgIGNvbnN0IHN0eWxlID0gY2hhaXJTdHlsZU92ZXJyaWRlIHx8IFNUQVRFLmNoYWlyU3R5bGUgfHwgJ2ZvbGRpbmdfd2hpdGUnOwogICAgY29uc3QgY3VzaGlvbk9uID0gKHR5cGVvZiBjdXNoaW9uT3ZlcnJpZGUgPT09ICdib29sZWFuJykgPyBjdXNoaW9uT3ZlcnJpZGUgOiBTVEFURS5jaGlhdmFyaUN1c2hpb247CgogICAgZWwuZGF0YXNldC5jaGFpciA9IHN0eWxlOwogICAgaWYgKFN0cmluZyhzdHlsZSB8fCAnJykuc3RhcnRzV2l0aCgnY2hpYXZhcmlfJykgJiYgY3VzaGlvbk9uKSB7CiAgICAgICAgZWwuZGF0YXNldC5jdXNoaW9uID0gJzEnOwogICAgfSBlbHNlIHsKICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtY3VzaGlvbicpOwogICAgfQp9CgogICAgICAgIGZ1bmN0aW9uIHJlbmRlcjJEKCkgewogICAgICAgICAgICBjYW52YXMuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgICAgIHRhcGVPdmVybGF5LmlubmVySFRNTCA9ICcnOwogICAgICAgICAgICB1cGRhdGVUYWxseSgpOwogICAgICAgICAgICBjb25zdCBzID0gZ2V0TGF5b3V0U2l6ZUZ0KCk7CiAgICAgICAgICAgIGNvbnN0IHcgPSBzLnc7CiAgICAgICAgICAgIGNvbnN0IGggPSBzLmg7CiAgICAgICAgICAgIAogICAgICAgICAgICBjYW52YXMuc3R5bGUud2lkdGggPSAodyArIGJvcmRlckNlbGxzICogMikgKiBDRUxMX1NJWkUgKyAncHgnOwogICAgICAgICAgICBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gKGggKyBib3JkZXJDZWxscyAqIDIpICogQ0VMTF9TSVpFICsgJ3B4JzsKICAgICAgICAgICAgY2FudmFzLnN0eWxlLmJhY2tncm91bmQgPSBNT0RFID09PSAnaW5zaWRlJyA/IFNUQVRFLnJvb20uZmxvb3JDb2xvciA6IChTVEFURS5pc05pZ2h0TW9kZSA/ICcjMWUyOTFiJyA6ICcjNGQ2YTQxJyk7CgogICAgICAgICAgICBjb25zdCBpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBpbm5lci5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7IGlubmVyLnN0eWxlLmxlZnQgPSBib3JkZXJDZWxscyAqIENFTExfU0laRSArICdweCc7CiAgICAgICAgICAgIGlubmVyLnN0eWxlLnRvcCA9IGJvcmRlckNlbGxzICogQ0VMTF9TSVpFICsgJ3B4JzsgaW5uZXIuc3R5bGUud2lkdGggPSB3ICogQ0VMTF9TSVpFICsgJ3B4JzsKICAgICAgICAgICAgaW5uZXIuc3R5bGUuaGVpZ2h0ID0gaCAqIENFTExfU0laRSArICdweCc7IAogICAgICAgICAgICBpbm5lci5zdHlsZS5ib3JkZXIgPSBNT0RFID09PSAnaW5zaWRlJyA/IGA2cHggc29saWQgJHtTVEFURS5yb29tLndhbGxDb2xvcn1gIDogJzRweCBzb2xpZCB3aGl0ZSc7CiAgICAgICAgICAgIGlubmVyLnN0eWxlLmJhY2tncm91bmQgPSBNT0RFID09PSAnaW5zaWRlJyA/ICd0cmFuc3BhcmVudCcgOiAncmdiYSgyNTUsMjU1LDI1NSwwLjA2KSc7CiAgICAgICAgICAgIGlubmVyLnN0eWxlLnpJbmRleCA9ICc1JzsKICAgICAgICAgICAgaW5uZXIub25jbGljayA9ICgpID0+IHsgaWYoIVNUQVRFLmlzVGFwZUFjdGl2ZSkgeyBTVEFURS5zZWxlY3RlZElkcyA9IFtdOyByZW5kZXIyRCgpOyB9IH07CiAgICAgICAgICAgIGNhbnZhcy5hcHBlbmRDaGlsZChpbm5lcik7CgogICAgICAgICAgICBpZihNT0RFID09PSAnb3V0c2lkZScgJiYgcy5oYXNUZW50KSB7CiAgICAgICAgICAgICAgICBjb25zdCB0VCA9IFNUQVRFLnRlbnQudHlwZTsKICAgICAgICAgICAgICAgIGNvbnN0IHdTcCA9IGdldFdhbGxTcGFjaW5nKHRULCB3KTsgY29uc3QgaFNwID0gZ2V0V2FsbFNwYWNpbmcodFQsIGgpOwogICAgICAgICAgICAgICAgY29uc3QgY3JlYXRlVHJpZyA9IChzaWRlLCB4LCB5LCBsZW4sIGlzViwgaWR4KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdXYWxsID0gKFNUQVRFLnRlbnQuc2lkZXdhbGxzIHx8IFtdKS5maW5kKHcgPT4gdy5zaWRlID09PSBzaWRlICYmIHcuaW5kZXggPT09IGlkeCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aXZlID0gISFleGlzdGluZ1dhbGw7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aXZlVHlwZSA9IGV4aXN0aW5nV2FsbD8udHlwZTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IHQuY2xhc3NOYW1lID0gJ3dhbGwtdHJpZ2dlcicgKyAoYWN0aXZlID8gJyBhY3RpdmUnIDogJycpOwogICAgICAgICAgICAgICAgICAgIHQuc3R5bGUubGVmdCA9ICh4ICsgYm9yZGVyQ2VsbHMpICogQ0VMTF9TSVpFICsgJ3B4JzsgdC5zdHlsZS50b3AgPSAoeSArIGJvcmRlckNlbGxzKSAqIENFTExfU0laRSArICdweCc7CiAgICAgICAgICAgICAgICAgICAgdC5zdHlsZS53aWR0aCA9IGlzViA/ICcxOHB4JyA6IChsZW4gKiBDRUxMX1NJWkUpICsgJ3B4JzsgdC5zdHlsZS5oZWlnaHQgPSBpc1YgPyAobGVuICogQ0VMTF9TSVpFKSArICdweCcgOiAnMThweCc7CiAgICAgICAgICAgICAgICAgICAgdC5zdHlsZS50cmFuc2Zvcm0gPSBpc1YgPyAndHJhbnNsYXRlWCgtNTAlKScgOiAndHJhbnNsYXRlWSgtNTAlKSc7IHQuaW5uZXJUZXh0ID0gYWN0aXZlID8gKGFjdGl2ZVR5cGUgPT09ICdzb2xpZCcgPyAnU09MSUQnIDogJ1dJTicpIDogJyc7CiAgICAgICAgICAgICAgICAgICAgdC5zdHlsZS56SW5kZXggPSAnMjAwJzsKICAgICAgICAgICAgICAgICAgICB0Lm9uY2xpY2sgPSAoZSkgPT4geyAKICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsgaWYoIVNUQVRFLnRlbnQuc2lkZXdhbGxzKSBTVEFURS50ZW50LnNpZGV3YWxscyA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICBwdXNoSGlzdG9yeSgpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkZXNpcmVkVHlwZSA9IGUuc2hpZnRLZXkgPyAnc29saWQnIDogJ3dpbmRvdyc7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBTVEFURS50ZW50LnNpZGV3YWxscy5maW5kSW5kZXgodyA9PiB3LnNpZGUgPT09IHNpZGUgJiYgdy5pbmRleCA9PT0gaWR4KTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoaSA+IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFNUQVRFLnRlbnQuc2lkZXdhbGxzW2ldLnR5cGUgIT09IGRlc2lyZWRUeXBlKSBTVEFURS50ZW50LnNpZGV3YWxsc1tpXS50eXBlID0gZGVzaXJlZFR5cGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBTVEFURS50ZW50LnNpZGV3YWxscy5zcGxpY2UoaSwgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgU1RBVEUudGVudC5zaWRld2FsbHMucHVzaCh7c2lkZSwgaW5kZXg6IGlkeCwgdHlwZTogZGVzaXJlZFR5cGV9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZW5kZXIyRCgpOwogICAgICAgICAgICAgICAgICAgICAgICBzaG93VGlwKCd3YWxscycpOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmFwcGVuZENoaWxkKHQpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGNvbnN0IGFkZFBvbGUgPSAoeCwgeSwgY29sb3IgPSAiIzAwMCIpID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IHAuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOyBwLnN0eWxlLndpZHRoID0gJzEwcHgnOyBwLnN0eWxlLmhlaWdodCA9ICcxMHB4JzsKICAgICAgICAgICAgICAgICAgICBwLnN0eWxlLmJhY2tncm91bmQgPSBjb2xvcjsgcC5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNTAlJzsgcC5zdHlsZS56SW5kZXggPSAnMTUwJzsKICAgICAgICAgICAgICAgICAgICBwLnN0eWxlLmxlZnQgPSAoeCArIGJvcmRlckNlbGxzKSAqIENFTExfU0laRSAtIDUgKyAncHgnOyBwLnN0eWxlLnRvcCA9ICh5ICsgYm9yZGVyQ2VsbHMpICogQ0VMTF9TSVpFIC0gNSArICdweCc7CiAgICAgICAgICAgICAgICAgICAgaWYoY29sb3IgIT09ICIjMDAwIikgcC5zdHlsZS5ib3hTaGFkb3cgPSAnMCAwIDEwcHggcmdiYSgyNDQsNjMsOTQsMC42KSc7IGNhbnZhcy5hcHBlbmRDaGlsZChwKTsKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgLy8gSGV4IHdhbGwgdHJpZ2dlcnM6IHJvdGF0ZWQgY2xpY2thYmxlIHNlZ21lbnRzLgogICAgICAgICAgICAgICAgY29uc3QgY3JlYXRlSGV4VHJpZyA9IChpZHgsIG14LCBteSwgbGVuLCBkZWcpID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBleGlzdGluZ1dhbGwgPSAoU1RBVEUudGVudC5zaWRld2FsbHMgfHwgW10pLmZpbmQodyA9PiB3LnNpZGUgPT09ICdoZXgnICYmIHcuaW5kZXggPT09IGlkeCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aXZlID0gISFleGlzdGluZ1dhbGw7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aXZlVHlwZSA9IGV4aXN0aW5nV2FsbD8udHlwZTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IHQuY2xhc3NOYW1lID0gJ3dhbGwtdHJpZ2dlcicgKyAoYWN0aXZlID8gJyBhY3RpdmUnIDogJycpOwogICAgICAgICAgICAgICAgICAgIHQuc3R5bGUubGVmdCA9IChteCArIGJvcmRlckNlbGxzKSAqIENFTExfU0laRSArICdweCc7IHQuc3R5bGUudG9wID0gKG15ICsgYm9yZGVyQ2VsbHMpICogQ0VMTF9TSVpFICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICB0LnN0eWxlLndpZHRoID0gKGxlbiAqIENFTExfU0laRSkgKyAncHgnOyB0LnN0eWxlLmhlaWdodCA9ICcxOHB4JzsKICAgICAgICAgICAgICAgICAgICB0LnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUoLTUwJSwgLTUwJSkgcm90YXRlKCcgKyBkZWcgKyAnZGVnKSc7CiAgICAgICAgICAgICAgICAgICAgdC5pbm5lclRleHQgPSBhY3RpdmUgPyAoYWN0aXZlVHlwZSA9PT0gJ3NvbGlkJyA/ICdTT0xJRCcgOiAnV0lOJykgOiAnJzsKICAgICAgICAgICAgICAgICAgICB0LnN0eWxlLnpJbmRleCA9ICcyMDAnOwogICAgICAgICAgICAgICAgICAgIHQub25jbGljayA9IChlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7IGlmKCFTVEFURS50ZW50LnNpZGV3YWxscykgU1RBVEUudGVudC5zaWRld2FsbHMgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgcHVzaEhpc3RvcnkoKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVzaXJlZFR5cGUgPSBlLnNoaWZ0S2V5ID8gJ3NvbGlkJyA6ICd3aW5kb3cnOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gU1RBVEUudGVudC5zaWRld2FsbHMuZmluZEluZGV4KHcgPT4gdy5zaWRlID09PSAnaGV4JyAmJiB3LmluZGV4ID09PSBpZHgpOwogICAgICAgICAgICAgICAgICAgICAgICBpZihpID4gLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoU1RBVEUudGVudC5zaWRld2FsbHNbaV0udHlwZSAhPT0gZGVzaXJlZFR5cGUpIFNUQVRFLnRlbnQuc2lkZXdhbGxzW2ldLnR5cGUgPSBkZXNpcmVkVHlwZTsKICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIFNUQVRFLnRlbnQuc2lkZXdhbGxzLnNwbGljZShpLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBTVEFURS50ZW50LnNpZGV3YWxscy5wdXNoKHtzaWRlOiAnaGV4JywgaW5kZXg6IGlkeCwgdHlwZTogZGVzaXJlZFR5cGV9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZW5kZXIyRCgpOwogICAgICAgICAgICAgICAgICAgICAgICBzaG93VGlwKCd3YWxscycpOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmFwcGVuZENoaWxkKHQpOwogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBpZiAodFQgPT09ICdIZXgnKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2lkZUxlbiA9IFNUQVRFLnRlbnQuc2lkZUxlbmd0aCB8fCAoaCAvIDIpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGN4ID0gdyAvIDI7IGNvbnN0IGN5ID0gaCAvIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmVydHMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiA2IH0sIChfLCBpKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSAoLU1hdGguUEkgLyAyKSArIGkgKiAoTWF0aC5QSSAvIDMpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB4OiBjeCArIHNpZGVMZW4gKiBNYXRoLmNvcyhhKSwgeTogY3kgKyBzaWRlTGVuICogTWF0aC5zaW4oYSkgfTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAvLyBUcmlnZ2VycyArIHBvbGVzCiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYSA9IHZlcnRzW2ldOyBjb25zdCBiID0gdmVydHNbKGkgKyAxKSAlIDZdOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBteCA9IChhLnggKyBiLngpIC8gMjsgY29uc3QgbXkgPSAoYS55ICsgYi55KSAvIDI7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxlbiA9IE1hdGguaHlwb3QoYi54IC0gYS54LCBiLnkgLSBhLnkpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkZWcgPSBNYXRoLmF0YW4yKGIueSAtIGEueSwgYi54IC0gYS54KSAqIDE4MCAvIE1hdGguUEk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUhleFRyaWcoaSwgbXgsIG15LCBsZW4sIGRlZyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHZlcnRzLmZvckVhY2godiA9PiBhZGRQb2xlKHYueCwgdi55KSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHdTZWdzID0gY29tcHV0ZVdhbGxTZWdtZW50cyh0VCwgdyk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaFNlZ3MgPSBjb21wdXRlV2FsbFNlZ21lbnRzKHRULCBoKTsKICAgICAgICAgICAgICAgICAgICB3U2Vncy5mb3JFYWNoKChzZWcsIGkpID0+IHsgY3JlYXRlVHJpZygndG9wJywgc2VnLnN0YXJ0LCAwLCBzZWcubGVuZ3RoLCBmYWxzZSwgaSk7IGNyZWF0ZVRyaWcoJ2JvdHRvbScsIHNlZy5zdGFydCwgaCwgc2VnLmxlbmd0aCwgZmFsc2UsIGkpOyB9KTsKICAgICAgICAgICAgICAgICAgICBoU2Vncy5mb3JFYWNoKChzZWcsIGkpID0+IHsgY3JlYXRlVHJpZygnbGVmdCcsIDAsIHNlZy5zdGFydCwgc2VnLmxlbmd0aCwgdHJ1ZSwgaSk7IGNyZWF0ZVRyaWcoJ3JpZ2h0Jywgdywgc2VnLnN0YXJ0LCBzZWcubGVuZ3RoLCB0cnVlLCBpKTsgfSk7CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvbGVHYXBXID0gdFQgPT09ICdQb2xlJyA/IDEwIDogd1NwOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvbGVHYXBIID0gdFQgPT09ICdQb2xlJyA/IDEwIDogaFNwOwogICAgICAgICAgICAgICAgICAgIGZvcihsZXQgeD0wOyB4PD13OyB4Kz1wb2xlR2FwVykgeyBhZGRQb2xlKHgsMCk7IGFkZFBvbGUoeCwgaCk7IH0KICAgICAgICAgICAgICAgICAgICBmb3IobGV0IHk9cG9sZUdhcEg7IHk8aDsgeSs9cG9sZUdhcEgpIHsgYWRkUG9sZSgwLHkpOyBhZGRQb2xlKHcsIHkpOyB9CiAgICAgICAgICAgICAgICAgICAgaWYodFQgPT09ICdQb2xlJykgeyBjb25zdCBwZWFrcyA9IGNvbXB1dGVQb2xlUGVha3MyRCh3LCBoKTsgcGVha3MuZm9yRWFjaChwID0+IGFkZFBvbGUocC54LCBwLnksICIjZjQzZjVlIikpOyB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFJlbmRlciBGaW5hbGl6ZWQgVGFwZSBQb2ludHMKICAgICAgICAgICAgaWYgKFNUQVRFLnRhcGVQb2ludHMuc3RhcnQgJiYgU1RBVEUudGFwZVBvaW50cy5lbmQpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHgxID0gU1RBVEUudGFwZVBvaW50cy5zdGFydC54OyBjb25zdCB5MSA9IFNUQVRFLnRhcGVQb2ludHMuc3RhcnQueTsKICAgICAgICAgICAgICAgIGNvbnN0IHgyID0gU1RBVEUudGFwZVBvaW50cy5lbmQueDsgY29uc3QgeTIgPSBTVEFURS50YXBlUG9pbnRzLmVuZC55OwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb25zdCBnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsICJnIik7CiAgICAgICAgICAgICAgICBjb25zdCBsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsICJsaW5lIik7CiAgICAgICAgICAgICAgICBsLnNldEF0dHJpYnV0ZSgieDEiLCB4MSk7IGwuc2V0QXR0cmlidXRlKCJ5MSIsIHkxKTsKICAgICAgICAgICAgICAgIGwuc2V0QXR0cmlidXRlKCJ4MiIsIHgyKTsgbC5zZXRBdHRyaWJ1dGUoInkyIiwgeTIpOwogICAgICAgICAgICAgICAgbC5zZXRBdHRyaWJ1dGUoInN0cm9rZSIsICIjZmFjYzE1Iik7IGwuc2V0QXR0cmlidXRlKCJzdHJva2Utd2lkdGgiLCAiNCIpOwogICAgICAgICAgICAgICAgZy5hcHBlbmRDaGlsZChsKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgWyB7eDp4MSwgeTp5MX0sIHt4OngyLCB5OnkyfSBdLmZvckVhY2gocCA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCAiY2lyY2xlIik7CiAgICAgICAgICAgICAgICAgICAgYy5zZXRBdHRyaWJ1dGUoImN4IiwgcC54KTsgYy5zZXRBdHRyaWJ1dGUoImN5IiwgcC55KTsgYy5zZXRBdHRyaWJ1dGUoInIiLCAiNiIpOyBjLnNldEF0dHJpYnV0ZSgiZmlsbCIsICIjZmFjYzE1Iik7CiAgICAgICAgICAgICAgICAgICAgZy5hcHBlbmRDaGlsZChjKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGNvbnN0IGR4ID0gKHgyIC0geDEpIC8gQ0VMTF9TSVpFOyBjb25zdCBkeSA9ICh5MiAtIHkxKSAvIENFTExfU0laRTsKICAgICAgICAgICAgICAgIGNvbnN0IGRpc3QgPSBNYXRoLnNxcnQoZHgqZHggKyBkeSpkeSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNvbnN0IGJnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsICJyZWN0Iik7CiAgICAgICAgICAgICAgICBiZy5zZXRBdHRyaWJ1dGUoIngiLCAoeDEreDIpLzIgLSA0MCk7IGJnLnNldEF0dHJpYnV0ZSgieSIsICh5MSt5MikvMiAtIDE1KTsKICAgICAgICAgICAgICAgIGJnLnNldEF0dHJpYnV0ZSgid2lkdGgiLCAiODAiKTsgYmcuc2V0QXR0cmlidXRlKCJoZWlnaHQiLCAiMzAiKTsgYmcuc2V0QXR0cmlidXRlKCJyeCIsICIxNSIpOwogICAgICAgICAgICAgICAgYmcuc2V0QXR0cmlidXRlKCJmaWxsIiwgIiNmYWNjMTUiKTsKICAgICAgICAgICAgICAgIGcuYXBwZW5kQ2hpbGQoYmcpOwoKICAgICAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsICJ0ZXh0Iik7CiAgICAgICAgICAgICAgICBsYWJlbC5zZXRBdHRyaWJ1dGUoIngiLCAoeDEreDIpLzIpOyBsYWJlbC5zZXRBdHRyaWJ1dGUoInkiLCAoeTEreTIpLzIgKyA1KTsKICAgICAgICAgICAgICAgIGxhYmVsLnNldEF0dHJpYnV0ZSgiZmlsbCIsICIjMDAwIik7IGxhYmVsLnNldEF0dHJpYnV0ZSgidGV4dC1hbmNob3IiLCAibWlkZGxlIik7CiAgICAgICAgICAgICAgICBsYWJlbC5zdHlsZS5mb250U2l6ZSA9ICIxNHB4IjsgbGFiZWwuc3R5bGUuZm9udFdlaWdodCA9ICI5MDAiOyBsYWJlbC5zdHlsZS5mb250U3R5bGUgPSAiaXRhbGljIjsKICAgICAgICAgICAgICAgIGxhYmVsLnRleHRDb250ZW50ID0gZGlzdC50b0ZpeGVkKDEpICsgIiciOwogICAgICAgICAgICAgICAgZy5hcHBlbmRDaGlsZChsYWJlbCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRhcGVPdmVybGF5LmFwcGVuZENoaWxkKGcpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBTVEFURS5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgICAgICAgICAgY29uc3QgZGVmID0gSVRFTV9ERUZTW2l0ZW0ubmFtZV07IGlmKCFkZWYpIHJldHVybjsKICAgICAgICAgICAgICAgIGNvbnN0IGlzU2VsZWN0ZWQgPSBTVEFURS5zZWxlY3RlZElkcy5pbmNsdWRlcyhpdGVtLmlkKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKGRlZi50eXBlID09PSAnZHJhcGUnICYmIGl0ZW0uZHJhcGVQb2ludHMpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBkcmFwZUhlaWdodHMgPSBpdGVtLmRyYXBlSGVpZ2h0cyB8fCBBcnJheShpdGVtLmRyYXBlUG9pbnRzLmxlbmd0aCAtIDEpLmZpbGwoaXRlbS5kcmFwZUhlaWdodCB8fCAnOGZ0Jyk7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsICJzdmciKTsKICAgICAgICAgICAgICAgICAgICBzdmcuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOyBzdmcuc3R5bGUubGVmdCA9IGl0ZW0ueCArICdweCc7IHN2Zy5zdHlsZS50b3AgPSBpdGVtLnkgKyAncHgnOwogICAgICAgICAgICAgICAgICAgIHN2Zy5zdHlsZS5vdmVyZmxvdyA9ICd2aXNpYmxlJzsgc3ZnLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgc3ZnLnN0eWxlLnpJbmRleCA9ICcxMDAnOyBzdmcuaWQgPSAnaXRlbS0nICsgaXRlbS5pZDsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpdGVtLmRyYXBlUG9pbnRzLmZvckVhY2goKHAsIGkpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2ID0gaXRlbS5kcmFwZVBvaW50c1tpIC0gMV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkaXN0RnQgPSBNYXRoLnNxcnQoKHAueCAtIHByZXYueCkqKjIgKyAocC55IC0gcHJldi55KSoqMikgLyBDRUxMX1NJWkU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWdIID0gZHJhcGVIZWlnaHRzW2kgLSAxXSB8fCAnOGZ0JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwgImxpbmUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUuc2V0QXR0cmlidXRlKCJ4MSIsIHByZXYueCk7IGxpbmUuc2V0QXR0cmlidXRlKCJ5MSIsIHByZXYueSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lLnNldEF0dHJpYnV0ZSgieDIiLCBwLngpOyBsaW5lLnNldEF0dHJpYnV0ZSgieTIiLCBwLnkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZS5zZXRBdHRyaWJ1dGUoInN0cm9rZSIsIGl0ZW0uY29sb3IpOyBsaW5lLnNldEF0dHJpYnV0ZSgic3Ryb2tlLXdpZHRoIiwgIjgiKTsgbGluZS5zZXRBdHRyaWJ1dGUoInN0cm9rZS1saW5lY2FwIiwgInJvdW5kIik7IGxpbmUuc2V0QXR0cmlidXRlKCJvcGFjaXR5IiwgaXNTZWxlY3RlZCA/ICIxIiA6ICIwLjc1Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdmcuYXBwZW5kQ2hpbGQobGluZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsICJnIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCAic2VnLWxhYmVsLWdyb3VwIik7IGcuc2V0QXR0cmlidXRlKCJ0cmFuc2Zvcm0iLCBgdHJhbnNsYXRlKCR7KHByZXYueCArIHAueCkgLyAyfSwgJHsocHJldi55ICsgcC55KSAvIDJ9KWApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCAicmVjdCIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjdC5zZXRBdHRyaWJ1dGUoIngiLCAiLTQwIik7IHJlY3Quc2V0QXR0cmlidXRlKCJ5IiwgIi0xNiIpOyByZWN0LnNldEF0dHJpYnV0ZSgid2lkdGgiLCAiODAiKTsgcmVjdC5zZXRBdHRyaWJ1dGUoImhlaWdodCIsICIzMiIpOyByZWN0LnNldEF0dHJpYnV0ZSgicngiLCAiMTYiKTsgcmVjdC5zZXRBdHRyaWJ1dGUoImZpbGwiLCBpc1NlbGVjdGVkID8gIiMwZjE3MmEiIDogIiMzMzQxNTUiKTsgcmVjdC5zZXRBdHRyaWJ1dGUoInN0cm9rZSIsIGlzU2VsZWN0ZWQgPyAiIzM4YmRmOCIgOiAidHJhbnNwYXJlbnQiKTsgcmVjdC5zZXRBdHRyaWJ1dGUoInN0cm9rZS13aWR0aCIsICIyIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsICJ0ZXh0Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0LnNldEF0dHJpYnV0ZSgidGV4dC1hbmNob3IiLCAibWlkZGxlIik7IHRleHQuc2V0QXR0cmlidXRlKCJkeSIsICI3Iik7IHRleHQuc2V0QXR0cmlidXRlKCJmaWxsIiwgIndoaXRlIik7IHRleHQuc3R5bGUuZm9udFNpemUgPSAiMTFweCI7IHRleHQuc3R5bGUuZm9udFdlaWdodCA9ICI5MDAiOyB0ZXh0LnN0eWxlLmZvbnRTdHlsZSA9ICJpdGFsaWMiOyB0ZXh0LnN0eWxlLnBvaW50ZXJFdmVudHMgPSAibm9uZSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0LnRleHRDb250ZW50ID0gZGlzdEZ0LnRvRml4ZWQoMSkgKyAiJyB8ICIgKyBzZWdIOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZy5hcHBlbmRDaGlsZChyZWN0KTsgZy5hcHBlbmRDaGlsZCh0ZXh0KTsgc3ZnLmFwcGVuZENoaWxkKGcpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmFwcGVuZENoaWxkKHN2Zyk7CiAgICAgICAgICAgICAgICAgICAgaXRlbS5kcmFwZVBvaW50cy5mb3JFYWNoKChwLCBpKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IHB0LmNsYXNzTmFtZSA9ICdkcmFwZS1wb2ludC0yZCc7IHB0LnN0eWxlLmxlZnQgPSAoaXRlbS54ICsgcC54IC0gNikgKyAncHgnOyBwdC5zdHlsZS50b3AgPSAoaXRlbS55ICsgcC55IC0gNikgKyAncHgnOyBjYW52YXMuYXBwZW5kQ2hpbGQocHQpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHN2Zy5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2F1dG8nOwogICAgICAgICAgICAgICAgICAgIHN2Zy5vbmNsaWNrID0gKGUpID0+IHsgZS5zdG9wUHJvcGFnYXRpb24oKTsgaWYgKCFpc1NlbGVjdGVkICYmICFTVEFURS5pc1RhcGVBY3RpdmUpIHsgU1RBVEUuc2VsZWN0ZWRJZHMgPSBbaXRlbS5pZF07IH0gcmVuZGVyMkQoKTsgfTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1ByaW1hcnkgPSBpc1NlbGVjdGVkICYmIFNUQVRFLnNlbGVjdGVkSWRzW1NUQVRFLnNlbGVjdGVkSWRzLmxlbmd0aCAtIDFdID09PSBpdGVtLmlkOwogICAgICAgICAgICAgICAgICAgIGlmIChpc1ByaW1hcnkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9vbGJhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyB0b29sYmFyLmNsYXNzTmFtZSA9ICdpdGVtLXRvb2xiYXInOyB0b29sYmFyLnN0eWxlLnpJbmRleCA9ICczMDAxJzsgdG9vbGJhci5vbmNsaWNrID0gKGUpID0+IGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbG9yR3JvdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgY29sb3JHcm91cC5jbGFzc05hbWUgPSAnZmxleCBnYXAtMiBweC0yJzsKICAgICAgICAgICAgICAgICAgICAgICAgWycjZmZmZmZmJywgJyMxMTExMTEnXS5mb3JFYWNoKGMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBkb3QuY2xhc3NOYW1lID0gJ2NvbG9yLWRvdCcgKyAoaXRlbS5jb2xvciA9PT0gYyA/ICcgYWN0aXZlJyA6ICcnKTsgZG90LnN0eWxlLmJhY2tncm91bmQgPSBjOyBkb3Quc3R5bGUud2lkdGggPSAnNDRweCc7IGRvdC5zdHlsZS5oZWlnaHQgPSAnNDRweCc7IGRvdC5vbmNsaWNrID0gKGUpID0+IHsgZS5zdG9wUHJvcGFnYXRpb24oKTsgdXBkYXRlU2VsZWN0aW9uUHJvcGVydHkoeyBjb2xvcjogYyB9KTsgfTsgY29sb3JHcm91cC5hcHBlbmRDaGlsZChkb3QpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhci5hcHBlbmRDaGlsZChjb2xvckdyb3VwKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IHNlcC5jbGFzc05hbWUgPSAndy1weCBoLTEwIGJnLWdyYXktMjAwIG14LTInOyB0b29sYmFyLmFwcGVuZENoaWxkKHNlcCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOyBkZWwuaW5uZXJIVE1MID0gJ/Cfl5HvuI8nOyBkZWwuY2xhc3NOYW1lID0gJ3B4LTMgdGV4dC1yZWQtNTAwIGhvdmVyOmJnLXJlZC01MCByb3VuZGVkIHRleHQtNHhsJzsgZGVsLm9uY2xpY2sgPSAoZSkgPT4geyBlLnN0b3BQcm9wYWdhdGlvbigpOyBkZWxldGVTZWxlY3Rpb24oKTsgfTsKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhci5hcHBlbmRDaGlsZChkZWwpOyB0b29sYmFyLnN0eWxlLmJvdHRvbSA9ICdhdXRvJzsgdG9vbGJhci5zdHlsZS50b3AgPSAoaXRlbS55ICsgaXRlbS5kcmFwZVBvaW50c1swXS55IC0gODApICsgJ3B4JzsgdG9vbGJhci5zdHlsZS5sZWZ0ID0gKGl0ZW0ueCArIGl0ZW0uZHJhcGVQb2ludHNbMF0ueCkgKyAncHgnOyBjYW52YXMuYXBwZW5kQ2hpbGQodG9vbGJhcik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGludGVyYWN0KHN2ZykuZHJhZ2dhYmxlKHsKICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydCgpIHsgcHVzaEhpc3RvcnkoKTsgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vdmUoZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByYWQgPSAtKFNUQVRFLnJvdGF0aW9uICogTWF0aC5QSSkgLyAxODA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZHggPSAoZXZlbnQuZHggKiBNYXRoLmNvcyhyYWQpIC0gZXZlbnQuZHkgKiBNYXRoLnNpbihyYWQpKSAvIFNUQVRFLnNjYWxlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGR5ID0gKGV2ZW50LmR4ICogTWF0aC5zaW4ocmFkKSArIGV2ZW50LmR5ICogTWF0aC5jb3MocmFkKSkgLyBTVEFURS5zY2FsZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnggKz0gZHg7IGl0ZW0ueSArPSBkeTsgcmVuZGVyMkQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQoKSB7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ueCA9IE1hdGgucm91bmQoaXRlbS54IC8gQ0VMTF9TSVpFKSAqIENFTExfU0laRTsgaXRlbS55ID0gTWF0aC5yb3VuZChpdGVtLnkgLyBDRUxMX1NJWkUpICogQ0VMTF9TSVpFOyByZW5kZXIyRCgpOyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBlbC5pZCA9ICdpdGVtLScgKyBpdGVtLmlkOwogICAgICAgICAgICAgICAgY29uc3QgaXNSb3VuZCA9IGRlZi50eXBlID09PSAncm91bmQnOwogICAgICAgICAgICAgICAgZWwuY2xhc3NOYW1lID0gJ2l0ZW0nICsgKGlzUm91bmQgPyAnIHJvdW5kJyA6ICcnKSArIChpc1NlbGVjdGVkID8gJyBzZWxlY3RlZCcgOiAnJyk7CiAgICAgICAgICAgICAgICBjb25zdCBpdyA9IChpdGVtLndpZHRoIHx8IGRlZi53aWR0aCB8fCBkZWYuZGlhbWV0ZXIgfHwgMSkgKiBDRUxMX1NJWkU7CiAgICAgICAgICAgICAgICBjb25zdCBpaCA9IChpdGVtLmhlaWdodCB8fCBkZWYuaGVpZ2h0IHx8IGRlZi5kaWFtZXRlciB8fCAxKSAqIENFTExfU0laRTsKICAgICAgICAgICAgICAgIGVsLnN0eWxlLndpZHRoID0gaXcgKyAncHgnOyBlbC5zdHlsZS5oZWlnaHQgPSBpaCArICdweCc7IGVsLnN0eWxlLmxlZnQgPSBpdGVtLnggKyAncHgnOyBlbC5zdHlsZS50b3AgPSBpdGVtLnkgKyAncHgnOwogICAgICAgICAgICAgICAgY29uc3QgaXNTdGcgPSBpdGVtLm5hbWUuaW5jbHVkZXMoJ3N0YWdlJyk7CiAgICAgICAgICAgICAgICBjb25zdCBpc0RuYyA9IGl0ZW0ubmFtZS5pbmNsdWRlcygnZGFuY2UnKTsKICAgICAgICAgICAgICAgIGVsLnN0eWxlLnpJbmRleCA9IGlzRG5jID8gJzEwJyA6IChpc1N0ZyA/ICcyMCcgOiAnMTAwJyk7CgogICAgICAgICAgICAgICAgY29uc3QgaXNDaGFpclNpbmdsZSA9IGl0ZW0ubmFtZSA9PT0gJ2NoYWlyLXNpbmdsZSc7CiAgICAgICAgICAgICAgICBjb25zdCBpc0NoYWlyUm93ID0gaXRlbS5uYW1lID09PSAnY2hhaXItcm93JzsKICAgICAgICAgICAgICAgIGNvbnN0IGlzQ2hhaXJDaXJjbGUgPSBpdGVtLm5hbWUgPT09ICdjaGFpci1jaXJjbGUnOwogICAgICAgICAgICAgICAgY29uc3QgaXNDaGFpck1vZHVsZSA9IGlzQ2hhaXJTaW5nbGUgfHwgaXNDaGFpclJvdyB8fCBpc0NoYWlyQ2lyY2xlOwoKICAgICAgICAgICAgICAgIGNvbnN0IGdldExpbmVuQ29sb3IgPSAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0ubGluZW4gPT09ICd3aGl0ZScpIHJldHVybiAnI2ZmZic7IGlmIChpdGVtLmxpbmVuID09PSAnYmxhY2snKSByZXR1cm4gJyMxMTEnOwogICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLmxpbmVuICYmIGl0ZW0ubGluZW4gIT09ICdub25lJykgcmV0dXJuIGl0ZW0ubGluZW47IHJldHVybiBpdGVtLm5hbWUuaW5jbHVkZXMoJ3RhYmxlJykgPyAnI2I1ODM1YScgOiBkZWYuY29sb3I7CiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIGlmICghaXNDaGFpck1vZHVsZSkgewogICAgICAgICAgICAgICAgICAgIGVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGdldExpbmVuQ29sb3IoKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGZsYXJlZCBiYXNlIHRvIGNvY2t0YWlsIHRhYmxlcyBpbiAyRAogICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLm5hbWUuaW5jbHVkZXMoJ2NvY2t0YWlsJykgJiYgaXRlbS5saW5lbiAmJiBpdGVtLmxpbmVuICE9PSAnbm9uZScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmxhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZmxhcmUuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOwogICAgICAgICAgICAgICAgICAgICAgICBmbGFyZS5zdHlsZS5pbnNldCA9ICctMTUlJzsKICAgICAgICAgICAgICAgICAgICAgICAgZmxhcmUuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzUwJSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGZsYXJlLnN0eWxlLm9wYWNpdHkgPSAnMC4zJzsKICAgICAgICAgICAgICAgICAgICAgICAgZmxhcmUuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgZmxhcmUuc3R5bGUuekluZGV4ID0gJy0xJzsKICAgICAgICAgICAgICAgICAgICAgICAgZmxhcmUuc3R5bGUuYmFja2dyb3VuZCA9IGByYWRpYWwtZ3JhZGllbnQoY2lyY2xlLCAke2dldExpbmVuQ29sb3IoKX0gNDAlLCB0cmFuc3BhcmVudCA4NSUpYDsKICAgICAgICAgICAgICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQoZmxhcmUpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgZWwuaW5uZXJIVE1MICs9IGA8ZGl2IGNsYXNzPSJjb3VudGVyLXJvdGF0ZSIgc3R5bGU9InRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpIHJvdGF0ZSgkeyAtaXRlbS5hbmdsZSAtIFNUQVRFLnJvdGF0aW9uIH1kZWcpOyAkeyBpdGVtLmxpbmVuID09PSAnYmxhY2snIHx8IGl0ZW0ubmFtZS5pbmNsdWRlcygnc3RhZ2UnKSA/ICdjb2xvcjp3aGl0ZTsnIDogJyd9Ij4keyhpdGVtLmN1c3RvbUxhYmVsIHx8IGRlZi5kaXNwbGF5TmFtZSkudG9VcHBlckNhc2UoKX08L2Rpdj5gOwoKICAgICAgICAgICAgICAgICAgICAvLyBTdGFnZSBndWFyZHJhaWxzICgyRCk6IG9wdGlvbmFsIDRmdCBzZWdtZW50cyBhcm91bmQgdGhlIHN0YWdlIHBlcmltZXRlcgogICAgICAgICAgICAgICAgICAgIGlmIChpc1N0ZykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBTRUdfRlQgPSA0OwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWdQeCA9IFNFR19GVCAqIENFTExfU0laRTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgd0Z0ID0gKGl0ZW0ud2lkdGggfHwgZGVmLndpZHRoIHx8IGRlZi5kaWFtZXRlciB8fCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaEZ0ID0gKGl0ZW0uaGVpZ2h0IHx8IGRlZi5oZWlnaHQgfHwgZGVmLmRpYW1ldGVyIHx8IDEpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWdDb3VudFggPSBNYXRoLm1heCgxLCBNYXRoLnJvdW5kKHdGdCAvIFNFR19GVCkpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWdDb3VudFkgPSBNYXRoLm1heCgxLCBNYXRoLnJvdW5kKGhGdCAvIFNFR19GVCkpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByYWlscyA9IEFycmF5LmlzQXJyYXkoaXRlbS5zdGFnZUd1YXJkcmFpbHMpID8gaXRlbS5zdGFnZUd1YXJkcmFpbHMgOiBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGFzUmFpbCA9IChzaWRlLCBpZHgpID0+IHJhaWxzLnNvbWUociA9PiByLnNpZGUgPT09IHNpZGUgJiYgci5pbmRleCA9PT0gaWR4KTsKCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbmRlciBhY3RpdmUgcmFpbHMgKGFsd2F5cyB2aXNpYmxlKQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0aGlja25lc3MgPSA2OwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlZ0NvdW50WDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzUmFpbCgndG9wJywgaSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgci5jbGFzc05hbWUgPSAnc3RhZ2UtcmFpbCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgci5zdHlsZS5sZWZ0ID0gKGkgKiBzZWdQeCkgKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIuc3R5bGUudG9wID0gKC10aGlja25lc3MpICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnN0eWxlLndpZHRoID0gc2VnUHggKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIuc3R5bGUuaGVpZ2h0ID0gdGhpY2tuZXNzICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbC5hcHBlbmRDaGlsZChyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNSYWlsKCdib3R0b20nLCBpKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLmNsYXNzTmFtZSA9ICdzdGFnZS1yYWlsJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnN0eWxlLmxlZnQgPSAoaSAqIHNlZ1B4KSArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgci5zdHlsZS50b3AgPSAoaWgpICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnN0eWxlLndpZHRoID0gc2VnUHggKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIuc3R5bGUuaGVpZ2h0ID0gdGhpY2tuZXNzICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbC5hcHBlbmRDaGlsZChyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlZ0NvdW50WTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzUmFpbCgnbGVmdCcsIGkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIuY2xhc3NOYW1lID0gJ3N0YWdlLXJhaWwnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIuc3R5bGUubGVmdCA9ICgtdGhpY2tuZXNzKSArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgci5zdHlsZS50b3AgPSAoaSAqIHNlZ1B4KSArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgci5zdHlsZS53aWR0aCA9IHRoaWNrbmVzcyArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgci5zdHlsZS5oZWlnaHQgPSBzZWdQeCArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQocik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzUmFpbCgncmlnaHQnLCBpKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLmNsYXNzTmFtZSA9ICdzdGFnZS1yYWlsJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnN0eWxlLmxlZnQgPSAoaXcpICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnN0eWxlLnRvcCA9IChpICogc2VnUHgpICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnN0eWxlLndpZHRoID0gdGhpY2tuZXNzICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnN0eWxlLmhlaWdodCA9IHNlZ1B4ICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbC5hcHBlbmRDaGlsZChyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gRWRpdCB0cmlnZ2VycyAob25seSBmb3IgdGhlIHByaW1hcnkgc2VsZWN0aW9uIHRvIGF2b2lkIGNsdXR0ZXIpCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzUHJpbWFyeSA9IGlzU2VsZWN0ZWQgJiYgU1RBVEUuc2VsZWN0ZWRJZHNbU1RBVEUuc2VsZWN0ZWRJZHMubGVuZ3RoIC0gMV0gPT09IGl0ZW0uaWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1ByaW1hcnkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRyaWdUaGlja25lc3MgPSAxODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFkZFRyaWdnZXIgPSAoc2lkZSwgaWR4LCB4LCB5LCB3LCBoLCBhY3RpdmUsIHRyYW5zZm9ybSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmNsYXNzTmFtZSA9ICdzdGFnZS1yYWlsLXRyaWdnZXInICsgKGFjdGl2ZSA/ICcgYWN0aXZlJyA6ICcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnN0eWxlLmxlZnQgPSB4ICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnN0eWxlLnRvcCA9IHkgKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuc3R5bGUud2lkdGggPSB3ICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnN0eWxlLmhlaWdodCA9IGggKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuc3R5bGUudHJhbnNmb3JtID0gdHJhbnNmb3JtOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudGl0bGUgPSBhY3RpdmUgPyAnUmVtb3ZlIGd1YXJkcmFpbCcgOiAnQWRkIGd1YXJkcmFpbCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC50ZXh0Q29udGVudCA9IGFjdGl2ZSA/ICdSQUlMJyA6ICcnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXYpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1c2hIaXN0b3J5KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc3RhZ2VHdWFyZHJhaWxzID0gQXJyYXkuaXNBcnJheShpdGVtLnN0YWdlR3VhcmRyYWlscykgPyBpdGVtLnN0YWdlR3VhcmRyYWlscyA6IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhcnIgPSBpdGVtLnN0YWdlR3VhcmRyYWlsczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaiA9IGFyci5maW5kSW5kZXgociA9PiByLnNpZGUgPT09IHNpZGUgJiYgci5pbmRleCA9PT0gaWR4KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGogPiAtMSkgYXJyLnNwbGljZShqLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBhcnIucHVzaCh7IHNpZGUsIGluZGV4OiBpZHggfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcjJEKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQodCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VnQ291bnRYOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRUcmlnZ2VyKCd0b3AnLCBpLCBpICogc2VnUHgsIDAsIHNlZ1B4LCB0cmlnVGhpY2tuZXNzLCBoYXNSYWlsKCd0b3AnLCBpKSwgJ3RyYW5zbGF0ZVkoLTUwJSknKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRUcmlnZ2VyKCdib3R0b20nLCBpLCBpICogc2VnUHgsIGloLCBzZWdQeCwgdHJpZ1RoaWNrbmVzcywgaGFzUmFpbCgnYm90dG9tJywgaSksICd0cmFuc2xhdGVZKC01MCUpJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlZ0NvdW50WTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVHJpZ2dlcignbGVmdCcsIGksIDAsIGkgKiBzZWdQeCwgdHJpZ1RoaWNrbmVzcywgc2VnUHgsIGhhc1JhaWwoJ2xlZnQnLCBpKSwgJ3RyYW5zbGF0ZVgoLTUwJSknKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRUcmlnZ2VyKCdyaWdodCcsIGksIGl3LCBpICogc2VnUHgsIHRyaWdUaGlja25lc3MsIHNlZ1B4LCBoYXNSYWlsKCdyaWdodCcsIGkpLCAndHJhbnNsYXRlWCgtNTAlKScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdjaGFpci1tb2R1bGUnKTsKICAgICAgICAgICAgICAgICAgICBlbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndHJhbnNwYXJlbnQnOwogICAgICAgICAgICAgICAgICAgIGVsLnN0eWxlLmJvcmRlclN0eWxlID0gJ2Rhc2hlZCc7CiAgICAgICAgICAgICAgICAgICAgZWwuc3R5bGUuYm9yZGVyQ29sb3IgPSBpc1NlbGVjdGVkID8gJyMzOGJkZjgnIDogJ3JnYmEoMTAwLDExNiwxMzksMC41NSknOwoKICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHlsZU92ZXJyaWRlID0gaXRlbS5jaGFpclN0eWxlOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1c2hpb25PdmVycmlkZSA9IGl0ZW0uY2hpYXZhcmlDdXNoaW9uOwoKICAgICAgICAgICAgICAgICAgICBpZiAoaXNDaGFpclNpbmdsZSkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGMuY2xhc3NOYW1lID0gJ2NoYWlyLTJkJzsKICAgICAgICAgICAgICAgICAgICAgICAgYy5zdHlsZS5sZWZ0ID0gKGl3IC8gMiAtIDgpICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgYy5zdHlsZS50b3AgPSAoaWggLyAyIC0gOC41KSArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGMuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgYXBwbHlDaGFpcjJEU3R5bGUoYywgc3R5bGVPdmVycmlkZSwgY3VzaGlvbk92ZXJyaWRlKTsKICAgICAgICAgICAgICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQoYyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc0NoYWlyQ2lyY2xlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENpcmNsZSBzZWF0aW5nOiBjaGFpcnMgYXJlIHByZWNvbXB1dGVkIChmZWV0KSB1c2luZyB0aGUgc2hhcmVkIGhlbHBlciBpbiB0aGUgaG9zdCBhcHAuCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYWlycyA9IEFycmF5LmlzQXJyYXkoaXRlbS5jaGFpckNpcmNsZUNoYWlycykgPyBpdGVtLmNoYWlyQ2lyY2xlQ2hhaXJzIDogW107CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbnRlclggPSBpdyAvIDI7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbnRlclkgPSBpaCAvIDI7CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBPcHRpb25hbCBndWlkZSBmb3IgdGhlIGZpeGVkIGlubmVyIHNxdWFyZSB2b2lkICh2aXN1YWwgb25seSkuCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlubmVyU3F1YXJlRnQgPSAodHlwZW9mIGl0ZW0uY2hhaXJDaXJjbGVJbm5lclNxdWFyZUZ0ID09PSAnbnVtYmVyJykgPyBpdGVtLmNoYWlyQ2lyY2xlSW5uZXJTcXVhcmVGdCA6IDE1OwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbm5lclNpemVQeCA9IGlubmVyU3F1YXJlRnQgKiBDRUxMX1NJWkU7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGd1aWRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGd1aWRlLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsKICAgICAgICAgICAgICAgICAgICAgICAgZ3VpZGUuc3R5bGUubGVmdCA9ICc1MCUnOwogICAgICAgICAgICAgICAgICAgICAgICBndWlkZS5zdHlsZS50b3AgPSAnNTAlJzsKICAgICAgICAgICAgICAgICAgICAgICAgZ3VpZGUuc3R5bGUud2lkdGggPSBpbm5lclNpemVQeCArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGd1aWRlLnN0eWxlLmhlaWdodCA9IGlubmVyU2l6ZVB4ICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgZ3VpZGUuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgtNTAlLCAtNTAlKSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGd1aWRlLnN0eWxlLmJvcmRlciA9ICcxcHggZGFzaGVkIHJnYmEoMTAwLDExNiwxMzksMC41NSknOwogICAgICAgICAgICAgICAgICAgICAgICBndWlkZS5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnMnB4JzsKICAgICAgICAgICAgICAgICAgICAgICAgZ3VpZGUuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgZ3VpZGUuc3R5bGUuYm94U2l6aW5nID0gJ2JvcmRlci1ib3gnOwogICAgICAgICAgICAgICAgICAgICAgICBlbC5hcHBlbmRDaGlsZChndWlkZSk7CgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoUG9zIG9mIGNoYWlycykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeCA9IGNlbnRlclggKyAoY2hQb3MueEZ0ICogQ0VMTF9TSVpFKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHkgPSBjZW50ZXJZICsgKGNoUG9zLnpGdCAqIENFTExfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByb3REZWcgPSAoY2hQb3Mucm90UmFkICogMTgwKSAvIE1hdGguUEk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoLmNsYXNzTmFtZSA9ICdjaGFpci0yZCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwbHlDaGFpcjJEU3R5bGUoY2gsIHN0eWxlT3ZlcnJpZGUsIGN1c2hpb25PdmVycmlkZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaC5zdHlsZS5sZWZ0ID0gKHggLSA4KSArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaC5zdHlsZS50b3AgPSAoeSAtIDguNSkgKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2guc3R5bGUudHJhbnNmb3JtID0gJ3JvdGF0ZSgnICsgcm90RGVnICsgJ2RlZyknOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2guc3R5bGUudHJhbnNmb3JtT3JpZ2luID0gJ2NlbnRlciBjZW50ZXInOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQoY2gpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hhaXIgcm93CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBNYXRoLm1heCgxLCBpdGVtLnNlYXRzIHx8IGRlZi5zZWF0cyB8fCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3BhY2luZ0Z0ID0gKHR5cGVvZiBpdGVtLmNoYWlyU3BhY2luZyA9PT0gJ251bWJlcicpID8gaXRlbS5jaGFpclNwYWNpbmcgOiAyLjA7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwYWNpbmdQeCA9IHNwYWNpbmdGdCAqIENFTExfU0laRTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3BhblB4ID0gKG4gLSAxKSAqIHNwYWNpbmdQeDsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VydmVBbXQgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCBpdGVtLmNoYWlyQ3VydmUgfHwgMCkpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkaXIgPSBpdGVtLmNoYWlyRmxpcCA/IC0xIDogMTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF4Qm93UHggPSBNYXRoLm1pbihpaCAqIDAuMzUsIHNwYW5QeCAqIDAuMTgpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBib3dQeCA9IGN1cnZlQW10ICogbWF4Qm93UHggKiBkaXI7CgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeCA9IChzcGFuUHggPiAwKSA/ICgtc3BhblB4IC8gMiArIGkgKiBzcGFjaW5nUHgpIDogMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHhOb3JtID0gKHNwYW5QeCA+IDApID8gKHggLyAoc3BhblB4IC8gMikpIDogMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHlPZmYgPSBib3dQeCAqICgxIC0geE5vcm0gKiB4Tm9ybSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoLmNsYXNzTmFtZSA9ICdjaGFpci0yZCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwbHlDaGFpcjJEU3R5bGUoY2gsIHN0eWxlT3ZlcnJpZGUsIGN1c2hpb25PdmVycmlkZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaC5zdHlsZS5sZWZ0ID0gKGl3IC8gMiArIHggLSA4KSArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaC5zdHlsZS50b3AgPSAoaWggLyAyICsgeU9mZiAtIDguNSkgKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQoY2gpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9IGByb3RhdGUoJHtpdGVtLmFuZ2xlIHx8IDB9ZGVnKWA7CiAgICAgICAgICAgICAgICBlbC5vbmNsaWNrID0gKGUpID0+IHsgZS5zdG9wUHJvcGFnYXRpb24oKTsgaWYgKCFpc1NlbGVjdGVkICYmICFTVEFURS5pc1RhcGVBY3RpdmUpIHsgU1RBVEUuc2VsZWN0ZWRJZHMgPSBbaXRlbS5pZF07IH0gcmVuZGVyMkQoKTsgc2hvd1RpcCgnaXRlbScpOyB9OwogICAgICAgICAgICAgICAgY2FudmFzLmFwcGVuZENoaWxkKGVsKTsKCiAgICAgICAgICAgICAgICBjb25zdCBpc1ByaW1hcnkgPSBTVEFURS5zZWxlY3RlZElkcy5sZW5ndGggPiAwICYmIFNUQVRFLnNlbGVjdGVkSWRzW1NUQVRFLnNlbGVjdGVkSWRzLmxlbmd0aCAtIDFdID09PSBpdGVtLmlkOwogICAgICAgICAgICAgICAgaWYgKGlzUHJpbWFyeSkgewogICAgICAgICAgICAgICAgICAgY29uc3QgdG9vbGJhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyB0b29sYmFyLmNsYXNzTmFtZSA9ICdpdGVtLXRvb2xiYXInOyB0b29sYmFyLnN0eWxlLnpJbmRleCA9ICczMDAxJzsgdG9vbGJhci5vbmNsaWNrID0gKGUpID0+IGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICBjb25zdCBkdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsgZHVwLmlubmVySFRNTCA9ICfwn5OLJzsgZHVwLmNsYXNzTmFtZSA9ICdweC0zIGhvdmVyOmJnLXNsYXRlLTEwMCByb3VuZGVkIHRleHQtNHhsJzsgZHVwLm9uY2xpY2sgPSAoKSA9PiBkdXBsaWNhdGVTZWxlY3Rpb24oKTsgdG9vbGJhci5hcHBlbmRDaGlsZChkdXApOwogICAgICAgICAgICAgICAgICAgY29uc3QgdGFibGVDeWNsZSA9IFsiYmFucXVldC10YWJsZS04ZnQiLCAiYmFucXVldC10YWJsZS02ZnQiLCAicm91bmQtdGFibGUtNWZ0IiwgImNvY2t0YWlsLXRhYmxlIl07CiAgICAgICAgICAgICAgICAgICBpZiAodGFibGVDeWNsZS5pbmNsdWRlcyhpdGVtLm5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3ljID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7IGN5Yy5pbm5lckhUTUwgPSAn8J+UhCc7IGN5Yy5jbGFzc05hbWUgPSAncHgtMyBob3ZlcjpiZy1zbGF0ZS0xMDAgcm91bmRlZCB0ZXh0LTR4bCBmb250LWJvbGQgdGV4dC1ibHVlLTYwMCc7IGN5Yy5vbmNsaWNrID0gKCkgPT4geyBsZXQgaWR4ID0gdGFibGVDeWNsZS5pbmRleE9mKGl0ZW0ubmFtZSk7IGxldCBuS2V5ID0gdGFibGVDeWNsZVsoaWR4ICsgMSkgJSB0YWJsZUN5Y2xlLmxlbmd0aF07IGxldCBuRGVmID0gSVRFTV9ERUZTW25LZXldOyB1cGRhdGVTZWxlY3Rpb25Qcm9wZXJ0eSh7IG5hbWU6IG5LZXksIHNlYXRzOiBuRGVmLnNlYXRzIH0pOyB9OyB0b29sYmFyLmFwcGVuZENoaWxkKGN5Yyk7CiAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICBpZihpdGVtLm5hbWUuaW5jbHVkZXMoJ3RhYmxlJykgfHwgaXRlbS5uYW1lLmluY2x1ZGVzKCdjb2NrdGFpbCcpIHx8IGl0ZW0ubmFtZS5pbmNsdWRlcygnYmFyJykgfHwgaXRlbS5uYW1lLmluY2x1ZGVzKCdzdGF0aW9uJykgfHwgaXRlbS5uYW1lLmluY2x1ZGVzKCdjdXN0b20tJykpIHsKICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlcDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgc2VwMi5jbGFzc05hbWUgPSAndy1weCBoLTEwIGJnLWdyYXktMjAwIG14LTInOyB0b29sYmFyLmFwcGVuZENoaWxkKHNlcDIpOwogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZW5CdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsgbGluZW5CdG4uaW5uZXJIVE1MID0gJ/CfjqgnOyBsaW5lbkJ0bi5jbGFzc05hbWUgPSAncHgtMyBob3ZlcjpiZy1zbGF0ZS0xMDAgcm91bmRlZCB0ZXh0LTR4bCc7CiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lbk1lbnUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgbGluZW5NZW51LmNsYXNzTmFtZSA9ICdsaW5lbi1tZW51JzsKICAgICAgICAgICAgICAgICAgICAgIFsnbm9uZScsICd3aGl0ZScsICdibGFjaycsICcjMWQ0ZWQ4JywgJyNmYmJmMjQnXS5mb3JFYWNoKGMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBkb3QuY2xhc3NOYW1lID0gJ2NvbG9yLWRvdCcgKyAoaXRlbS5saW5lbiA9PT0gYyA/ICcgYWN0aXZlJyA6ICcnKTsgZG90LnN0eWxlLmJhY2tncm91bmQgPSBjID09PSAnbm9uZScgPyAnI2I1ODM1YScgOiBjOyBkb3Qub25jbGljayA9IChlKSA9PiB7IGUuc3RvcFByb3BhZ2F0aW9uKCk7IHVwZGF0ZVNlbGVjdGlvblByb3BlcnR5KHsgbGluZW46IGMgfSk7IHNob3dUaXAoJ2xpbmVuJyk7IH07IGxpbmVuTWVudS5hcHBlbmRDaGlsZChkb3QpOwogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICBsaW5lbkJ0bi5vbmNsaWNrID0gKGUpID0+IHsgZS5zdG9wUHJvcGFnYXRpb24oKTsgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmxpbmVuLW1lbnUnKS5mb3JFYWNoKG0gPT4gbS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7IGxpbmVuTWVudS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgc2hvd1RpcCgnbGluZW4nKTsgfTsgdG9vbGJhci5hcHBlbmRDaGlsZChsaW5lbkJ0bik7IHRvb2xiYXIuYXBwZW5kQ2hpbGQobGluZW5NZW51KTsKICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0ubmFtZS5pbmNsdWRlcygnc3RhZ2UnKSkgewogICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VwMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBzZXAzLmNsYXNzTmFtZSA9ICd3LXB4IGgtMTAgYmctZ3JheS0yMDAgbXgtMic7IHRvb2xiYXIuYXBwZW5kQ2hpbGQoc2VwMyk7CiAgICAgICAgICAgICAgICAgICAgICBbJzgiJywgJzE2IicsICcyNCInLCAnMzIiJ10uZm9yRWFjaChodCA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7IGhidG4uaW5uZXJUZXh0ID0gaHQ7IGhidG4uY2xhc3NOYW1lID0gInRleHQtWzE0cHhdIGZvbnQtYmxhY2sgbXgtMSAiICsgKGl0ZW0uc3RhZ2VIZWlnaHQ9PT1odD8ndGV4dC1ibHVlLTUwMCc6J3RleHQtZ3JheS00MDAnKTsgaGJ0bi5vbmNsaWNrID0gKCkgPT4gdXBkYXRlU2VsZWN0aW9uUHJvcGVydHkoeyBzdGFnZUhlaWdodDogaHQgfSk7IHRvb2xiYXIuYXBwZW5kQ2hpbGQoaGJ0bik7CiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlcDQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgc2VwNC5jbGFzc05hbWUgPSAndy1weCBoLTEwIGJnLWdyYXktMjAwIG14LTInOyB0b29sYmFyLmFwcGVuZENoaWxkKHNlcDQpOwogICAgICAgICAgICAgICAgICAgY29uc3QgZGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7IGRlbC5pbm5lckhUTUwgPSAn8J+Xke+4jyc7IGRlbC5jbGFzc05hbWUgPSAncHgtMyB0ZXh0LXJlZC01MDAgaG92ZXI6YmctcmVkLTUwIHJvdW5kZWQgdGV4dC00eGwnOyBkZWwub25jbGljayA9ICgpID0+IGRlbGV0ZVNlbGVjdGlvbigpOwogICAgICAgICAgICAgICAgICAgdG9vbGJhci5hcHBlbmRDaGlsZChkZWwpOyBlbC5hcHBlbmRDaGlsZCh0b29sYmFyKTsKICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyByb3QuY2xhc3NOYW1lID0gJ3JvdGF0ZS1oYW5kbGUnOyByb3QuaW5uZXJIVE1MID0gJ/CflIQnOyByb3Qub25jbGljayA9IChlKSA9PiB7IGUuc3RvcFByb3BhZ2F0aW9uKCk7IHB1c2hIaXN0b3J5KCk7IFNUQVRFLml0ZW1zID0gU1RBVEUuaXRlbXMubWFwKGkgPT4geyBpZiAoU1RBVEUuc2VsZWN0ZWRJZHMuaW5jbHVkZXMoaS5pZCkpIHJldHVybiB7IC4uLmksIGFuZ2xlOiAoaS5hbmdsZSArIDIyLjUpICUgMzYwIH07IHJldHVybiBpOyB9KTsgcmVuZGVyMkQoKTsgc2hvd1RpcCgncm90YXRlJyk7IH07IGVsLmFwcGVuZENoaWxkKHJvdCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbGV0IGRFbHMgPSBbXTsKICAgICAgICAgICAgICAgIGludGVyYWN0KGVsKS5kcmFnZ2FibGUoewogICAgICAgICAgICAgICAgICAgIGlnbm9yZUZyb206ICcuaXRlbS10b29sYmFyLCAucm90YXRlLWhhbmRsZSwgLmxpbmVuLW1lbnUsIC5zdGFnZS1yYWlsLXRyaWdnZXInLAogICAgICAgICAgICAgICAgICAgIGxpc3RlbmVyczogewogICAgICAgICAgICAgICAgICAgICAgICBzdGFydCgpIHsgaWYoU1RBVEUuaXNUYXBlQWN0aXZlKSByZXR1cm47IHB1c2hIaXN0b3J5KCk7IGlmIChTVEFURS5zZWxlY3RlZElkcy5pbmNsdWRlcyhpdGVtLmlkKSkgZEVscyA9IFNUQVRFLnNlbGVjdGVkSWRzLm1hcChpZCA9PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaXRlbS0nICsgaWQpKS5maWx0ZXIoQm9vbGVhbik7IGVsc2UgeyBTVEFURS5zZWxlY3RlZElkcyA9IFtpdGVtLmlkXTsgcmVuZGVyMkQoKTsgZEVscyA9IFtkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaXRlbS0nICsgaXRlbS5pZCldOyB9IH0sCiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmUoZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKFNUQVRFLmlzVGFwZUFjdGl2ZSkgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmFkID0gLShTVEFURS5yb3RhdGlvbiAqIE1hdGguUEkpIC8gMTgwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZHggPSAoZXZlbnQuZHggKiBNYXRoLmNvcyhyYWQpIC0gZXZlbnQuZHkgKiBNYXRoLnNpbihyYWQpKSAvIFNUQVRFLnNjYWxlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZHkgPSAoZXZlbnQuZHggKiBNYXRoLnNpbihyYWQpICsgZXZlbnQuZHkgKiBNYXRoLmNvcyhyYWQpKSAvIFNUQVRFLnNjYWxlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZEVscy5mb3JFYWNoKGVsZW0gPT4geyBjb25zdCB4ID0gKHBhcnNlRmxvYXQoZWxlbS5zdHlsZS5sZWZ0KSB8fCAwKSArIGR4OyBjb25zdCB5ID0gKHBhcnNlRmxvYXQoZWxlbS5zdHlsZS50b3ApIHx8IDApICsgZHk7IGVsZW0uc3R5bGUubGVmdCA9IHggKyAncHgnOyBlbGVtLnN0eWxlLnRvcCA9IHkgKyAncHgnOyB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgZW5kKCkgeyBpZihTVEFURS5pc1RhcGVBY3RpdmUpIHJldHVybjsgZEVscy5mb3JFYWNoKGVsZW0gPT4geyBjb25zdCBpZCA9IGVsZW0uaWQucmVwbGFjZSgnaXRlbS0nLCAnJyk7IGNvbnN0IGlPID0gU1RBVEUuaXRlbXMuZmluZChpID0+IGkuaWQgPT09IGlkKTsgaWYgKGlPKSB7IGlPLnggPSBNYXRoLnJvdW5kKChwYXJzZUZsb2F0KGVsZW0uc3R5bGUubGVmdCkgfHwgMCkgLyBDRUxMX1NJWkUpICogQ0VMTF9TSVpFOyBpTy55ID0gTWF0aC5yb3VuZCgocGFyc2VGbG9hdChlbGVtLnN0eWxlLnRvcCkgfHwgMCkgLyBDRUxMX1NJWkUpICogQ0VMTF9TSVpFOyB9IH0pOyByZW5kZXIyRCgpOyBkRWxzID0gW107IH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBjb25zdCBpc0V4Y2x1ZGVkRnJvbUNoYWlycyA9IGl0ZW0ubmFtZS5pbmNsdWRlcygnbW9kZXJuLWxvdW5nZScpIHx8IGl0ZW0ubmFtZS5pbmNsdWRlcygndHJ1c3MnKSB8fCBpdGVtLm5hbWUuaW5jbHVkZXMoJ3RvdGVtJykgfHwgaXRlbS5uYW1lLmluY2x1ZGVzKCdkYW5jZScpIHx8IGl0ZW0ubmFtZS5pbmNsdWRlcygnc3RhZ2UnKSB8fCBpdGVtLm5hbWUgPT09ICdvZmZpY2UtY2hhaXInIHx8IGl0ZW0ubmFtZSA9PT0gJ2Jhci0zLWJhcnJlbCcgfHwgaXRlbS5uYW1lID09PSAncGF0aW8taGVhdGVyJyB8fCBpdGVtLm5hbWUuc3RhcnRzV2l0aCgnZGVjb3ItJykgfHwgaXRlbS5uYW1lLnN0YXJ0c1dpdGgoJ2luZmxhdGFibGUtJykgfHwgaXRlbS5uYW1lLnN0YXJ0c1dpdGgoJ2ZvbGlhZ2UtJyk7CiAgICAgICAgICAgICAgICBpZihpdGVtLnNlYXRzID4gMCAmJiAhaXNFeGNsdWRlZEZyb21DaGFpcnMgJiYgIWl0ZW0ubmFtZS5zdGFydHNXaXRoKCdjaGFpci0nKSkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IG9mZiA9IC0oMTcgKiAwLjUpOyAvLyBjaGFpciBkZXB0aCA9IDE3cHgsIG92ZXJsYXAgZnJhY3Rpb24gZHJpdmVzIHR1Y2sKICAgICAgICAgICAgICAgICAgICBpZihpc1JvdW5kKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhZCA9IGl3LzIgKyAoMC41IC0gMC41KSAqIDE3OyAvLyBwdWxsIGNoYWlycyBvdXQgYmFzZWQgb24gb3ZlcmxhcCBmcmFjdGlvbgogICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGk9MDsgaTxpdGVtLnNlYXRzOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJkID0gKGkgKiAoMzYwL2l0ZW0uc2VhdHMpICogTWF0aC5QSSkgLyAxODA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IGMuY2xhc3NOYW1lID0gJ2NoYWlyLTJkJzsgYXBwbHlDaGFpcjJEU3R5bGUoYyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLnN0eWxlLmxlZnQgPSAoaXcvMiArIHJhZCAqIE1hdGguY29zKHJkKSAtIDgpICsgJ3B4JzsgYy5zdHlsZS50b3AgPSAoaWgvMiArIHJhZCAqIE1hdGguc2luKHJkKSAtIDguNSkgKyAncHgnOyBjLnN0eWxlLnRyYW5zZm9ybSA9IGByb3RhdGUoJHsoaSAqICgzNjAvaXRlbS5zZWF0cykpICsgOTB9ZGVnKWA7IGVsLmFwcGVuZENoaWxkKGMpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkZWYudHlwZSA9PT0gJ2hlYWQnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwYyA9IGl3IC8gKGl0ZW0uc2VhdHMgKyAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpPTE7IGk8PWl0ZW0uc2VhdHM7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgY3QuY2xhc3NOYW1lID0gJ2NoYWlyLTJkJzsgYXBwbHlDaGFpcjJEU3R5bGUoY3QpOyBjdC5zdHlsZS5sZWZ0ID0gKHNwYyppIC0gOCkgKyAncHgnOyBjdC5zdHlsZS50b3AgPSAoLTE3IC0gb2ZmKSArICdweCc7IGVsLmFwcGVuZENoaWxkKGN0KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNudCA9IE1hdGguY2VpbChpdGVtLnNlYXRzIC8gMik7IGNvbnN0IHNwYyA9IGl3IC8gKGNudCArIDEpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGk9MTsgaTw9Y250OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IGN0LmNsYXNzTmFtZSA9ICdjaGFpci0yZCc7IGFwcGx5Q2hhaXIyRFN0eWxlKGN0KTsgY3Quc3R5bGUubGVmdCA9IChzcGMqaSAtIDgpICsgJ3B4JzsgY3Quc3R5bGUudG9wID0gKC0xNyAtIG9mZikgKyAncHgnOyBlbC5hcHBlbmRDaGlsZChjdCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBjYi5jbGFzc05hbWUgPSAnY2hhaXItMmQnOyBhcHBseUNoYWlyMkRTdHlsZShjYik7IGNiLnN0eWxlLmxlZnQgPSAoc3BjKmkgLSA4KSArICdweCc7IGNiLnN0eWxlLnRvcCA9IChpaCArIG9mZiAtIDguNSkgKyAncHgnOyBjYi5zdHlsZS50cmFuc2Zvcm0gPSBgcm90YXRlKDE4MGRlZylgOyBlbC5hcHBlbmRDaGlsZChjYik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gdG9nZ2xlVmlldygpIHsKICAgICAgICAgICAgU1RBVEUudmlldyA9IFNUQVRFLnZpZXcgPT09ICcyZCcgPyAnM2QnIDogJzJkJzsKICAgICAgICAgICAgY29uc3QgaXMzRCA9IFNUQVRFLnZpZXcgPT09ICczZCc7CiAgICAgICAgICAgIHRocmVlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpczNEID8gJ2Jsb2NrJyA6ICdub25lJzsKICAgICAgICAgICAgdGhyZWVPdmVybGF5LnN0eWxlLmRpc3BsYXkgPSBpczNEID8gJ2Jsb2NrJyA6ICdub25lJzsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RhbGx5LXBhbmVsJykuc3R5bGUuZGlzcGxheSA9IGlzM0QgPyAnbm9uZScgOiAnZmxleCc7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3cG9ydC0yZCcpLnN0eWxlLmRpc3BsYXkgPSBpczNEID8gJ25vbmUnIDogJ2ZsZXgnOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbi10b29sYmFyJykuc3R5bGUuZGlzcGxheSA9IGlzM0QgPyAnbm9uZScgOiAnZmxleCc7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXYtY29udHJvbHMnKS5zdHlsZS5kaXNwbGF5ID0gaXMzRCA/ICdub25lJyA6ICdmbGV4JzsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hpc3RvcnktY29udHJvbHMnKS5zdHlsZS5kaXNwbGF5ID0gaXMzRCA/ICdub25lJyA6ICdmbGV4JzsKICAgICAgICAgICAgaWYoaXMzRCkgeyBpbml0M0QoKTsgc2hvd1RpcCgnM2QnKTsgfSBlbHNlIGlmKHJlbmRlcmVyKSB7IHJlbmRlcmVyLmRpc3Bvc2UoKTsgY2FuY2VsQW5pbWF0aW9uRnJhbWUoYW5pbWF0aW9uRnJhbWUpOyB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB0b2dnbGVEcm9uZU1vZGUoKSB7CiAgICAgICAgICAgIFNUQVRFLmRyb25lTW9kZSA9ICFTVEFURS5kcm9uZU1vZGU7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YWxrLW1vZGUtdGl0bGUnKS5pbm5lclRleHQgPSBTVEFURS5kcm9uZU1vZGUgPyAnRHJvbmUgTW9kZScgOiAnV2FsayBNb2RlJzsKICAgICAgICAgICAgY29uc3QgbG9va0NvbnRyb2xzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvb2stY29udHJvbHMnKTsgCiAgICAgICAgICAgIGlmKGxvb2tDb250cm9scykgbG9va0NvbnRyb2xzLnN0eWxlLmRpc3BsYXkgPSBTVEFURS5kcm9uZU1vZGUgPyAnbm9uZScgOiAnZmxleCc7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCBidG5GID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1tb3ZlLWYnKTsKICAgICAgICAgICAgY29uc3QgYnRuQiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tbW92ZS1iJyk7CiAgICAgICAgICAgIGNvbnN0IGJ0bkwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLW1vdmUtbCcpOwogICAgICAgICAgICBjb25zdCBidG5SID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1tb3ZlLXInKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChTVEFURS5kcm9uZU1vZGUpIHsKICAgICAgICAgICAgICAgIGlmKGJ0bkYpIGJ0bkYuaW5uZXJUZXh0ID0gJ0lOJzsKICAgICAgICAgICAgICAgIGlmKGJ0bkIpIGJ0bkIuaW5uZXJUZXh0ID0gJ09VVCc7CiAgICAgICAgICAgICAgICBpZihidG5MKSBidG5MLnN0eWxlLm9wYWNpdHkgPSAnMCc7CiAgICAgICAgICAgICAgICBpZihidG5SKSBidG5SLnN0eWxlLm9wYWNpdHkgPSAnMCc7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZihidG5GKSBidG5GLmlubmVyVGV4dCA9ICfihpEnOwogICAgICAgICAgICAgICAgaWYoYnRuQikgYnRuQi5pbm5lclRleHQgPSAn4oaTJzsKICAgICAgICAgICAgICAgIGlmKGJ0bkwpIGJ0bkwuc3R5bGUub3BhY2l0eSA9ICcxJzsKICAgICAgICAgICAgICAgIGlmKGJ0blIpIGJ0blIuc3R5bGUub3BhY2l0eSA9ICcxJzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgZm9vdGVyQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zvb3Rlci1tb2RlLWJ0bicpOyBpZihmb290ZXJCdG4pIGZvb3RlckJ0bi5pbm5lclRleHQgPSBTVEFURS5kcm9uZU1vZGUgPyAnV0FMSyBBUk9VTkQnIDogJ0RST05FIFZJRVcnOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gc25hcHNob3QzRCgpIHsgaWYoIXJlbmRlcmVyKSByZXR1cm47IHJlbmRlcmVyLnJlbmRlcihzY2VuZSwgY2FtZXJhKTsgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsgbGluay5kb3dubG9hZCA9ICd0ZW50LTNkLnBuZyc7IGxpbmsuaHJlZiA9IHJlbmRlcmVyLmRvbUVsZW1lbnQudG9EYXRhVVJMKCdpbWFnZS9wbmcnKTsgbGluay5jbGljaygpOyB9CgogICAgICAgIGxldCBzY2VuZSwgY2FtZXJhLCByZW5kZXJlciwgYW5pbWF0aW9uRnJhbWUsIHdhbGxzR3JvdXA7CiAgICAgICAgY29uc3QgbW92ZVJlZiA9IHsgZjogZmFsc2UsIGI6IGZhbHNlLCBsOiBmYWxzZSwgcjogZmFsc2UsIHVwOiBmYWxzZSwgZG93bjogZmFsc2UsIGxvb2tMOiBmYWxzZSwgbG9va1I6IGZhbHNlLCBsb29rVXA6IGZhbHNlLCBsb29rRG93bjogZmFsc2UgfTsKICAgICAgICB3aW5kb3cudXBkYXRlTW92ZSA9IChkaXIsIGFjdGl2ZSkgPT4geyBtb3ZlUmVmW2Rpcl0gPSBhY3RpdmU7IH07CgogICAgICAgIGZ1bmN0aW9uIGluaXQzRCgpIHsKICAgICAgICAgICAgdGhyZWVDb250YWluZXIuaW5uZXJIVE1MID0gJyc7IHNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7CiAgICAgICAgICAgIGNvbnN0IEdSQVNTX1VSTCA9ICJodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9ncmFzc3RleHR1cmVfb3JpZy5wbmc/dj0yMDI2MDExNCI7CiAgICAgICAgICAgIGNvbnN0IFNLWV9EQVlfVVJMID0gImh0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3RlbnRtYXBwZXItc2t5LWRheS1lcXVpcmVjdC0yMDQ4eDEwMjRfb3JpZy5wbmc/dj0yMDI2MDExNSI7CiAgICAgICAgICAgIGNvbnN0IFNLWV9OSUdIVF9VUkwgPSAiaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvdGVudG1hcHBlci1za3ktbmlnaHQtZXF1aXJlY3QtMjA0OHgxMDI0X29yaWcucG5nP3Y9MjAyNjAxMTUiOwogICAgICAgICAgICBjb25zdCBTS1lfUElUQ0hfUkFEID0gLTAuMTg7CiAgICAgICAgICAgIGNvbnN0IFNLWV9ZQVdfUkFEID0gMC4wOwogICAgICAgICAgICBjb25zdCBob3N0ZWRMb2FkZXIgPSBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpOwogICAgICAgICAgICBob3N0ZWRMb2FkZXIuY3Jvc3NPcmlnaW4gPSAnYW5vbnltb3VzJzsKIAogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IHNreUNvbG9yID0gMHg4N0NFRUI7CiAgICAgICAgICAgIGlmIChNT0RFID09PSAnaW5zaWRlJykgewogICAgICAgICAgICAgICAgc2t5Q29sb3IgPSAweDFlMjkzYjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNreUNvbG9yID0gU1RBVEUuaXNOaWdodE1vZGUgPyAweDAyMDYxNyA6IDB4ODdDRUVCOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzY2VuZS5iYWNrZ3JvdW5kID0gbmV3IFRIUkVFLkNvbG9yKHNreUNvbG9yKTsKICAgICAgICAgICAgc2NlbmUuZm9nID0gbmV3IFRIUkVFLkZvZyhza3lDb2xvciwgMTAsIDI1MCk7CiAgICAgICAgICAgIGlmIChNT0RFID09PSAnb3V0c2lkZScpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHNreVVybCA9IFNUQVRFLmlzTmlnaHRNb2RlID8gU0tZX05JR0hUX1VSTCA6IFNLWV9EQVlfVVJMOwogICAgICAgICAgICAgICAgaG9zdGVkTG9hZGVyLmxvYWQoc2t5VXJsLCAodGV4KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGV4LmVuY29kaW5nID0gVEhSRUUuc1JHQkVuY29kaW5nOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvbWVHZW8gPSBuZXcgVEhSRUUuU3BoZXJlR2VvbWV0cnkoOTAwLCA2NCwgMzIpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvbWVNYXQgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoeyBtYXA6IHRleCwgc2lkZTogVEhSRUUuQmFja1NpZGUsIGZvZzogZmFsc2UsIGRlcHRoV3JpdGU6IGZhbHNlIH0pOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvbWUgPSBuZXcgVEhSRUUuTWVzaChkb21lR2VvLCBkb21lTWF0KTsKICAgICAgICAgICAgICAgICAgICBkb21lLm5hbWUgPSAnc2t5RG9tZUVxdWlyZWN0JzsKICAgICAgICAgICAgICAgICAgICBkb21lLnJheWNhc3QgPSAoKSA9PiB7fTsKICAgICAgICAgICAgICAgICAgICBkb21lLnJvdGF0aW9uLnNldChTS1lfUElUQ0hfUkFELCBTS1lfWUFXX1JBRCwgMCk7CiAgICAgICAgICAgICAgICAgICAgc2NlbmUuYWRkKGRvbWUpOwogICAgICAgICAgICAgICAgfSwgdW5kZWZpbmVkLCAoKSA9PiB7fSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIAogICAgICAgICAgICBjYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoNzUsIHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0LCAwLjEsIDEwMDApOyBjYW1lcmEucm90YXRpb24ub3JkZXIgPSAnWVhaJzsKICAgICAgICAgICAgcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7IGFudGlhbGlhczogdHJ1ZSwgcHJlc2VydmVEcmF3aW5nQnVmZmVyOiB0cnVlLCBsb2dhcml0aG1pY0RlcHRoQnVmZmVyOiB0cnVlIH0pOwogICAgICAgICAgICByZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpOyByZW5kZXJlci5zaGFkb3dNYXAuZW5hYmxlZCA9IHRydWU7IHJlbmRlcmVyLnNoYWRvd01hcC50eXBlID0gVEhSRUUuUENGU29mdFNoYWRvd01hcDsKICAgICAgICAgICAgdGhyZWVDb250YWluZXIuYXBwZW5kQ2hpbGQocmVuZGVyZXIuZG9tRWxlbWVudCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCBhbWJJbnRlbnNpdHkgPSAoU1RBVEUuaXNOaWdodE1vZGUgJiYgTU9ERSA9PT0gJ291dHNpZGUnKSA/IDAuMyA6IDAuOTsKICAgICAgICAgICAgc2NlbmUuYWRkKG5ldyBUSFJFRS5BbWJpZW50TGlnaHQoMHhmZmZmZmYsIGFtYkludGVuc2l0eSkpOwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3Qgc3VuSW50ZW5zaXR5ID0gKFNUQVRFLmlzTmlnaHRNb2RlICYmIE1PREUgPT09ICdvdXRzaWRlJykgPyAwLjIgOiAwLjY7CiAgICAgICAgICAgIGNvbnN0IHN1biA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KDB4ZmZmZmZmLCBzdW5JbnRlbnNpdHkpOyAKICAgICAgICAgICAgc3VuLnBvc2l0aW9uLnNldCg1MCwgMTAwLCA1MCk7IHN1bi5jYXN0U2hhZG93ID0gdHJ1ZTsgc3VuLnNoYWRvdy5tYXBTaXplLndpZHRoID0gNDA5Njsgc3VuLnNoYWRvdy5tYXBTaXplLmhlaWdodCA9IDQwOTY7CiAgICAgICAgICAgIHNjZW5lLmFkZChzdW4pOwoKICAgICAgICAgICAgY29uc3QgZ2V0VGV4ID0gKHR5cGUpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsgYy53aWR0aCA9IDEwMjQ7IGMuaGVpZ2h0ID0gMTAyNDsgY29uc3QgY3R4ID0gYy5nZXRDb250ZXh0KCcyZCcpOwogICAgICAgICAgICAgICAgaWYodHlwZSA9PT0gJ2dyYXNzJykgewogICAgICAgICAgICAgICAgICAgIC8vIERBUksgTU9TU1kgR1JBU1MgKE1BVENISU5HIE1BSU4gQVBQKQogICAgICAgICAgICAgICAgICAgIGNvbnN0IFNJWkUgPSAxMDI0OwogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAnIzFhMTgxMic7CiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIFNJWkUsIFNJWkUpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRyYXdUaWxlYWJsZSA9IChkcmF3Rm4pID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgWzAsIFNJWkUsIC1TSVpFXS5mb3JFYWNoKG94ID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFswLCBTSVpFLCAtU0laRV0uZm9yRWFjaChveSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJhd0ZuKG94LCBveSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpPTA7IGk8ODAwMDA7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB4ID0gTWF0aC5yYW5kb20oKSAqIFNJWkU7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHkgPSBNYXRoLnJhbmRvbSgpICogU0laRTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdyA9IDIgKyBNYXRoLnJhbmRvbSgpICogNjsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaCA9IDIgKyBNYXRoLnJhbmRvbSgpICogNjsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgclZhbCA9IE1hdGgucmFuZG9tKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyVmFsIDwgMC40KSBjdHguZmlsbFN0eWxlID0gJyMyMjJiMTMnOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChyVmFsIDwgMC43KSBjdHguZmlsbFN0eWxlID0gJyMyZDM4MWMnOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGN0eC5maWxsU3R5bGUgPSAnIzFlMjQwZic7CiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuODsKICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KHgsIHksIHcsIGgpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC40OwogICAgICAgICAgICAgICAgICAgIGZvcihsZXQgaT0wOyBpPDI1OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3ggPSBNYXRoLnJhbmRvbSgpICogU0laRTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3kgPSBNYXRoLnJhbmRvbSgpICogU0laRTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IDgwICsgTWF0aC5yYW5kb20oKSAqIDE1MDsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZyA9IGN0eC5jcmVhdGVSYWRpYWxHcmFkaWVudChjeCwgY3ksIDAsIGN4LCBjeSwgcik7CiAgICAgICAgICAgICAgICAgICAgICAgIGcuYWRkQ29sb3JTdG9wKDAsICcjM2E0YTI1Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGcuYWRkQ29sb3JTdG9wKDAuNiwgJyMyZDM4MWMnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZy5hZGRDb2xvclN0b3AoMSwgJ3JnYmEoNDUsIDU2LCAyOCwgMCknKTsKICAgICAgICAgICAgICAgICAgICAgICAgZHJhd1RpbGVhYmxlKChveCwgb3kpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShveCwgb3kpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOyBjdHguYXJjKGN4LCBjeSwgciwgMCwgTWF0aC5QSSoyKTsgY3R4LmZpbGwoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC50cmFuc2xhdGUoLW94LCAtb3kpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuMjU7CiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpPTA7IGk8NDA7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjeCA9IE1hdGgucmFuZG9tKCkgKiBTSVpFOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjeSA9IE1hdGgucmFuZG9tKCkgKiBTSVpFOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gNDAgKyBNYXRoLnJhbmRvbSgpICogODA7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGcgPSBjdHguY3JlYXRlUmFkaWFsR3JhZGllbnQoY3gsIGN5LCAwLCBjeCwgY3ksIHIpOwogICAgICAgICAgICAgICAgICAgICAgICBnLmFkZENvbG9yU3RvcCgwLCAnIzRhM2IyYScpOwogICAgICAgICAgICAgICAgICAgICAgICBnLmFkZENvbG9yU3RvcCgxLCAndHJhbnNwYXJlbnQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZHJhd1RpbGVhYmxlKChveCwgb3kpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShveCwgb3kpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOyBjdHguYXJjKGN4LCBjeSwgciwgMCwgTWF0aC5QSSoyKTsgY3R4LmZpbGwoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC50cmFuc2xhdGUoLW94LCAtb3kpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNzsKICAgICAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMS4wOwogICAgICAgICAgICAgICAgICAgIGZvcihsZXQgaT0wOyBpPDE1MDAwMDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHggPSBNYXRoLnJhbmRvbSgpICogU0laRTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeSA9IE1hdGgucmFuZG9tKCkgKiBTSVpFOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsZW4gPSAzICsgTWF0aC5yYW5kb20oKSAqIDQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFuZyA9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDAuNSAtIChNYXRoLlBJLzIpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByVmFsID0gTWF0aC5yYW5kb20oKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJWYWwgPCAwLjYpIGN0eC5zdHJva2VTdHlsZSA9ICcjNDI1NDJhJzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoclZhbCA8IDAuOSkgY3R4LnN0cm9rZVN0eWxlID0gJyM1YzczM2EnOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGN0eC5zdHJva2VTdHlsZSA9ICcjMmIzNjE4JzsKICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgICAgICAgICBjdHgubW92ZVRvKHgsIHkpOwogICAgICAgICAgICAgICAgICAgICAgICBjdHgubGluZVRvKHggKyBNYXRoLmNvcyhhbmcpKmxlbiwgeSArIE1hdGguc2luKGFuZykqbGVuKTsKICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZSgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxLjA7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYodHlwZS5zdGFydHNXaXRoKCdzaWRld2FsbF8nKSkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gdHlwZS5zcGxpdCgnXycpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwID0gcGFyc2VJbnQocGFydHNbMV0gfHwgJzEwJywgMTApIHx8IDEwOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhcmlhbnQgPSAocGFydHNbMl0gfHwgJ3dpbicpLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNXaW5kb3cgPSB2YXJpYW50ICE9PSAnc29saWQnOwoKICAgICAgICAgICAgICAgICAgICAvLyBCYXNlIGZhYnJpYwogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAnI2Y4ZmFmYyc7CiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIDEwMjQsIDEwMjQpOwoKICAgICAgICAgICAgICAgICAgICAvLyBTZWFtcyAocm91Z2hseSBldmVyeSB+MmZ0KQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlYW1FdmVyeSA9IDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VhbUNvdW50ID0gTWF0aC5tYXgoMSwgTWF0aC5yb3VuZChzcCAvIHNlYW1FdmVyeSkpOwogICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICdyZ2JhKDE1LCAyMywgNDIsIDAuMTApJzsKICAgICAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMTA7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBzZWFtQ291bnQ7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB4ID0gTWF0aC5yb3VuZCgoaSAvIHNlYW1Db3VudCkgKiAxMDI0KTsKICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgICAgICAgICBjdHgubW92ZVRvKHgsIDApOwogICAgICAgICAgICAgICAgICAgICAgICBjdHgubGluZVRvKHgsIDEwMjQpOwogICAgICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAvLyBUb3AvYm90dG9tIGhlbQogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAncmdiYSgxNSwgMjMsIDQyLCAwLjA2KSc7CiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIDEwMjQsIDI2KTsKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFJlY3QoMCwgMTAyNCAtIDI2LCAxMDI0LCAyNik7CgogICAgICAgICAgICAgICAgICAgIGlmIChpc1dpbmRvdykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkcmF3V2luID0gKG94KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3aW5XID0gMzgwLCB3aW5IID0gNDAwLCB0b3BZID0gMzMwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5hcmMob3gsIHRvcFksIHdpblcvMiwgTWF0aC5QSSwgMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgubGluZVRvKG94K3dpblcvMiwgdG9wWSt3aW5IKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8ob3gtd2luVy8yLCB0b3BZK3dpbkgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmNsb3NlUGF0aCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmNsaXAoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHguY2xlYXJSZWN0KG94LXdpblcvMiwgdG9wWS13aW5XLzIsIHdpblcsIHdpbkgrd2luVy8yKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAncmdiYSgyMzAsIDI0NSwgMjU1LCAwLjIyKSc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFJlY3Qob3gtd2luVy8yLCB0b3BZLXdpblcvMiwgd2luVywgd2luSCt3aW5XLzIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICdyZ2JhKDIsIDYsIDIzLCAwLjE4KSc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gNjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8ob3gsIHRvcFkgLSB3aW5XLzIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyhveCwgdG9wWSArIHdpbkgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZSgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gJyNjYmQ1ZTEnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDE0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmFyYyhveCwgdG9wWSwgd2luVy8yLCBNYXRoLlBJLCAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8ob3grd2luVy8yLCB0b3BZK3dpbkgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyhveC13aW5XLzIsIHRvcFkrd2luSCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHguY2xvc2VQYXRoKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgICAgICAvLyAyMCcgc2VjdGlvbnMgZ2VuZXJhbGx5IGdldCB0d28gd2luZG93cywgc21hbGxlciBnZXQgb25lCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcCA+PSAxOCkgeyBkcmF3V2luKDI1Nik7IGRyYXdXaW4oNzY4KTsgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGRyYXdXaW4oNTEyKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBncmQgPSBjdHguY3JlYXRlTGluZWFyR3JhZGllbnQoMCwgMCwgMCwgMTAyNCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyZC5hZGRDb2xvclN0b3AoMCwgJ3JnYmEoMiwgNiwgMjMsIDAuMDMpJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyZC5hZGRDb2xvclN0b3AoMC41NSwgJ3JnYmEoMiwgNiwgMjMsIDAuMDApJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyZC5hZGRDb2xvclN0b3AoMSwgJ3JnYmEoMiwgNiwgMjMsIDAuMDUpJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBncmQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCAxMDI0LCAxMDI0KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zdCB0ZXggPSBuZXcgVEhSRUUuQ2FudmFzVGV4dHVyZShjKTsgdGV4LndyYXBTID0gdGV4LndyYXBUID0gVEhSRUUuUmVwZWF0V3JhcHBpbmc7IGlmKHR5cGU9PT0nZ3Jhc3MnKSB0ZXgucmVwZWF0LnNldCg4MCw4MCk7IGlmKHR5cGUuc3RhcnRzV2l0aCgnc2lkZXdhbGxfJykpIHRleC53cmFwUyA9IHRleC53cmFwVCA9IFRIUkVFLkNsYW1wVG9FZGdlV3JhcHBpbmc7IHJldHVybiB0ZXg7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBjb25zdCBjcmVhdGVUZW50TWVzaCA9ICh0VywgdEQsIHRULCBmb3JjZVJvb2YsIHBvbGVMZWdIZWlnaHRGdCwgcG9sZUNlbnRlclBvbGVIZWlnaHRGdCwgaGV4U2lkZUxlbmd0aEZ0KSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBncm91cCA9IG5ldyBUSFJFRS5Hcm91cCgpOwogICAgICAgICAgICAgICAgbGV0IHBlYWtIID0gMTMsIHdhbGxIID0gOCwgc3dvb3AgPSAxLjA7IAogICAgICAgICAgICAgICAgaWYgKHRUID09PSAnUG9sZScpIHsgcGVha0ggPSAyNS42OyB3YWxsSCA9IDg7IHN3b29wID0gMy4wOyB9IGVsc2UgaWYgKHRUID09PSAnTWFycXVlZScpIHsgcGVha0ggPSAxNi41OyB3YWxsSCA9IDg7IHN3b29wID0gMS42OyB9IGVsc2UgaWYgKHRUID09PSAnSGV4JykgeyBwZWFrSCA9IDIyOyB3YWxsSCA9IDg7IHN3b29wID0gMS42OyB9CiAgICAgICAgICAgICAgICBpZiAodFQgPT09ICdQb2xlJykgewogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcG9sZUxlZ0hlaWdodEZ0ID09PSAnbnVtYmVyJyAmJiBpc0Zpbml0ZShwb2xlTGVnSGVpZ2h0RnQpKSB3YWxsSCA9IHBvbGVMZWdIZWlnaHRGdDsKICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvbGVDZW50ZXJQb2xlSGVpZ2h0RnQgPT09ICdudW1iZXInICYmIGlzRmluaXRlKHBvbGVDZW50ZXJQb2xlSGVpZ2h0RnQpKSBwZWFrSCA9IHBvbGVDZW50ZXJQb2xlSGVpZ2h0RnQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zdCBwTWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IHRUID09PSAnUG9wdXAnID8gMHhmY2ZjZmMgOiAodFQgPT09ICdNYXJxdWVlJyA/IDB4ZWZlZmVmIDogMHhjY2NjY2MpLCBtZXRhbG5lc3M6IDAuNiwgcm91Z2huZXNzOiAwLjIgfSk7IAogICAgICAgICAgICAgICAgY29uc3QgdmluTWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4ZmZmZmZmLCBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlLCByb3VnaG5lc3M6IDEuMCwgbWV0YWxuZXNzOiAwLjAgfSk7CiAgICAgICAgICAgICAgICBjb25zdCBjYWJsZU1hdCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweDMzMzMzMyB9KTsKCiAgICAgICAgICAgICAgICAvLyBIZXggdGVudHM6IDYgbGVncyArIGEgZmxvYXRpbmcgcGVhayBwb2xlIGhlbGQgYnkgMyBjcm9zcy1jYWJsZXMgKG5vIGdyb3VuZCBjZW50ZXIgcG9sZSkuCiAgICAgICAgICAgICAgICBpZiAodFQgPT09ICdIZXgnKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2lkZUxlbiA9ICh0eXBlb2YgaGV4U2lkZUxlbmd0aEZ0ID09PSAnbnVtYmVyJyAmJiBpc0Zpbml0ZShoZXhTaWRlTGVuZ3RoRnQpKSA/IGhleFNpZGVMZW5ndGhGdCA6ICh0RCAvIDIpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBzaWRlTGVuOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGN4ID0gdFcgLyAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGN6ID0gdEQgLyAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZlcnRzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogNiB9LCAoXywgaSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gLU1hdGguUEkgLyAyICsgaSAqIE1hdGguUEkgLyAzOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB4OiBjeCArIHIgKiBNYXRoLmNvcyhhKSwgejogY3ogKyByICogTWF0aC5zaW4oYSkgfTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBsZWdSID0gMC4xMjsKICAgICAgICAgICAgICAgICAgICB2ZXJ0cy5mb3JFYWNoKHYgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsZWcgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeShsZWdSLCBsZWdSLCB3YWxsSCwgMTYpLCBwTWF0KTsKICAgICAgICAgICAgICAgICAgICAgICAgbGVnLnBvc2l0aW9uLnNldCh2LnggLSB0VyAvIDIsIHdhbGxIIC8gMiwgdi56IC0gdEQgLyAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgbGVnLmNhc3RTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBncm91cC5hZGQobGVnKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGxhdGUgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQm94R2VvbWV0cnkoMC41LCAwLjA1LCAwLjUpLCBwTWF0KTsKICAgICAgICAgICAgICAgICAgICAgICAgcGxhdGUucG9zaXRpb24uc2V0KHYueCAtIHRXIC8gMiwgMC4wMjUsIHYueiAtIHREIC8gMik7CiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXRlLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBncm91cC5hZGQocGxhdGUpOwogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICBjb25zdCBwb2xlU3RhcnRZID0gd2FsbEg7IC8vIGZsb2F0aW5nIHBvbGUgc3RhcnRzIGF0IHRvcCBvZiA4ZnQgbGVncwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvbGVMZW4gPSBNYXRoLm1heCgwLjAxLCBwZWFrSCAtIHdhbGxIKTsgLy8gMTRmdCBwb2xlIG9uIDhmdCBsZWdzID0+IDIyZnQgcGVhawogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZseWluZ1BvbGUgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeSgwLjEyLCAwLjEyLCBwb2xlTGVuLCAxNiksIHBNYXQpOwogICAgICAgICAgICAgICAgICAgIGZseWluZ1BvbGUucG9zaXRpb24uc2V0KDAsIHBvbGVTdGFydFkgKyBwb2xlTGVuIC8gMiwgMCk7CiAgICAgICAgICAgICAgICAgICAgZmx5aW5nUG9sZS5jYXN0U2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBncm91cC5hZGQoZmx5aW5nUG9sZSk7CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IGFkZENhYmxlID0gKGFJZHgsIGJJZHgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYVYgPSB2ZXJ0c1thSWR4XTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYlYgPSB2ZXJ0c1tiSWR4XTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgVEhSRUUuVmVjdG9yMyhhVi54IC0gdFcgLyAyLCB3YWxsSCwgYVYueiAtIHREIC8gMik7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IG5ldyBUSFJFRS5WZWN0b3IzKGJWLnggLSB0VyAvIDIsIHdhbGxILCBiVi56IC0gdEQgLyAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGlyID0gbmV3IFRIUkVFLlZlY3RvcjMoKS5zdWJWZWN0b3JzKGVuZCwgc3RhcnQpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsZW4gPSBkaXIubGVuZ3RoKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsZW4gPCAwLjAwMDEpIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3lsID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkoMC4wMywgMC4wMywgbGVuLCA4KSwgY2FibGVNYXQpOwogICAgICAgICAgICAgICAgICAgICAgICBjeWwucG9zaXRpb24uY29weShzdGFydCkuYWRkKGVuZCkubXVsdGlwbHlTY2FsYXIoMC41KTsKICAgICAgICAgICAgICAgICAgICAgICAgY3lsLnF1YXRlcm5pb24uc2V0RnJvbVVuaXRWZWN0b3JzKG5ldyBUSFJFRS5WZWN0b3IzKDAsIDEsIDApLCBkaXIubm9ybWFsaXplKCkpOwogICAgICAgICAgICAgICAgICAgICAgICBjeWwuY2FzdFNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmFkZChjeWwpOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYWRkQ2FibGUoMCwgMyk7IGFkZENhYmxlKDEsIDQpOyBhZGRDYWJsZSgyLCA1KTsKCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2hvdWxkUm9vZiA9ICEhZm9yY2VSb29mIHx8IFNUQVRFLnNob3dSb29mOwogICAgICAgICAgICAgICAgICAgIGlmIChzaG91bGRSb29mKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IEggPSBwZWFrSCAtIHdhbGxIOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByb29mR2VvID0gbmV3IFRIUkVFLkNvbmVHZW9tZXRyeShyLCBILCA2LCAyOCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJvb2ZHZW8udHJhbnNsYXRlKDAsIHdhbGxIICsgSCAvIDIsIDApOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2hhcGUgdGhlIHJvb2YgdG8gbWF0Y2ggYSByZWFsIGhpZ2gtcGVhayBoZXggbWFycXVlZSBjb250b3VyOgogICAgICAgICAgICAgICAgICAgICAgICAvLyAtIE5vIG91dHdhcmQgImJ1bGdlIiAodGhhdCBsb29rZWQgd3JvbmcpCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIC0gSW5zdGVhZDogYSBjb25jYXZlIHN3b29wIChoZWlnaHQgZHJvcHMgZmFzdGVyIHRocm91Z2ggdGhlIG1pZC1zbG9wZSkKICAgICAgICAgICAgICAgICAgICAgICAgLy8gLSBPcHRpb25hbDogYSB0aW55IHBhbmVsIGRpcCBiZXR3ZWVuIHJpZGdlcyAoc3VidGxlKQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwb3MgPSByb29mR2VvLmF0dHJpYnV0ZXMucG9zaXRpb247CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IEh0b3QgPSAocGVha0ggLSB3YWxsSCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnZlUG93ID0gMC42MjsgLy8gPDEgPT4gY29uY2F2ZSBwcm9maWxlIGxpa2UgcmVhbCBoaWdoLXBlYWsgY2Fub3B5CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNhZ0FtdCA9IDAuMTg7ICAgLy8gZmVldDsgc3VidGxlIGRpcCBiZXR3ZWVuIHJpZGdlcyAoc2V0IDAgdG8gZGlzYWJsZSkKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29ybmVyQW5nbGVzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogNiB9LCAoXywgaSkgPT4gKC1NYXRoLlBJIC8gMikgKyBpICogKE1hdGguUEkgLyAzKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vcm1BbmcgPSAoYSkgPT4geyB3aGlsZSAoYSA+IE1hdGguUEkpIGEgLT0gTWF0aC5QSSAqIDI7IHdoaWxlIChhIDwgLU1hdGguUEkpIGEgKz0gTWF0aC5QSSAqIDI7IHJldHVybiBhOyB9OwoKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3MuY291bnQ7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeCA9IHBvcy5nZXRYKGkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeiA9IHBvcy5nZXRaKGkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJyID0gTWF0aC5zcXJ0KHggKiB4ICsgeiAqIHopOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdSA9IE1hdGgubWluKDEsIE1hdGgubWF4KDAsIHJyIC8gcikpOyAvLyAwPWNlbnRlciwgMT1lYXZlCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29uY2F2ZSBoZWlnaHQgcHJvZmlsZS4gRm9yIHU9MCA9PiBwZWFrSDsgZm9yIHU9MSA9PiB3YWxsSC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB5ID0gd2FsbEggKyBIdG90ICogKDEgLSBNYXRoLnBvdyh1LCBjdXJ2ZVBvdykpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFZlcnkgc3VidGxlICJwYW5lbCBkaXAiIGJldHdlZW4gcmlkZ2UgbGluZXMgKGZhY2UgY2VudGVycyBkaXAgc2xpZ2h0bHkpLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNhZ0FtdCA+IDAuMDAwMSAmJiByciA+IDAuMDAwMSAmJiB1ID4gMC4wMDAxICYmIHUgPCAwLjk5OTkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0aGV0YSA9IE1hdGguYXRhbjIoeiwgeCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1pbkRlbHRhID0gTWF0aC5QSTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNhIG9mIGNvcm5lckFuZ2xlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkID0gTWF0aC5hYnMobm9ybUFuZyh0aGV0YSAtIGNhKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkIDwgbWluRGVsdGEpIG1pbkRlbHRhID0gZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFuZWxNaWQgPSBNYXRoLm1pbigxLCBtaW5EZWx0YSAvIChNYXRoLlBJIC8gNikpOyAvLyAwIGF0IHJpZGdlLCAxIGF0IGZhY2UgY2VudGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2FnID0gc2FnQW10ICogTWF0aC5zaW4oTWF0aC5QSSAqIHBhbmVsTWlkKSAqIE1hdGguc2luKE1hdGguUEkgKiB1KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5IC09IHNhZzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3Muc2V0WFlaKGksIHgsIHksIHopOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHBvcy5uZWVkc1VwZGF0ZSA9IHRydWU7CgogICAgICAgICAgICAgICAgICAgICAgICByb29mR2VvLmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7CgogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByb29mID0gbmV3IFRIUkVFLk1lc2gocm9vZkdlbywgdmluTWF0KTsKICAgICAgICAgICAgICAgICAgICAgICAgcm9vZi5jYXN0U2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuYWRkKHJvb2YpOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gVmFsZW5jZSAobGlrZSBNYXJxdWVlIHRlbnRzKTogMWZ0IGRyb3AgYXJvdW5kIHRoZSBwZXJpbWV0ZXIsIHBsdXMgYSBzbWFsbCBoZW0gc3RyaXAuCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZIID0gMS4wOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWxlbmNlSGVtTWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4Y2NjY2NjLCBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjZW50ZXIgPSB7IHg6IGN4LCB6OiBjeiB9OwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYSA9IHZlcnRzW2ldOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYiA9IHZlcnRzWyhpICsgMSkgJSA2XTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pZCA9IHsgeDogKGEueCArIGIueCkgLyAyLCB6OiAoYS56ICsgYi56KSAvIDIgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGR4ID0gYi54IC0gYS54OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZHogPSBiLnogLSBhLno7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2dyA9IE1hdGguaHlwb3QoZHgsIGR6KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2dyA8IDAuMDAxKSBjb250aW51ZTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPdXR3YXJkIG5vcm1hbCAocGVycGVuZGljdWxhciB0byBlZGdlKSwgY2hvc2VuIHRvIHBvaW50IGF3YXkgZnJvbSBjZW50ZXIuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbnggPSBkejsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBueiA9IC1keDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5MZW4gPSBNYXRoLmh5cG90KG54LCBueikgfHwgMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG54IC89IG5MZW47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBueiAvPSBuTGVuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9NaWRYID0gbWlkLnggLSBjZW50ZXIueDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvTWlkWiA9IG1pZC56IC0gY2VudGVyLno7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobnggKiB0b01pZFggKyBueiAqIHRvTWlkWiA8IDApIHsgbnggKj0gLTE7IG56ICo9IC0xOyB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcnkgPSBNYXRoLmF0YW4yKG54LCBueik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvZmYgPSAwLjA2OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHggPSAobWlkLnggLSB0VyAvIDIpICsgbnggKiBvZmY7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBweiA9IChtaWQueiAtIHREIC8gMikgKyBueiAqIG9mZjsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2ID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkodncsIHZIKSwgdmluTWF0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYucG9zaXRpb24uc2V0KHB4LCB3YWxsSCAtIHZIIC8gMiwgcHopOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdi5yb3RhdGlvbi55ID0gcnk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuYWRkKHYpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlbSA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KHZ3LCAwLjA1KSwgdmFsZW5jZUhlbU1hdCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZW0ucG9zaXRpb24uc2V0KHB4ICsgbnggKiAwLjAxLCB3YWxsSCAtIHZIICsgMC4wMjUsIHB6ICsgbnogKiAwLjAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlbS5yb3RhdGlvbi55ID0gcnk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZW0ucmVjZWl2ZVNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cC5hZGQoaGVtKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdyb3VwOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnN0IGdldFdTcCA9ICh0LCBsZW4pID0+IHQgPT09ICdQb3B1cCcgPyAxMCA6ICh0ID09PSAnUG9sZScgPyAyMCA6IChsZW4gJSAxNSA9PT0gMCA/IDE1IDogMjApKTsgCiAgICAgICAgICAgICAgICBjb25zdCB3U3AgPSBnZXRXU3AodFQsIHRXKTsgY29uc3QgZFNwID0gZ2V0V1NwKHRULCB0RCk7IAogICAgICAgICAgICAgICAgY29uc3QgcEdXID0gdFQgPT09ICdQb2xlJyA/IDEwIDogd1NwOyBjb25zdCBwR0QgPSB0VCA9PT0gJ1BvbGUnID8gMTAgOiBkU3A7IAoKICAgICAgICAgICAgICAgIGNvbnN0IGFkZExlZyA9IChweCwgcHopID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBMRUdfSU5TRVQgPSAodFQgPT09ICdQb3B1cCcgfHwgdFQgPT09ICdNYXJxdWVlJykgPyAwLjMgOiAwOyAKICAgICAgICAgICAgICAgICAgICBjb25zdCBheCA9IHB4ID09PSAwID8gTEVHX0lOU0VUIDogKHB4ID09PSB0VyA/IHRXIC0gTEVHX0lOU0VUIDogcHgpOyAKICAgICAgICAgICAgICAgICAgICBjb25zdCBheiA9IHB6ID09PSAwID8gTEVHX0lOU0VUIDogKHB6ID09PSB0RCA/IHREIC0gTEVHX0lOU0VUIDogcHopOwogICAgICAgICAgICAgICAgICAgIGxldCBsZWc7IGlmKHRUID09PSAnUG9wdXAnKSBsZWcgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQm94R2VvbWV0cnkoMC4xMiwgd2FsbEgsIDAuMTIpLCBwTWF0KTsgZWxzZSB7IGNvbnN0IHIgPSB0VCA9PT0gJ01hcnF1ZWUnID8gMC4xMiA6IDAuMTU7IGxlZyA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KHIsIHIsIHdhbGxILCAxNiksIHBNYXQpOyB9CiAgICAgICAgICAgICAgICAgICAgbGVnLnBvc2l0aW9uLnNldChheCAtIHRXLzIsIHdhbGxILzIsIGF6IC0gdEQvMik7IGxlZy5jYXN0U2hhZG93ID0gdHJ1ZTsgZ3JvdXAuYWRkKGxlZyk7IAogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBsYXRlID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkJveEdlb21ldHJ5KDAuNSwgMC4wNSwgMC41KSwgcE1hdCk7IHBsYXRlLnBvc2l0aW9uLnNldChheCAtIHRXLzIsIDAuMDI1LCBheiAtIHRELzIpOyBwbGF0ZS5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsgZ3JvdXAuYWRkKHBsYXRlKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBmb3IobGV0IHg9MDsgeDw9dFc7IHgrPXBHVykgeyBhZGRMZWcoeCwgMCk7IGFkZExlZyh4LCB0RCk7IH0KICAgICAgICAgICAgICAgIGZvcihsZXQgej1wR0Q7IHo8dEQ7IHorPXBHRCkgeyBhZGRMZWcoMCwgeik7IGFkZExlZyh0Vywgeik7IH0KCiAgICAgICAgICAgICAgICBjb25zdCBwZWFrcyA9IFtdOyBjb25zdCBpc0xvbmdaID0gdEQgPiB0VzsgY29uc3QgbG9uZ0xlbiA9IE1hdGgubWF4KHRXLCB0RCk7CiAgICAgICAgY29uc3Qgc3ltbWV0cmljSW50ZXJpb3JQb3NpdGlvbnMgPSAobGVuZ3RoLCBtYXhTcGFuKSA9PiB7CiAgICAgICAgICAgIGlmIChsZW5ndGggPD0gbWF4U3BhbiArIDFlLTYpIHJldHVybiBbbGVuZ3RoIC8gMl07CiAgICAgICAgICAgIGNvbnN0IHNlY3Rpb25zID0gTWF0aC5jZWlsKGxlbmd0aCAvIG1heFNwYW4pOwogICAgICAgICAgICBjb25zdCBiYXkgPSBsZW5ndGggLyBzZWN0aW9uczsKICAgICAgICAgICAgY29uc3Qgb3V0ID0gW107CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc2VjdGlvbnM7IGkrKykgb3V0LnB1c2goaSAqIGJheSk7CiAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgfTsKICAgICAgICBpZiAodFQgPT09ICdQb2xlJykgewogICAgICAgICAgICBjb25zdCBzcGFuID0gTWF0aC5taW4odFcsIHREKTsKICAgICAgICAgICAgY29uc3QgbG9uZ1Bvc2l0aW9ucyA9IHN5bW1ldHJpY0ludGVyaW9yUG9zaXRpb25zKGxvbmdMZW4sIDIwKTsKICAgICAgICAgICAgY29uc3Qgcm93UG9zaXRpb25zID0gc3BhbiA8PSA0MCA/IFtzcGFuIC8gMl0gOiBzeW1tZXRyaWNJbnRlcmlvclBvc2l0aW9ucyhzcGFuLCAyMCk7CgogICAgICAgICAgICBpZiAoaXNMb25nWikgewogICAgICAgICAgICAgICAgcm93UG9zaXRpb25zLmZvckVhY2goKHgpID0+IGxvbmdQb3NpdGlvbnMuZm9yRWFjaCgoeikgPT4gcGVha3MucHVzaCh7IHgsIHogfSkpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxvbmdQb3NpdGlvbnMuZm9yRWFjaCgoeCkgPT4gcm93UG9zaXRpb25zLmZvckVhY2goKHopID0+IHBlYWtzLnB1c2goeyB4LCB6IH0pKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgeyAKICAgICAgICAgICAgICAgICAgICBjb25zdCBuUCA9ICh0VCA9PT0gJ1BvcHVwJyAmJiBsb25nTGVuID09PSAyMCkgPyAyIDogTWF0aC5tYXgoMSwgTWF0aC5yb3VuZChsb25nTGVuIC8gMjApKTsgY29uc3QgYkwgPSBsb25nTGVuIC8gblA7IAogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgblA7IGkrKykgeyAKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsID0gaSAqIGJMICsgYkwgLyAyOyBjb25zdCBwID0gaXNMb25nWiA/IHsgeDogdFcgLyAyLCB6OiB2YWwgfSA6IHsgeDogdmFsLCB6OiB0RCAvIDIgfTsgcGVha3MucHVzaChwKTsgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0VCA9PT0gJ01hcnF1ZWUnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmcCA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KDAuMTIsIDAuMTIsIHBlYWtIIC0gd2FsbEgsIDEyKSwgcE1hdCk7IGZwLnBvc2l0aW9uLnNldChwLnggLSB0Vy8yLCB3YWxsSCArIChwZWFrSCAtIHdhbGxIKSAvIDIsIHAueiAtIHRELzIpOyBncm91cC5hZGQoZnApOyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJTID0gaSAqIGJMLCBiRSA9IChpICsgMSkgKiBiTDsgY29uc3QgY29ybmVycyA9IGlzTG9uZ1ogPyBbWzAsIGJTXSwgW3RXLCBiU10sIFswLCBiRV0sIFt0VywgYkVdXSA6IFtbYlMsIDBdLCBbYkUsIDBdLCBbYlMsIHREXSwgW2JFLCB0RF1dOyBjb3JuZXJzLmZvckVhY2goKFtjeCwgY3pdKSA9PiB7IGNvbnN0IHN0YXJ0ID0gbmV3IFRIUkVFLlZlY3RvcjMoY3ggLSB0Vy8yLCB3YWxsSCwgY3ogLSB0RC8yKSwgZW5kID0gbmV3IFRIUkVFLlZlY3RvcjMocC54IC0gdFcvMiwgd2FsbEgsIHAueiAtIHRELzIpOyBjb25zdCBjYWJsZSA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KDAuMDIsIDAuMDIsIHN0YXJ0LmRpc3RhbmNlVG8oZW5kKSwgOCksIGNhYmxlTWF0KTsgY2FibGUucG9zaXRpb24uY29weShuZXcgVEhSRUUuVmVjdG9yMygpLmFkZFZlY3RvcnMoc3RhcnQsIGVuZCkubXVsdGlwbHlTY2FsYXIoMC41KSk7IGNhYmxlLnF1YXRlcm5pb24uc2V0RnJvbVVuaXRWZWN0b3JzKG5ldyBUSFJFRS5WZWN0b3IzKDAsIDEsIDApLCBlbmQuY2xvbmUoKS5zdWIoc3RhcnQpLm5vcm1hbGl6ZSgpKTsgZ3JvdXAuYWRkKGNhYmxlKTsgfSk7IAogICAgICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gRW1iZWQgcHJldmlldzogZW5zdXJlIFBvbGUgdGVudHMgaGF2ZSB2aXNpYmxlIGNlbnRlciBwb2xlcy4KICAgICAgICAgICAgICAgIC8vIChQZWFrcyB3ZXJlIGFscmVhZHkgdXNlZCB0byBzaGFwZSB0aGUgcm9vZjsgdGhpcyBkcmF3cyB0aGUgYWN0dWFsIHBvbGUgbWVzaGVzLikKICAgICAgICAgICAgICAgIGlmICh0VCA9PT0gJ1BvbGUnICYmIHBlYWtzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNwR2VvID0gbmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkoMC4zLCAwLjMsIHBlYWtILCAyNCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3BQbGF0ZUdlbyA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSgwLjcsIDAuMDUsIDAuNyk7CiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBwIG9mIHBlYWtzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNwID0gbmV3IFRIUkVFLk1lc2goY3BHZW8sIHBNYXQpOwogICAgICAgICAgICAgICAgICAgICAgICBjcC5wb3NpdGlvbi5zZXQocC54IC0gdFcgLyAyLCBwZWFrSCAvIDIsIHAueiAtIHREIC8gMik7CiAgICAgICAgICAgICAgICAgICAgICAgIGNwLmNhc3RTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBncm91cC5hZGQoY3ApOwoKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3BQbGF0ZSA9IG5ldyBUSFJFRS5NZXNoKGNwUGxhdGVHZW8sIHBNYXQpOwogICAgICAgICAgICAgICAgICAgICAgICBjcFBsYXRlLnBvc2l0aW9uLnNldChwLnggLSB0VyAvIDIsIDAuMDI1LCBwLnogLSB0RCAvIDIpOwogICAgICAgICAgICAgICAgICAgICAgICBjcFBsYXRlLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBncm91cC5hZGQoY3BQbGF0ZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChmb3JjZVJvb2YgfHwgU1RBVEUuc2hvd1Jvb2YpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWdXID0gTWF0aC5tYXgoNDAsIE1hdGguZmxvb3IodFcgKiA0KSk7IGNvbnN0IHNlZ0QgPSBNYXRoLm1heCg0MCwgTWF0aC5mbG9vcih0RCAqIDQpKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCByb29mR2VvID0gbmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkodFcsIHRELCBzZWdXLCBzZWdEKTsgcm9vZkdlby5yb3RhdGVYKC1NYXRoLlBJIC8gMik7IGNvbnN0IHBvcyA9IHJvb2ZHZW8uYXR0cmlidXRlcy5wb3NpdGlvbjsgCiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3MuY291bnQ7IGkrKykgeyBjb25zdCB2eCA9IHBvcy5nZXRYKGkpICsgdFcgLyAyLCB2eiA9IHBvcy5nZXRaKGkpICsgdEQgLyAyOyBsZXQgbUQgPSBJbmZpbml0eTsgcGVha3MuZm9yRWFjaChwID0+IHsgY29uc3QgZHN0ID0gTWF0aC5zcXJ0KCh2eCAtIHAueCkqKjIgKyAodnogLSBwLnopKioyKTsgaWYgKGRzdCA8IG1EKSBtRCA9IGRzdDsgfSk7IGNvbnN0IGRXID0gTWF0aC5taW4odngsIHRXIC0gdngsIHZ6LCB0RCAtIHZ6KTsgcG9zLnNldFkoaSwgd2FsbEggKyAocGVha0ggLSB3YWxsSCkgKiBNYXRoLnBvdyhkVyAvIChkVyArIG1EICsgMC4wMDEpLCBzd29vcCkpOyB9IHJvb2ZHZW8uY29tcHV0ZVZlcnRleE5vcm1hbHMoKTsgCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm9vZiA9IG5ldyBUSFJFRS5NZXNoKHJvb2ZHZW8sIHZpbk1hdCk7IHJvb2YucG9zaXRpb24uc2V0KDAsIDAsIDApOyByb29mLmNhc3RTaGFkb3cgPSB0cnVlOyBncm91cC5hZGQocm9vZik7CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbGVuY2VIZW1NYXQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogMHhjY2NjY2MsIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUgfSk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWRkViA9ICh2dywgcHgsIHB6LCByeSkgPT4geyAKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgdk1hdElubmVyID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4ZmZmZmZmLCBzaWRlOiBUSFJFRS5Gcm9udFNpZGUsIHJvdWdobmVzczogMS4wLCBtZXRhbG5lc3M6IDAuMCB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZNYXRPdXRlciA9IHZNYXRJbm5lcjsgCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJOYW1lID0gIkV2ZW50IFBsYW5uZXIiOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoTU9ERSA9PT0gJ291dHNpZGUnICYmIFNUQVRFLnRlbnQgJiYgdFcgPT09IFNUQVRFLnRlbnQud2lkdGggJiYgdEQgPT09IFNUQVRFLnRlbnQuaGVpZ2h0ICYmICFmb3JjZVJvb2YgJiYgYk5hbWUgJiYgYk5hbWUgIT09ICJFdmVudCBQbGFubmVyIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZDYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsgdkNhbi53aWR0aCA9IDUxMjsgdkNhbi5oZWlnaHQgPSA2NDsgY29uc3QgdkN0eCA9IHZDYW4uZ2V0Q29udGV4dCgnMmQnKTsgdkN0eC5maWxsU3R5bGUgPSAnd2hpdGUnOyB2Q3R4LmZpbGxSZWN0KDAsMCw1MTIsNjQpOyB2Q3R4LmZpbGxTdHlsZSA9ICcjMDAwMDAwJzsgdkN0eC5mb250ID0gJzkwMCBpdGFsaWMgMjRweCBQb3BwaW5zLCBzYW5zLXNlcmlmJzsgdkN0eC50ZXh0QWxpZ24gPSAnY2VudGVyJzsgdkN0eC50ZXh0QmFzZWxpbmUgPSAnbWlkZGxlJzsgdkN0eC5maWxsVGV4dChiTmFtZS50b1VwcGVyQ2FzZSgpLCAyNTYsIDMyKTsgY29uc3QgdlRleCA9IG5ldyBUSFJFRS5DYW52YXNUZXh0dXJlKHZDYW4pOyB2VGV4LndyYXBTID0gVEhSRUUuUmVwZWF0V3JhcHBpbmc7IHZUZXgucmVwZWF0LnNldCh2dyAvIDEwLCAxKTsgdk1hdE91dGVyID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgbWFwOiB2VGV4LCBzaWRlOiBUSFJFRS5Gcm9udFNpZGUsIHJvdWdobmVzczogMS4wIH0pOyAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2SW4gPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuUGxhbmVHZW9tZXRyeSh2dywgMS4wKSwgdk1hdElubmVyKTsgdkluLnBvc2l0aW9uLnNldChweCwgd2FsbEggLSAwLjUsIHB6KTsgdkluLnJvdGF0aW9uLnkgPSByeTsgdkluLmNhc3RTaGFkb3cgPSB0cnVlOyBncm91cC5hZGQodkluKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgdk91dCA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KHZ3LCAxLjApLCB2TWF0T3V0ZXIpOyB2T3V0LnBvc2l0aW9uLnNldChweCwgd2FsbEggLSAwLjUsIHB6KTsgdk91dC5yb3RhdGlvbi55ID0gcnkgKyBNYXRoLlBJOyB2T3V0LmNhc3RTaGFkb3cgPSB0cnVlOyBncm91cC5hZGQodk91dCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlbSA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KHZ3LCAwLjA1KSwgdmFsZW5jZUhlbU1hdCk7IGhlbS5wb3NpdGlvbi5zZXQocHgsIHdhbGxIIC0gMS4wICsgMC4wMjUsIHB6ICsgKHJ5ID09PSAwID8gLTAuMDEgOiAocnkgPT09IE1hdGguUEkgPyAwLjAxIDogMCkpKTsgaWYgKHJ5ID09PSBNYXRoLlBJIC8gMiB8fCByeSA9PT0gLU1hdGguUEkgLyAyKSBoZW0ucG9zaXRpb24ueCArPSAocnkgPT09IE1hdGguUEkgLyAyID8gLTAuMDEgOiAwLjAxKTsgaGVtLnJvdGF0aW9uLnkgPSByeTsgaGVtLnJlY2VpdmVTaGFkb3cgPSB0cnVlOyBncm91cC5hZGQoaGVtKTsKICAgICAgICAgICAgICAgICAgICB9OyAKICAgICAgICAgICAgICAgICAgICBhZGRWKHRXLCAwLCAtdEQvMiAtIDAuMDUsIDApOyBhZGRWKHRXLCAwLCB0RC8yICsgMC4wNSwgTWF0aC5QSSk7IGFkZFYodEQsIC10Vy8yIC0gMC4wNSwgMCwgLU1hdGguUEkgLyAyKTsgYWRkVih0RCwgdFcvMiArIDAuMDUsIDAsIE1hdGguUEkgLyAyKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gZ3JvdXA7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBjb25zdCBjcmVhdGVUcnVzczNEID0gKGxlbmd0aCwgd2lkdGgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gbmV3IFRIUkVFLkdyb3VwKCk7CiAgICAgICAgICAgICAgICBjb25zdCBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweGMwYzBjMCwgbWV0YWxuZXNzOiAwLjgsIHJvdWdobmVzczogMC4yIH0pOwogICAgICAgICAgICAgICAgY29uc3QgaGFsZkwgPSBsZW5ndGggLyAyOyBjb25zdCBoYWxmVyA9IHdpZHRoIC8gMjsgY29uc3QgcmFkaXVzID0gMC4wNDsgCiAgICAgICAgICAgICAgICBjb25zdCBjaG9yZEdlbyA9IG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KHJhZGl1cywgcmFkaXVzLCBsZW5ndGgsIDgpOyBjaG9yZEdlby5yb3RhdGVaKE1hdGguUEkgLyAyKTsKICAgICAgICAgICAgICAgIFtbMCwgaGFsZlcsIC1oYWxmV10sIFswLCBoYWxmVywgaGFsZlddLCBbMCwgLWhhbGZXLCAtaGFsZlddLCBbMCwgLWhhbGZXLCBoYWxmV11dLmZvckVhY2goKFt4LCB5LCB6XSkgPT4geyBjb25zdCBjID0gbmV3IFRIUkVFLk1lc2goY2hvcmRHZW8sIG1hdGVyaWFsKTsgYy5wb3NpdGlvbi5zZXQoeCwgeSwgeik7IGMuY2FzdFNoYWRvdyA9IHRydWU7IGdyb3VwLmFkZChjKTsgfSk7CiAgICAgICAgICAgICAgICBjb25zdCBzZWdtZW50TGVuZ3RoID0gMjsgY29uc3QgbnVtU2VnbWVudHMgPSBNYXRoLmZsb29yKGxlbmd0aCAvIHNlZ21lbnRMZW5ndGgpOyBjb25zdCBicmFjZVJhZGl1cyA9IDAuMDI7CiAgICAgICAgICAgICAgICBjb25zdCBjcmVhdGVCcmFjZSA9IChwMSwgcDIpID0+IHsgY29uc3QgZGlzdCA9IHAxLmRpc3RhbmNlVG8ocDIpOyBjb25zdCBtZXNoID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkoYnJhY2VSYWRpdXMsIGJyYWNlUmFkaXVzLCBkaXN0LCA2KSwgbWF0ZXJpYWwpOyBtZXNoLnBvc2l0aW9uLmNvcHkocDEpLmxlcnAocDIsIDAuNSk7IG1lc2gubG9va0F0KHAyKTsgbWVzaC5yb3RhdGVYKE1hdGguUEkvMik7IG1lc2guY2FzdFNoYWRvdyA9IHRydWU7IGdyb3VwLmFkZChtZXNoKTsgfTsKICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtU2VnbWVudHM7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHhTdGFydCA9IC1oYWxmTCArIGkgKiBzZWdtZW50TGVuZ3RoOyBjb25zdCB4RW5kID0geFN0YXJ0ICsgc2VnbWVudExlbmd0aDsKICAgICAgICAgICAgICAgICAgICBjcmVhdGVCcmFjZShuZXcgVEhSRUUuVmVjdG9yMyh4U3RhcnQsIGhhbGZXLCAtaGFsZlcpLCBuZXcgVEhSRUUuVmVjdG9yMyh4RW5kLCBoYWxmVywgaGFsZlcpKTsgY3JlYXRlQnJhY2UobmV3IFRIUkVFLlZlY3RvcjMoeEVuZCwgaGFsZlcsIC1oYWxmVyksIG5ldyBUSFJFRS5WZWN0b3IzKHhTdGFydCwgaGFsZlcsIGhhbGZXKSk7CiAgICAgICAgICAgICAgICAgICAgY3JlYXRlQnJhY2UobmV3IFRIUkVFLlZlY3RvcjMoeFN0YXJ0LCAtaGFsZlcsIC1oYWxmVyksIG5ldyBUSFJFRS5WZWN0b3IzKHhFbmQsIC1oYWxmVywgaGFsZlcpKTsgY3JlYXRlQnJhY2UobmV3IFRIUkVFLlZlY3RvcjMoeEVuZCwgLWhhbGZXLCAtaGFsZlcpLCBuZXcgVEhSRUUuVmVjdG9yMyh4U3RhcnQsIC1oYWxmVywgaGFsZlcpKTsKICAgICAgICAgICAgICAgICAgICBjcmVhdGVCcmFjZShuZXcgVEhSRUUuVmVjdG9yMyh4U3RhcnQsIC1oYWxmVywgaGFsZlcpLCBuZXcgVEhSRUUuVmVjdG9yMyh4RW5kLCBoYWxmVywgaGFsZlcpKTsgY3JlYXRlQnJhY2UobmV3IFRIUkVFLlZlY3RvcjMoeEVuZCwgLWhhbGZXLCBoYWxmVyksIG5ldyBUSFJFRS5WZWN0b3IzKHhTdGFydCwgaGFsZlcsIGhhbGZXKSk7CiAgICAgICAgICAgICAgICAgICAgY3JlYXRlQnJhY2UobmV3IFRIUkVFLlZlY3RvcjMoeFN0YXJ0LCAtaGFsZlcsIC1oYWxmVyksIG5ldyBUSFJFRS5WZWN0b3IzKHhFbmQsIGhhbGZXLCAtaGFsZlcpKTsgY3JlYXRlQnJhY2UobmV3IFRIUkVFLlZlY3RvcjMoeEVuZCwgLWhhbGZXLCAtaGFsZlcpLCBuZXcgVEhSRUUuVmVjdG9yMyh4U3RhcnQsIGhhbGZXLCAtaGFsZlcpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBncm91cDsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZVRydXNzVG90ZW0zRCA9IChiYXNlU2l6ZSkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgZ3JvdXAgPSBuZXcgVEhSRUUuR3JvdXAoKTsKICAgICAgICAgICAgICAgIGNvbnN0IG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4YzBjMGMwLCBtZXRhbG5lc3M6IDAuOCwgcm91Z2huZXNzOiAwLjIgfSk7CiAgICAgICAgICAgICAgICBjb25zdCBwbGF0ZU1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4NDc1NTY5LCBtZXRhbG5lc3M6IDAuNSwgcm91Z2huZXNzOiAwLjcgfSk7CiAgICAgICAgICAgICAgICBjb25zdCBwbGF0ZUdlbyA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeShiYXNlU2l6ZSwgMC4wNSwgYmFzZVNpemUpOwogICAgICAgICAgICAgICAgY29uc3QgcGxhdGUgPSBuZXcgVEhSRUUuTWVzaChwbGF0ZUdlbywgcGxhdGVNYXRlcmlhbCk7IHBsYXRlLnBvc2l0aW9uLnkgPSAwLjAyNTsgcGxhdGUuY2FzdFNoYWRvdyA9IHRydWU7IGdyb3VwLmFkZChwbGF0ZSk7CiAgICAgICAgICAgICAgICBjb25zdCBoZWlnaHQgPSA4OyBjb25zdCB0cnVzc1dpZHRoID0gMS4wOyBjb25zdCBoYWxmVyA9IHRydXNzV2lkdGggLyAyOyBjb25zdCByYWRpdXMgPSAwLjA0OwogICAgICAgICAgICAgICAgY29uc3QgY2hvcmRHZW8gPSBuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeShyYWRpdXMsIHJhZGl1cywgaGVpZ2h0LCA4KTsKICAgICAgICAgICAgICAgIFtbaGFsZlcsIC1oYWxmV10sIFtoYWxmVywgaGFsZlddLCBbLWhhbGZXLCAtaGFsZlddLCBbLWhhbGZXLCBoYWxmV11dLmZvckVhY2goKFt4LCB6XSkgPT4geyBjb25zdCBjID0gbmV3IFRIUkVFLk1lc2goY2hvcmRHZW8sIG1hdGVyaWFsKTsgYy5wb3NpdGlvbi5zZXQoeCwgaGVpZ2h0IC8gMiArIDAuMDUsIHopOyBjLmNhc3RTaGFkb3cgPSB0cnVlOyBncm91cC5hZGQoYyk7IH0pOwogICAgICAgICAgICAgICAgY29uc3QgdG9wUGxhdGVHZW8gPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoMS4yLCAwLjA1LCAxLjIpOyBjb25zdCB0b3BQbGF0ZSA9IG5ldyBUSFJFRS5NZXNoKHRvcFBsYXRlR2VvLCBwbGF0ZU1hdGVyaWFsKTsgdG9wUGxhdGUucG9zaXRpb24ueSA9IGhlaWdodCArIDAuMDU7IGdyb3VwLmFkZCh0b3BQbGF0ZSk7CiAgICAgICAgICAgICAgICBjb25zdCBzZWdtZW50SGVpZ2h0ID0gMjsgY29uc3QgbnVtU2VnbWVudHMgPSBNYXRoLmZsb29yKGhlaWdodCAvIHNlZ21lbnRIZWlnaHQpOyBjb25zdCBicmFjZVJhZGl1cyA9IDAuMDI7CiAgICAgICAgICAgICAgICBjb25zdCBjcmVhdGVCcmFjZSA9IChwMSwgcDIpID0+IHsgY29uc3QgZGlzdCA9IHAxLmRpc3RhbmNlVG8ocDIpOyBjb25zdCBtZXNoID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkoYnJhY2VSYWRpdXMsIGJyYWNlUmFkaXVzLCBkaXN0LCA2KSwgbWF0ZXJpYWwpOyBtZXNoLnBvc2l0aW9uLmNvcHkocDEpLmxlcnAocDIsIDAuNSk7IG1lc2gubG9va0F0KHAyKTsgbWVzaC5yb3RhdGVYKE1hdGguUEkvMik7IG1lc2guY2FzdFNoYWRvdyA9IHRydWU7IGdyb3VwLmFkZChtZXNoKTsgfTsKICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtU2VnbWVudHM7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHlTdGFydCA9IGkgKiBzZWdtZW50SGVpZ2h0ICsgMC4wNTsgY29uc3QgeUVuZCA9IHlTdGFydCArIHNlZ21lbnRIZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgY3JlYXRlQnJhY2UobmV3IFRIUkVFLlZlY3RvcjMoLWhhbGZXLCB5U3RhcnQsIGhhbGZXKSwgbmV3IFRIUkVFLlZlY3RvcjMoaGFsZlcsIHlFbmQsIGhhbGZXKSk7IGNyZWF0ZUJyYWNlKG5ldyBUSFJFRS5WZWN0b3IzKGhhbGZXLCB5U3RhcnQsIGhhbGZXKSwgbmV3IFRIUkVFLlZlY3RvcjMoLWhhbGZXLCB5RW5kLCBoYWxmVykpOwogICAgICAgICAgICAgICAgICAgIGNyZWF0ZUJyYWNlKG5ldyBUSFJFRS5WZWN0b3IzKC1oYWxmVywgeVN0YXJ0LCAtaGFsZlcpLCBuZXcgVEhSRUUuVmVjdG9yMyhoYWxmVywgeUVuZCwgLWhhbGZXKSk7IGNyZWF0ZUJyYWNlKG5ldyBUSFJFRS5WZWN0b3IzKGhhbGZXLCB5U3RhcnQsIC1oYWxmVyksIG5ldyBUSFJFRS5WZWN0b3IzKC1oYWxmVywgeUVuZCwgLWhhbGZXKSk7CiAgICAgICAgICAgICAgICAgICAgY3JlYXRlQnJhY2UobmV3IFRIUkVFLlZlY3RvcjMoLWhhbGZXLCB5U3RhcnQsIC1oYWxmVyksIG5ldyBUSFJFRS5WZWN0b3IzKC1oYWxmVywgeUVuZCwgLWhhbGZXKSk7IGNyZWF0ZUJyYWNlKG5ldyBUSFJFRS5WZWN0b3IzKC1oYWxmVywgeVN0YXJ0LCBoYWxmVyksIG5ldyBUSFJFRS5WZWN0b3IzKC1oYWxmVywgeUVuZCwgLWhhbGZXKSk7CiAgICAgICAgICAgICAgICAgICAgY3JlYXRlQnJhY2UobmV3IFRIUkVFLlZlY3RvcjMoaGFsZlcsIHlTdGFydCwgLWhhbGZXKSwgbmV3IFRIUkVFLlZlY3RvcjMoaGFsZlcsIHlFbmQsIGhhbGZXKSk7IGNyZWF0ZUJyYWNlKG5ldyBUSFJFRS5WZWN0b3IzKGhhbGZXLCB5U3RhcnQsIGhhbGZXKSwgbmV3IFRIUkVFLlZlY3RvcjMoaGFsZlcsIHlFbmQsIC1oYWxmVykpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGdyb3VwOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgY29uc3QgY3JlYXRlTW9kZXJuTG91bmdlM0QgPSAobmFtZSwgdywgaCwgY29sb3IpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gbmV3IFRIUkVFLkdyb3VwKCk7CiAgICAgICAgICAgICAgICBjb25zdCBiYXNlSGV4ID0gY29sb3IgfHwgIiMxMTExMTEiOwogICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gU3RyaW5nKG5hbWUgfHwgJycpOwoKICAgICAgICAgICAgICAgIC8vIFByZWZlciBHTEIgaWYgbG9hZGVkLCBvdGhlcndpc2UgZmFsbCBiYWNrIHRvIHRoZSBwcm9jZWR1cmFsIHBsYWNlaG9sZGVyLgogICAgICAgICAgICAgICAgY29uc3QgZ2xiUHJvdG8gPSBmdXJuaXR1cmVHbGJQcm90b0J5S2V5W2tleV07CiAgICAgICAgICAgICAgICBpZiAoZ2xiUHJvdG8pIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnN0ID0gZ2xiUHJvdG8uY2xvbmUodHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgaW5zdC50cmF2ZXJzZShuID0+IHsgaWYgKG4gJiYgbi5pc01lc2gpIHsgbi5jYXN0U2hhZG93ID0gdHJ1ZTsgbi5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsgfSB9KTsKICAgICAgICAgICAgICAgICAgICBncm91cC5hZGQoaW5zdCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdyb3VwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZW5zdXJlRnVybml0dXJlR2xiTG9hZGVkKGtleSk7CiAgICAgICAgICAgICAgICBpZiAobmFtZS5pbmNsdWRlcygnY3ViZS1sZWQnKSkgeyBjb25zdCBjdWJlR2VvID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KHcsIHcsIHcpOyBjb25zdCBjdWJlTWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IG5ldyBUSFJFRS5Db2xvcihiYXNlSGV4KSwgZW1pc3NpdmU6IG5ldyBUSFJFRS5Db2xvcihiYXNlSGV4KSwgZW1pc3NpdmVJbnRlbnNpdHk6IDAuNSwgcm91Z2huZXNzOiAwLjEsIG1ldGFsbmVzczogMC4xLCB0cmFuc3BhcmVudDogdHJ1ZSwgb3BhY2l0eTogMC45IH0pOyBjb25zdCBjdWJlID0gbmV3IFRIUkVFLk1lc2goY3ViZUdlbywgY3ViZU1hdCk7IGN1YmUucG9zaXRpb24ueSA9IHcvMjsgZ3JvdXAuYWRkKGN1YmUpOyByZXR1cm4gZ3JvdXA7IH0KICAgICAgICAgICAgICAgIGlmIChuYW1lLmluY2x1ZGVzKCdjb2ZmZWUtbGVkJykpIHsgY29uc3QgdGFibGVHZW8gPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkodywgMS4yLCBoKTsgY29uc3QgdGFibGVNYXQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogbmV3IFRIUkVFLkNvbG9yKGJhc2VIZXgpLCBlbWlzc2l2ZTogbmV3IFRIUkVFLkNvbG9yKGJhc2VIZXgpLCBlbWlzc2l2ZUludGVuc2l0eTogMC4zLCByb3VnaG5lc3M6IDAuMiB9KTsgY29uc3QgdGFibGUgPSBuZXcgVEhSRUUuTWVzaCh0YWJsZUdlbywgdGFibGVNYXQpOyB0YWJsZS5wb3NpdGlvbi55ID0gMC42OyBncm91cC5hZGQodGFibGUpOyByZXR1cm4gZ3JvdXA7IH0KICAgICAgICAgICAgICAgIGlmIChuYW1lLmluY2x1ZGVzKCdjb2ZmZWUtaW5maW5pdHknKSkgeyBjb25zdCBmcmFtZU1hdCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweDExMTExMSwgcm91Z2huZXNzOiAwLjIsIG1ldGFsbmVzczogMC44IH0pOyBjb25zdCBsZWdHZW8gPSBuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeSgwLjEsIDAuMDUsIDEuNSwgOCk7IFtbMSwxXSwgWy0xLDFdLCBbMCwtMV1dLmZvckVhY2goKFtzeCwgc3pdKSA9PiB7IGNvbnN0IGxlZyA9IG5ldyBUSFJFRS5NZXNoKGxlZ0dlbywgZnJhbWVNYXQpOyBsZWcucG9zaXRpb24uc2V0KHN4ICogKHcvMyksIDAuNzUsIHN6ICogKHcvMykpOyBncm91cC5hZGQobGVnKTsgfSk7IGNvbnN0IHJpbmcgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeSh3LzIsIHcvMiwgMC4yLCAzMiksIGZyYW1lTWF0KTsgcmluZy5wb3NpdGlvbi55ID0gMS42OyBncm91cC5hZGQocmluZyk7IGNvbnN0IGxlZFRleENhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOyBsZWRUZXhDYW4ud2lkdGggPSA2NDsgbGVkVGV4Q2FuLmhlaWdodCA9IDY0OyBjb25zdCBsZWRDdHggPSBsZWRUZXhDYW4uZ2V0Q29udGV4dCgnMmQnKTsgY29uc3QgZ3JhZCA9IGxlZEN0eC5jcmVhdGVSYWRpYWxHcmFkaWVudCgzMiwgMzIsIDAsIDMyLCAzMiwgMzIpOyBncmFkLmFkZENvbG9yU3RvcCgwLCAncmVkJyk7IGdyYWQuYWRkQ29sb3JTdG9wKDEsICdibHVlJyk7IGxlZEN0eC5maWxsU3R5bGUgPSBncmFkOyBsZWRDdHguZmlsbFJlY3QoMCwwLDY0LDY0KTsgY29uc3QgbGVkVGV4ID0gbmV3IFRIUkVFLkNhbnZhc1RleHR1cmUobGVkVGV4Q2FuKTsgY29uc3QgZGlzYyA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5DaXJjbGVHZW9tZXRyeSh3LzIgLSAwLjEsIDMyKSwgbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgbWFwOiBsZWRUZXgsIGVtaXNzaXZlOiBuZXcgVEhSRUUuQ29sb3IoYmFzZUhleCksIGVtaXNzaXZlSW50ZW5zaXR5OiAwLjUgfSkpOyBkaXNjLnJvdGF0aW9uLnggPSAtTWF0aC5QSS8yOyBkaXNjLnBvc2l0aW9uLnkgPSAxLjcxOyBncm91cC5hZGQoZGlzYyk7IHJldHVybiBncm91cDsgfQogICAgICAgICAgICAgICAgY29uc3QgbGVhdGhlck1hdCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiBuZXcgVEhSRUUuQ29sb3IoYmFzZUhleCksIHJvdWdobmVzczogMC44LCBtZXRhbG5lc3M6IDAuMSB9KTsgY29uc3QgbWV0YWxNYXQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogMHhjY2NjY2MsIG1ldGFsbmVzczogMS4wLCByb3VnaG5lc3M6IDAuMSB9KTsgY29uc3QgZnJhbWVIZWlnaHQgPSAwLjQ7IGNvbnN0IHJhaWxHZW8gPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkodyArIDAuMSwgMC4wNSwgaCArIDAuMSk7IGNvbnN0IHJhaWwgPSBuZXcgVEhSRUUuTWVzaChyYWlsR2VvLCBtZXRhbE1hdCk7IHJhaWwucG9zaXRpb24ueSA9IGZyYW1lSGVpZ2h0OyBncm91cC5hZGQocmFpbCk7IGNvbnN0IGxlZ0dlbyA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSgwLjEsIGZyYW1lSGVpZ2h0LCAwLjEpOyBbWy0xLC0xXSwgWzEsLTFdLCBbLTEsMV0sIFsxLDFdXS5mb3JFYWNoKChbc3gsIHN6XSkgPT4geyBjb25zdCBsZWcgPSBuZXcgVEhSRUUuTWVzaChsZWdHZW8sIG1ldGFsTWF0KTsgbGVnLnBvc2l0aW9uLnNldChzeCAqICh3LzIpLCBmcmFtZUhlaWdodC8yLCBzeiAqIChoLzIpKTsgZ3JvdXAuYWRkKGxlZyk7IH0pOyAKICAgICAgICAgICAgICAgIGNvbnN0IHNlYXRIID0gbmFtZS5pbmNsdWRlcygnY2x1Yi1jaGFpcicpID8gMS40IDogMS4xOyBjb25zdCBjdXNoaW9uR2VvID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KHcsIHNlYXRILCBoKTsgY29uc3QgY3VzaGlvbiA9IG5ldyBUSFJFRS5NZXNoKGN1c2hpb25HZW8sIGxlYXRoZXJNYXQpOyBjdXNoaW9uLnBvc2l0aW9uLnkgPSBmcmFtZUhlaWdodCArIHNlYXRILzI7IGdyb3VwLmFkZChjdXNoaW9uKTsKICAgICAgICAgICAgICAgIGNvbnN0IGFkZEJ1dHRvbnMgPSAocGFyZW50LCBidywgYmgsIGRlcHRoLCBncmlkVywgZ3JpZEgsIG9yaWVudCkgPT4geyBjb25zdCBidG5HZW8gPSBuZXcgVEhSRUUuU3BoZXJlR2VvbWV0cnkoMC4wNiwgMTIsIDEyKTsgZm9yKGxldCBpPTA7IGk8Z3JpZFc7IGkrKykgeyBmb3IobGV0IGo9MDsgajxncmlkSDsgaisrKSB7IGNvbnN0IGJ0biA9IG5ldyBUSFJFRS5NZXNoKGJ0bkdlbywgbGVhdGhlck1hdCk7IGNvbnN0IG94ID0gKGkgKyAwLjUpICogKGJ3IC8gZ3JpZFcpIC0gKGJ3IC8gMik7IGNvbnN0IG95ID0gKGogKyAwLjUpICogKGJoIC8gZ3JpZEgpIC0gKGJoIC8gMik7IGlmKG9yaWVudCA9PT0gJ3knKSBidG4ucG9zaXRpb24uc2V0KG94LCBkZXB0aC8yLCBveSk7IGVsc2UgaWYob3JpZW50ID09PSAneicpIGJ0bi5wb3NpdGlvbi5zZXQob3gsIG95LCBkZXB0aC8yKTsgZWxzZSBpZihvcmllbnQgPT09ICd4JykgYnRuLnBvc2l0aW9uLnNldChkZXB0aC8yLCBveSwgb3gpOyBwYXJlbnQuYWRkKGJ0bik7IH0gfSB9OwogICAgICAgICAgICAgICAgaWYgKCFuYW1lLmluY2x1ZGVzKCdlbmQtdGFibGUnKSkgYWRkQnV0dG9ucyhjdXNoaW9uLCB3LCBoLCBzZWF0SCwgbmFtZS5pbmNsdWRlcygnbG92ZXNlYXQnKSA/IDYgOiA0LCA0LCAneScpOwogICAgICAgICAgICAgICAgaWYobmFtZS5pbmNsdWRlcygnYXJtbGVzcycpIHx8IG5hbWUuaW5jbHVkZXMoJ2Nvcm5lcicpIHx8IG5hbWUuaW5jbHVkZXMoJ2xvdmVzZWF0JykgfHwgbmFtZS5pbmNsdWRlcygnY2x1Yi1jaGFpcicpKSB7IAogICAgICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tIZWlnaHQgPSBuYW1lLmluY2x1ZGVzKCdsb3Zlc2VhdCcpID8gMi41IDogMC44OyBjb25zdCBiYWNrRGVwdGggPSAwLjY7IGNvbnN0IGJhY2tHZW8gPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkodywgYmFja0hlaWdodCwgYmFja0RlcHRoKTsgY29uc3QgYmFjayA9IG5ldyBUSFJFRS5NZXNoKGJhY2tHZW8sIGxlYXRoZXJNYXQpOyBiYWNrLnBvc2l0aW9uLnNldCgwLCBmcmFtZUhlaWdodCArIHNlYXRIICsgYmFja0hlaWdodC8yLCAtaC8yICsgYmFja0RlcHRoLzIpOyBncm91cC5hZGQoYmFjayk7IGFkZEJ1dHRvbnMoYmFjaywgdywgYmFja0hlaWdodCwgYmFja0RlcHRoLCBuYW1lLmluY2x1ZGVzKCdsb3Zlc2VhdCcpID8gNiA6IDQsIDIsICd6Jyk7IAogICAgICAgICAgICAgICAgICAgIGlmKG5hbWUuaW5jbHVkZXMoJ2Nvcm5lcicpIHx8IG5hbWUuaW5jbHVkZXMoJ2NsdWItY2hhaXInKSkgeyAKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2lkZUJhY2sgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQm94R2VvbWV0cnkoYmFja0RlcHRoLCBiYWNrSGVpZ2h0LCBoKSwgbGVhdGhlck1hdCk7IHNpZGVCYWNrLnBvc2l0aW9uLnNldCh3LzIgLSBiYWNrRGVwdGgvMiwgZnJhbWVIZWlnaHQgKyBzZWF0SCArIGJhY2tIZWlnaHQvMiwgMCk7IGdyb3VwLmFkZChzaWRlQmFjayk7IGFkZEJ1dHRvbnMoc2lkZUJhY2ssIGgsIGJhY2tIZWlnaHQsIGJhY2tEZXB0aCwgNCwgMiwgJ3gnKTsgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lLmluY2x1ZGVzKCdjbHViLWNoYWlyJykpIHsgY29uc3QgbGVmdEFybSA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5Cb3hHZW9tZXRyeShiYWNrRGVwdGgsIGJhY2tIZWlnaHQsIGgpLCBsZWF0aGVyTWF0KTsgbGVmdEFybS5wb3NpdGlvbi5zZXQoLXcvMiArIGJhY2tEZXB0aC8yLCBmcmFtZUhlaWdodCArIHNlYXRIICsgYmFja0hlaWdodC8yLCAwKTsgZ3JvdXAuYWRkKGxlZnRBcm0pOyBhZGRCdXR0b25zKGxlZnRBcm0sIGgsIGJhY2tIZWlnaHQsIGJhY2tEZXB0aCwgNCwgMiwgJ3gnKTsgfSAKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIHJldHVybiBncm91cDsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZVBlcnNvbjNEID0gKG5hbWUsIHcsIGQsIGNvbG9yKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBncm91cCA9IG5ldyBUSFJFRS5Hcm91cCgpOwogICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gU3RyaW5nKG5hbWUgfHwgJycpOwogICAgICAgICAgICAgICAgZ3JvdXAudXNlckRhdGEuaXNQZXJzb24gPSB0cnVlOwogICAgICAgICAgICAgICAgZ3JvdXAudXNlckRhdGEucGVyc29uS2V5ID0ga2V5OwoKICAgICAgICAgICAgICAgIGNvbnN0IGdsYlByb3RvID0gcGVvcGxlR2xiUHJvdG9CeUtleVtrZXldOwogICAgICAgICAgICAgICAgaWYgKGdsYlByb3RvKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5zdCA9IGdsYlByb3RvLmNsb25lKHRydWUpOwogICAgICAgICAgICAgICAgICAgIGluc3QudHJhdmVyc2UobiA9PiB7IGlmIChuICYmIG4uaXNNZXNoKSB7IG4uY2FzdFNoYWRvdyA9IHRydWU7IG4ucmVjZWl2ZVNoYWRvdyA9IHRydWU7IH0gfSk7CiAgICAgICAgICAgICAgICAgICAgZ3JvdXAuYWRkKGluc3QpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBncm91cDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBLaWNrIG9mZiBsb2FkIChvbmx5IGlmIHRoaXMga2V5IGhhcyBhIEdMQikKICAgICAgICAgICAgICAgIGVuc3VyZVBlb3BsZUdsYkxvYWRlZChrZXkpOwoKICAgICAgICAgICAgICAgIC8vIEJhc2ljIHBsYWNlaG9sZGVyIHBlcnNvbgogICAgICAgICAgICAgICAgY29uc3QgYmFzZVIgPSBNYXRoLm1heCgwLjI1LCBNYXRoLm1pbih3LCBkKSAqIDAuMTgpOwogICAgICAgICAgICAgICAgY29uc3QgbWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IG5ldyBUSFJFRS5Db2xvcihjb2xvciB8fCAnIzhiNWNmNicpLCByb3VnaG5lc3M6IDAuNzUsIG1ldGFsbmVzczogMC4wIH0pOwogICAgICAgICAgICAgICAgY29uc3QgYm9keUggPSA0LjI7CiAgICAgICAgICAgICAgICBjb25zdCBib2R5ID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkoYmFzZVIsIGJhc2VSICogMS4wNSwgYm9keUgsIDE4KSwgbWF0KTsKICAgICAgICAgICAgICAgIGJvZHkucG9zaXRpb24ueSA9IGJvZHlIIC8gMjsKICAgICAgICAgICAgICAgIGdyb3VwLmFkZChib2R5KTsKICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRSID0gYmFzZVIgKiAxLjE7CiAgICAgICAgICAgICAgICBjb25zdCBoZWFkID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KGhlYWRSLCAxOCwgMTgpLCBtYXQpOwogICAgICAgICAgICAgICAgaGVhZC5wb3NpdGlvbi55ID0gYm9keUggKyBoZWFkUiAqIDEuMDU7CiAgICAgICAgICAgICAgICBncm91cC5hZGQoaGVhZCk7CiAgICAgICAgICAgICAgICBjb25zdCBmZWV0ID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkoYmFzZVIgKiAxLjEsIGJhc2VSICogMS4xLCAwLjA4LCAxOCksIG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweDFiMWIxYiwgcm91Z2huZXNzOiAwLjksIG1ldGFsbmVzczogMC4wIH0pKTsKICAgICAgICAgICAgICAgIGZlZXQucG9zaXRpb24ueSA9IDAuMDQ7CiAgICAgICAgICAgICAgICBncm91cC5hZGQoZmVldCk7CgogICAgICAgICAgICAgICAgLy8gU2NhbGUgcGxhY2Vob2xkZXIgdG8gdGFyZ2V0IGhlaWdodAogICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0SCA9IFBFT1BMRV9HTEJfVEFSR0VUX0hFSUdIVF9GVFtrZXldIHx8IDYuMDsKICAgICAgICAgICAgICAgIGNvbnN0IGJveCA9IG5ldyBUSFJFRS5Cb3gzKCkuc2V0RnJvbU9iamVjdChncm91cCk7CiAgICAgICAgICAgICAgICBjb25zdCBzaXplID0gbmV3IFRIUkVFLlZlY3RvcjMoKTsKICAgICAgICAgICAgICAgIGJveC5nZXRTaXplKHNpemUpOwogICAgICAgICAgICAgICAgaWYgKHNpemUueSAmJiBzaXplLnkgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2MgPSB0YXJnZXRIIC8gc2l6ZS55OwogICAgICAgICAgICAgICAgICAgIGdyb3VwLnNjYWxlLnNldFNjYWxhcihzYyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zdCBib3gyID0gbmV3IFRIUkVFLkJveDMoKS5zZXRGcm9tT2JqZWN0KGdyb3VwKTsKICAgICAgICAgICAgICAgIGlmIChib3gyLm1pbi55ICE9PSAwKSBncm91cC5wb3NpdGlvbi55IC09IGJveDIubWluLnk7CgogICAgICAgICAgICAgICAgcmV0dXJuIGdyb3VwOwogICAgICAgICAgICB9OwoKY29uc3QgY3JlYXRlUGxlYXRlZFNraXJ0ID0gKHcsIGQsIGgsIGNvbG9yKSA9PiB7CiAgY29uc3QgZ3JvdXAgPSBuZXcgVEhSRUUuR3JvdXAoKTsKICBjb25zdCBtYXQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvciwgc2lkZTogVEhSRUUuRG91YmxlU2lkZSwgcm91Z2huZXNzOiAxLjAsIG1ldGFsbmVzczogMC4wIH0pOwoKICAvLyBLZWVwIGdlb21ldHJ5IG1vc3RseSBmbGF0ICh0ZXh0dXJlL2xpZ2h0aW5nIGRvZXMgdGhlIGhlYXZ5IGxpZnRpbmcpLiBBbHNvIHB1c2ggb3V0d2FyZCBzbyBsZWdzIGRvbid0IHBlZWsgdGhyb3VnaC4KICBjb25zdCBPVVQgPSAwLjA4OyAvLyB+MSIKICBjb25zdCBBTVAgPSAwLjAyOyAvLyB2ZXJ5IHN1YnRsZSByaXBwbGUKICBjb25zdCBGUkVRID0gMS4wOwoKICBjb25zdCBjcmVhdGVXYWxsID0gKHdpZHRoLCBweCwgcHosIHJ5KSA9PiB7CiAgICBjb25zdCBzZWdzID0gTWF0aC5tYXgoOCwgTWF0aC5mbG9vcih3aWR0aCAqIDIpKTsKICAgIGNvbnN0IGdlbyA9IG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KHdpZHRoLCBoLCBzZWdzLCAxKTsKICAgIGNvbnN0IHBvcyA9IGdlby5hdHRyaWJ1dGVzLnBvc2l0aW9uOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gc2VnczsgaSsrKSB7CiAgICAgIGNvbnN0IG9mZiA9IE1hdGguc2luKGkgKiBGUkVRKSAqIEFNUDsKICAgICAgcG9zLnNldFooaSwgb2ZmKTsKICAgICAgcG9zLnNldFooaSArIHNlZ3MgKyAxLCBvZmYpOwogICAgfQogICAgZ2VvLmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7CiAgICBjb25zdCB3YWxsID0gbmV3IFRIUkVFLk1lc2goZ2VvLCBtYXQpOwogICAgd2FsbC5wb3NpdGlvbi5zZXQocHgsIGggLyAyLCBweik7CiAgICB3YWxsLnJvdGF0aW9uLnkgPSByeTsKICAgIHdhbGwuY2FzdFNoYWRvdyA9IHRydWU7CiAgICB3YWxsLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgZ3JvdXAuYWRkKHdhbGwpOwogIH07CgogIGNyZWF0ZVdhbGwodywgMCwgZCAvIDIgKyBPVVQsIDApOwogIGNyZWF0ZVdhbGwodywgMCwgLWQgLyAyIC0gT1VULCBNYXRoLlBJKTsKICBjcmVhdGVXYWxsKGQsIC13IC8gMiAtIE9VVCwgMCwgLU1hdGguUEkgLyAyKTsKICBjcmVhdGVXYWxsKGQsIHcgLyAyICsgT1VULCAwLCBNYXRoLlBJIC8gMik7CgogIHJldHVybiBncm91cDsKfTsKCiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZURyYXBlTW9kdWxlID0gKHBvaW50cywgc2VnbWVudEhlaWdodHMsIGNvbG9yKSA9PiB7CiAgICAgICAgICAgICAgY29uc3QgZHJhcGVHcm91cCA9IG5ldyBUSFJFRS5Hcm91cCgpOwogICAgICAgICAgICAgIGNvbnN0IHBpcGVNYXQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogMHg5NGEzYjgsIG1ldGFsbmVzczogMC44LCByb3VnaG5lc3M6IDAuMiB9KTsKICAgICAgICAgICAgICBjb25zdCBmYWJyaWNNYXQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvciwgc2lkZTogVEhSRUUuRG91YmxlU2lkZSwgcm91Z2huZXNzOiAxLjAsIG1ldGFsbmVzczogMC4wIH0pOwogICAgICAgICAgICAgIHBvaW50cy5mb3JFYWNoKChwLCBpKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgaFZhbCA9IDg7CiAgICAgICAgICAgICAgICBpZiAoaSA9PT0gMCkgaFZhbCA9IHBhcnNlSW50KHNlZ21lbnRIZWlnaHRzWzBdIHx8ICc4ZnQnKTsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKGkgPT09IHBvaW50cy5sZW5ndGggLSAxKSBoVmFsID0gcGFyc2VJbnQoc2VnbWVudEhlaWdodHNbc2VnbWVudEhlaWdodHMubGVuZ3RoIC0gMV0gfHwgJzhmdCcpOwogICAgICAgICAgICAgICAgZWxzZSBoVmFsID0gTWF0aC5tYXgocGFyc2VJbnQoc2VnbWVudEhlaWdodHNbaS0xXSB8fCAnOGZ0JyksIHBhcnNlSW50KHNlZ21lbnRIZWlnaHRzW2ldIHx8ICc4ZnQnKSk7CiAgICAgICAgICAgICAgICBjb25zdCBiYXNlID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkJveEdlb21ldHJ5KDEuNSwgMC4wNSwgMS41KSwgcGlwZU1hdCk7IGJhc2UucG9zaXRpb24uc2V0KHAueCwgMC4wMjUsIHAueSk7IGRyYXBlR3JvdXAuYWRkKGJhc2UpOwogICAgICAgICAgICAgICAgY29uc3QgdXByaWdodCA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KDAuMSwgMC4xLCBoVmFsLCAxMiksIHBpcGVNYXQpOyB1cHJpZ2h0LnBvc2l0aW9uLnNldChwLngsIGhWYWwgLyAyLCBwLnkpOyBkcmFwZUdyb3VwLmFkZCh1cHJpZ2h0KTsKICAgICAgICAgICAgICAgIGlmIChpID4gMCkgewogICAgICAgICAgICAgICAgICBjb25zdCBwcmV2ID0gcG9pbnRzW2ktMV07IGNvbnN0IHNlZ0ggPSBwYXJzZUludChzZWdtZW50SGVpZ2h0c1tpLTFdIHx8ICc4ZnQnKTsgY29uc3QgZGlzdCA9IE1hdGguc3FydCgocC54IC0gcHJldi54KSoqMiArIChwLnkgLSBwcmV2LnkpKioyKTsKICAgICAgICAgICAgICAgICAgY29uc3QgY3Jvc3NiYXIgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeSgwLjA4LCAwLjA4LCBkaXN0LCAxMiksIHBpcGVNYXQpOyBjcm9zc2Jhci5wb3NpdGlvbi5zZXQoKHAueCArIHByZXYueCkgLyAyLCBzZWdIIC0gMC4xLCAocC55ICsgcHJldi55KSAvIDIpOyBjcm9zc2Jhci5xdWF0ZXJuaW9uLnNldEZyb21Vbml0VmVjdG9ycyhuZXcgVEhSRUUuVmVjdG9yMygwLCAxLCAwKSwgbmV3IFRIUkVFLlZlY3RvcjMocC54IC0gcHJldi54LCAwLCBwLnkgLSBwcmV2LnkpLm5vcm1hbGl6ZSgpKTsgZHJhcGVHcm91cC5hZGQoY3Jvc3NiYXIpOwogICAgICAgICAgICAgICAgICBjb25zdCBzZWdtZW50cyA9IE1hdGgubWF4KDgsIE1hdGguZmxvb3IoZGlzdCAqIDIpKTsgY29uc3QgZmFicmljR2VvID0gbmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkoZGlzdCwgc2VnSCAtIDAuMiwgc2VnbWVudHMsIDEpOwogICAgICAgICAgICAgICAgICBjb25zdCBwb3NBdHRyID0gZmFicmljR2VvLmF0dHJpYnV0ZXMucG9zaXRpb247IGZvciAobGV0IGogPSAwOyBqIDw9IHNlZ21lbnRzOyBqKyspIHsgY29uc3QgcGxlYXQgPSBNYXRoLnNpbihqICogMS4wKSAqIDAuMDI7IHBvc0F0dHIuc2V0WihqLCBwbGVhdCk7IHBvc0F0dHIuc2V0WihqICsgc2VnbWVudHMgKyAxLCBwbGVhdCk7IH0KICAgICAgICAgICAgICAgICAgZmFicmljR2VvLmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7IGNvbnN0IGZhYnJpYyA9IG5ldyBUSFJFRS5NZXNoKGZhYnJpY0dlbywgZmFicmljTWF0KTsgZmFicmljLnBvc2l0aW9uLnNldCgocC54ICsgcHJldi54KSAvIDIsIChzZWdIIC0gMC4yKSAvIDIgKyAwLjEsIChwLnkgKyBwcmV2LnkpIC8gMik7IGZhYnJpYy5xdWF0ZXJuaW9uLnNldEZyb21Vbml0VmVjdG9ycyhuZXcgVEhSRUUuVmVjdG9yMygxLCAwLCAwKSwgbmV3IFRIUkVFLlZlY3RvcjMocC54IC0gcHJldi54LCAwLCBwLnkgLSBwcmV2LnkpLm5vcm1hbGl6ZSgpKTsgZmFicmljLmNhc3RTaGFkb3cgPSB0cnVlOyBmYWJyaWMucmVjZWl2ZVNoYWRvdyA9IHRydWU7IGRyYXBlR3JvdXAuYWRkKGZhYnJpYyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuIGRyYXBlR3JvdXA7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBjb25zdCBjcmVhdGVCaWxqYXhTdGFnZSA9ICh0b3RhbFcsIHRvdGFsRCwgaGVpZ2h0SW5jaGVzLCBza2lydCkgPT4gewogICAgICAgICAgICAgIGNvbnN0IHN0YWdlR3JvdXAgPSBuZXcgVEhSRUUuR3JvdXAoKTsgY29uc3QgaGVpZ2h0RnQgPSBoZWlnaHRJbmNoZXMgLyAxMjsKICAgICAgICAgICAgICBjb25zdCBmcmFtZU1hdCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweGU1ZTdlYiwgbWV0YWxuZXNzOiAwLjQsIHJvdWdobmVzczogMC4zIH0pOwogICAgICAgICAgICAgIGNvbnN0IGZvb3RNYXQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogMHgxMTExMTEsIHJvdWdobmVzczogMC44LCBtZXRhbG5lc3M6IDAuMCB9KTsKICAgICAgICAgICAgICBjb25zdCB0b3BNYXQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogMHgxMTExMTEsIHJvdWdobmVzczogMS4wLCBtZXRhbG5lc3M6IDAuMCB9KTsKICAgICAgICAgICAgICBjb25zdCBwYW5lbFNpemUgPSA0LjA7IGNvbnN0IG5XID0gTWF0aC5jZWlsKHRvdGFsVyAvIHBhbmVsU2l6ZSk7IGNvbnN0IG5EID0gTWF0aC5jZWlsKHRvdGFsRCAvIHBhbmVsU2l6ZSk7CiAgICAgICAgICAgICAgY29uc3QgZGVja1RoaWNrID0gMC4zNTsgY29uc3Qgc1ggPSAtKHRvdGFsVyAvIDIpOyBjb25zdCBzWiA9IC0odG90YWxEIC8gMik7CiAgICAgICAgICAgICAgZm9yIChsZXQgaXcgPSAwOyBpdyA8IG5XOyBpdysrKSBmb3IgKGxldCBpZCA9IDA7IGlkIDwgbkQ7IGlkKyspIHsKICAgICAgICAgICAgICAgICAgY29uc3QgcFggPSBzWCArIChpdyAqIHBhbmVsU2l6ZSkgKyBwYW5lbFNpemUgLyAyOyBjb25zdCBwWiA9IHNaICsgKGlkICogcGFuZWxTaXplKSArIHBhbmVsU2l6ZSAvIDI7CiAgICAgICAgICAgICAgICAgIGNvbnN0IGRlY2sgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQm94R2VvbWV0cnkocGFuZWxTaXplIC0gMC4wNSwgZGVja1RoaWNrLCBwYW5lbFNpemUgLSAwLjA1KSwgdG9wTWF0KTsgZGVjay5wb3NpdGlvbi5zZXQocFgsIGhlaWdodEZ0IC0gZGVja1RoaWNrIC8gMiwgcFopOyBkZWNrLmNhc3RTaGFkb3cgPSB0cnVlOyBkZWNrLnJlY2VpdmVTaGFkb3cgPSB0cnVlOyBzdGFnZUdyb3VwLmFkZChkZWNrKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY29uc3QgbGVnUiA9IDAuMDg7CiAgICAgICAgICAgICAgZm9yIChsZXQgaXcgPSAwOyBpdyA8PSBuVzsgaXcrKykgZm9yIChsZXQgaWQgPSAwOyBpZCA8PSBuRDsgaWQrKykgewogICAgICAgICAgICAgICAgICBjb25zdCBseCA9IHNYICsgKGl3ICogcGFuZWxTaXplKTsgY29uc3QgbHogPSBzWiArIChpZCAqIHBhbmVsU2l6ZSk7CiAgICAgICAgICAgICAgICAgIGNvbnN0IGxlZyA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KGxlZ1IsIGxlZ1IsIGhlaWdodEZ0IC0gZGVja1RoaWNrLCAxMiksIGZyYW1lTWF0KTsgbGVnLnBvc2l0aW9uLnNldChseCwgKGhlaWdodEZ0IC0gZGVja1RoaWNrKSAvIDIsIGx6KTsgc3RhZ2VHcm91cC5hZGQobGVnKTsKICAgICAgICAgICAgICAgICAgY29uc3QgZm9vdCA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSgwLjQsIDAuMDUsIDAuNCksIGZvb3RNYXQpOyBmb290LnBvc2l0aW9uLnNldChseCwgMC4wMjUsIGx6KTsgc3RhZ2VHcm91cC5hZGQoZm9vdCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChza2lydCAhPT0gJ25vbmUnKSB7IGNvbnN0IHNraXJ0QyA9IHNraXJ0ID09PSAnd2hpdGUnID8gMHhmZmZmZmYgOiAweDExMTExMTsgc3RhZ2VHcm91cC5hZGQoY3JlYXRlUGxlYXRlZFNraXJ0KHRvdGFsVyArIDAuMSwgdG90YWxEICsgMC4xLCBoZWlnaHRGdCwgc2tpcnRDKSk7IH0KICAgICAgICAgICAgICByZXR1cm4gc3RhZ2VHcm91cDsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIC8vIC0tLSBTdGFnZSBHdWFyZHJhaWxzICgzRCkgLS0tCiAgICAgICAgICAgIGNvbnN0IFNUQUdFX0dVQVJEUkFJTF9QQU5FTF9GVCA9IDQuMDsKICAgICAgICAgICAgLy8gVHlwaWNhbCBzdGFnZSByYWlsIGhlaWdodCBpcyBhcm91bmQgNDIiICgzLjUgZnQpLiBXZSBjYW4gdHdlYWsgbGF0ZXIgaWYgeW91IHdhbnQgaXQgc2hvcnRlci90YWxsZXIuCiAgICAgICAgICAgIGNvbnN0IFNUQUdFX0dVQVJEUkFJTF9IRUlHSFRfRlQgPSAzLjU7CgogICAgICAgICAgICBjb25zdCBjcmVhdGVTdGFnZUd1YXJkcmFpbHMzRCA9ICh0b3RhbFcsIHRvdGFsRCwgc3RhZ2VUb3BZLCByYWlscykgPT4gewogICAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gbmV3IFRIUkVFLkdyb3VwKCk7CiAgICAgICAgICAgICAgaWYgKCFyYWlscyB8fCByYWlscy5sZW5ndGggPT09IDApIHJldHVybiBncm91cDsKCiAgICAgICAgICAgICAgY29uc3QgcmFpbE1hdCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweGNiZDVlMSwgbWV0YWxuZXNzOiAwLjgsIHJvdWdobmVzczogMC4yMiB9KTsKICAgICAgICAgICAgICBjb25zdCBwb3N0UiA9IDAuMDU1OwogICAgICAgICAgICAgIGNvbnN0IHJhaWxSID0gMC4wNDsKICAgICAgICAgICAgICBjb25zdCBvdXQgPSAwLjA2OyAvLyBzbGlnaHQgb2Zmc2V0IHNvIGl0IGRvZXNuJ3QgWi1maWdodCB3aXRoIHNraXJ0cy9kZWNrcwogICAgICAgICAgICAgIGNvbnN0IHRvcFkgPSBzdGFnZVRvcFkgKyBTVEFHRV9HVUFSRFJBSUxfSEVJR0hUX0ZUOwogICAgICAgICAgICAgIGNvbnN0IG1pZFkgPSBzdGFnZVRvcFkgKyAoU1RBR0VfR1VBUkRSQUlMX0hFSUdIVF9GVCAqIDAuNSk7CiAgICAgICAgICAgICAgY29uc3QgcG9zdFkgPSBzdGFnZVRvcFkgKyAoU1RBR0VfR1VBUkRSQUlMX0hFSUdIVF9GVCAqIDAuNSk7CgogICAgICAgICAgICAgIGNvbnN0IHNlZ0NvdW50WCA9IE1hdGgubWF4KDEsIE1hdGgucm91bmQodG90YWxXIC8gU1RBR0VfR1VBUkRSQUlMX1BBTkVMX0ZUKSk7CiAgICAgICAgICAgICAgY29uc3Qgc2VnQ291bnRaID0gTWF0aC5tYXgoMSwgTWF0aC5yb3VuZCh0b3RhbEQgLyBTVEFHRV9HVUFSRFJBSUxfUEFORUxfRlQpKTsKICAgICAgICAgICAgICBjb25zdCBzZWdMZW5YID0gdG90YWxXIC8gc2VnQ291bnRYOwogICAgICAgICAgICAgIGNvbnN0IHNlZ0xlblogPSB0b3RhbEQgLyBzZWdDb3VudFo7CgogICAgICAgICAgICAgIC8vIE5PVEU6IFRoaXMgZW1iZWQgSFRNTCBsaXZlcyBpbnNpZGUgYSB0ZW1wbGF0ZSBzdHJpbmcgaW4gdGhlIFJlYWN0IGFwcC4KICAgICAgICAgICAgICAvLyBBdm9pZCBiYWNrdGlja3MgaGVyZSAodGVtcGxhdGUgbGl0ZXJhbHMpIGJlY2F1c2UgdGhleSdkIGJyZWFrIHRoZSBvdXRlciB0ZW1wbGF0ZSBzdHJpbmcuCiAgICAgICAgICAgICAgY29uc3QgcG9zdEtleSA9ICh4LCB6KSA9PiAoeC50b0ZpeGVkKDMpICsgIiwiICsgei50b0ZpeGVkKDMpKTsKICAgICAgICAgICAgICBjb25zdCBwb3N0U2VlbiA9IG5ldyBTZXQoKTsKCiAgICAgICAgICAgICAgY29uc3QgYWRkUG9zdCA9ICh4LCB6KSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBrID0gcG9zdEtleSh4LCB6KTsKICAgICAgICAgICAgICAgIGlmIChwb3N0U2Vlbi5oYXMoaykpIHJldHVybjsKICAgICAgICAgICAgICAgIHBvc3RTZWVuLmFkZChrKTsKICAgICAgICAgICAgICAgIGNvbnN0IHBvc3QgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeShwb3N0UiwgcG9zdFIsIFNUQUdFX0dVQVJEUkFJTF9IRUlHSFRfRlQsIDEyKSwgcmFpbE1hdCk7CiAgICAgICAgICAgICAgICBwb3N0LnBvc2l0aW9uLnNldCh4LCBwb3N0WSwgeik7CiAgICAgICAgICAgICAgICBwb3N0LmNhc3RTaGFkb3cgPSB0cnVlOyBwb3N0LnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgZ3JvdXAuYWRkKHBvc3QpOwogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIGNvbnN0IGFkZFJhaWwgPSAoeCwgeSwgeiwgbGVuZ3RoLCBheGlzKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBtZXNoID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkocmFpbFIsIHJhaWxSLCBsZW5ndGgsIDEyKSwgcmFpbE1hdCk7CiAgICAgICAgICAgICAgICBtZXNoLnBvc2l0aW9uLnNldCh4LCB5LCB6KTsKICAgICAgICAgICAgICAgIGlmIChheGlzID09PSAneCcpIG1lc2gucm90YXRpb24ueiA9IE1hdGguUEkgLyAyOwogICAgICAgICAgICAgICAgZWxzZSBtZXNoLnJvdGF0aW9uLnggPSBNYXRoLlBJIC8gMjsKICAgICAgICAgICAgICAgIG1lc2guY2FzdFNoYWRvdyA9IHRydWU7IG1lc2gucmVjZWl2ZVNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICBncm91cC5hZGQobWVzaCk7CiAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgZm9yIChjb25zdCByIG9mIHJhaWxzKSB7CiAgICAgICAgICAgICAgICBpZiAoIXIpIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgaWYgKHIuc2lkZSA9PT0gJ3RvcCcgfHwgci5zaWRlID09PSAnYm90dG9tJykgewogICAgICAgICAgICAgICAgICBjb25zdCBpID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oc2VnQ291bnRYIC0gMSwgKHIuaW5kZXggfCAwKSkpOwogICAgICAgICAgICAgICAgICBjb25zdCBsZW4gPSBzZWdMZW5YOwogICAgICAgICAgICAgICAgICBjb25zdCBjeCA9IC10b3RhbFcgLyAyICsgKGkgKyAwLjUpICogbGVuOwogICAgICAgICAgICAgICAgICBjb25zdCBjeiA9IChyLnNpZGUgPT09ICd0b3AnKSA/ICgtdG90YWxEIC8gMiAtIG91dCkgOiAodG90YWxEIC8gMiArIG91dCk7CiAgICAgICAgICAgICAgICAgIGFkZFJhaWwoY3gsIHRvcFksIGN6LCBsZW4sICd4Jyk7CiAgICAgICAgICAgICAgICAgIGFkZFJhaWwoY3gsIG1pZFksIGN6LCBsZW4sICd4Jyk7CiAgICAgICAgICAgICAgICAgIGFkZFBvc3QoY3ggLSBsZW4gLyAyLCBjeik7CiAgICAgICAgICAgICAgICAgIGFkZFBvc3QoY3ggKyBsZW4gLyAyLCBjeik7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHIuc2lkZSA9PT0gJ2xlZnQnIHx8IHIuc2lkZSA9PT0gJ3JpZ2h0JykgewogICAgICAgICAgICAgICAgICBjb25zdCBpID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oc2VnQ291bnRaIC0gMSwgKHIuaW5kZXggfCAwKSkpOwogICAgICAgICAgICAgICAgICBjb25zdCBsZW4gPSBzZWdMZW5aOwogICAgICAgICAgICAgICAgICBjb25zdCBjeiA9IC10b3RhbEQgLyAyICsgKGkgKyAwLjUpICogbGVuOwogICAgICAgICAgICAgICAgICBjb25zdCBjeCA9IChyLnNpZGUgPT09ICdsZWZ0JykgPyAoLXRvdGFsVyAvIDIgLSBvdXQpIDogKHRvdGFsVyAvIDIgKyBvdXQpOwogICAgICAgICAgICAgICAgICBhZGRSYWlsKGN4LCB0b3BZLCBjeiwgbGVuLCAneicpOwogICAgICAgICAgICAgICAgICBhZGRSYWlsKGN4LCBtaWRZLCBjeiwgbGVuLCAneicpOwogICAgICAgICAgICAgICAgICBhZGRQb3N0KGN4LCBjeiAtIGxlbiAvIDIpOwogICAgICAgICAgICAgICAgICBhZGRQb3N0KGN4LCBjeiArIGxlbiAvIDIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIGdyb3VwOwogICAgICAgICAgICB9OwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gLS0tIFN0YWdlIFN0YWlycyAoM0QpIC0tLQogICAgICAgICAgICAvLyBTdGFpcnMgYXR0YWNoIHRvIGFueSA0ZnQgcGVyaW1ldGVyIHNlZ21lbnQuIFdlIHJlbmRlciBhIHNpbXBsZSBzdGFpciB3aXRoIG9wdGlvbmFsIGhhbmRyYWlscy4KICAgICAgICAgICAgY29uc3QgY3JlYXRlU3RhZ2VTdGFpcnMzRCA9ICh0b3RhbFcsIHRvdGFsRCwgc3RhZ2VUb3BZLCBoZWlnaHRJbmNoZXMsIHN0YWlycykgPT4gewogICAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gbmV3IFRIUkVFLkdyb3VwKCk7CiAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHN0YWlycykgfHwgc3RhaXJzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGdyb3VwOwoKICAgICAgICAgICAgICBjb25zdCBoSW4gPSBNYXRoLm1heCgxLCBwYXJzZUludChTdHJpbmcoaGVpZ2h0SW5jaGVzIHx8IDI0KSwgMTApKTsKICAgICAgICAgICAgICBjb25zdCBoZWlnaHRGdCA9IHN0YWdlVG9wWTsKCiAgICAgICAgICAgICAgY29uc3Qgc3RlcFJpc2VJbiA9IDg7CiAgICAgICAgICAgICAgY29uc3Qgc3RlcENvdW50ID0gTWF0aC5tYXgoMSwgTWF0aC5yb3VuZChoSW4gLyBzdGVwUmlzZUluKSk7CiAgICAgICAgICAgICAgY29uc3QgcmlzZSA9IGhlaWdodEZ0IC8gc3RlcENvdW50OwogICAgICAgICAgICAgIGNvbnN0IHN0ZXBEZXB0aCA9IDAuOTU7CiAgICAgICAgICAgICAgY29uc3QgdG90YWxSdW4gPSBzdGVwQ291bnQgKiBzdGVwRGVwdGg7CgogICAgICAgICAgICAgIGNvbnN0IGZyYW1lTWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4Y2JkNWUxLCBtZXRhbG5lc3M6IDAuOCwgcm91Z2huZXNzOiAwLjIyIH0pOwogICAgICAgICAgICAgIGNvbnN0IHRyZWFkTWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4MTExODI3LCBtZXRhbG5lc3M6IDAuMSwgcm91Z2huZXNzOiAwLjkgfSk7CgogICAgICAgICAgICAgIGNvbnN0IFBBTkVMX0ZUID0gNDsKICAgICAgICAgICAgICBjb25zdCBzZWdDb3VudFggPSBNYXRoLm1heCgxLCBNYXRoLnJvdW5kKHRvdGFsVyAvIFBBTkVMX0ZUKSk7CiAgICAgICAgICAgICAgY29uc3Qgc2VnQ291bnRaID0gTWF0aC5tYXgoMSwgTWF0aC5yb3VuZCh0b3RhbEQgLyBQQU5FTF9GVCkpOwogICAgICAgICAgICAgIGNvbnN0IHNlZ0xlblggPSB0b3RhbFcgLyBzZWdDb3VudFg7CiAgICAgICAgICAgICAgY29uc3Qgc2VnTGVuWiA9IHRvdGFsRCAvIHNlZ0NvdW50WjsKCiAgICAgICAgICAgICAgY29uc3QgYWRkQ3lsaW5kZXJCZXR3ZWVuID0gKHAxLCBwMiwgciwgbWF0KSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBkaXIgPSBuZXcgVEhSRUUuVmVjdG9yMygpLnN1YlZlY3RvcnMocDIsIHAxKTsKICAgICAgICAgICAgICAgIGNvbnN0IGxlbiA9IGRpci5sZW5ndGgoKTsKICAgICAgICAgICAgICAgIGlmIChsZW4gPD0gMC4wMDAxKSByZXR1cm47CiAgICAgICAgICAgICAgICBjb25zdCBnZW9tID0gbmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkociwgciwgbGVuLCAxMCk7CiAgICAgICAgICAgICAgICBjb25zdCBtZXNoID0gbmV3IFRIUkVFLk1lc2goZ2VvbSwgbWF0KTsKICAgICAgICAgICAgICAgIGNvbnN0IG1pZCA9IG5ldyBUSFJFRS5WZWN0b3IzKCkuYWRkVmVjdG9ycyhwMSwgcDIpLm11bHRpcGx5U2NhbGFyKDAuNSk7CiAgICAgICAgICAgICAgICBtZXNoLnBvc2l0aW9uLmNvcHkobWlkKTsKICAgICAgICAgICAgICAgIG1lc2gucXVhdGVybmlvbi5zZXRGcm9tVW5pdFZlY3RvcnMobmV3IFRIUkVFLlZlY3RvcjMoMCwgMSwgMCksIGRpci5ub3JtYWxpemUoKSk7CiAgICAgICAgICAgICAgICBncm91cC5hZGQobWVzaCk7CiAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgY29uc3QgbWF5YmVBZGRIYW5kcmFpbHMgPSAoc2lkZSwgY2VudGVyWCwgY2VudGVyWiwgc3RhaXJXLCBvdXREaXIpID0+IHsKICAgICAgICAgICAgICAgIGlmIChoSW4gPD0gMTYpIHJldHVybjsKICAgICAgICAgICAgICAgIGNvbnN0IHJhaWxIID0gMy4wOwogICAgICAgICAgICAgICAgY29uc3QgcmFpbFIgPSAwLjAzOwogICAgICAgICAgICAgICAgY29uc3QgdG9wQWxvbmcgPSAwLjEyOwogICAgICAgICAgICAgICAgY29uc3QgYm90dG9tQWxvbmcgPSB0b3RhbFJ1biAtIDAuMTI7CiAgICAgICAgICAgICAgICBjb25zdCBwVG9wID0gbmV3IFRIUkVFLlZlY3RvcjMoY2VudGVyWCwgaGVpZ2h0RnQgKyByYWlsSCwgY2VudGVyWik7CiAgICAgICAgICAgICAgICBjb25zdCBwQm90ID0gbmV3IFRIUkVFLlZlY3RvcjMoY2VudGVyWCwgcmFpbEgsIGNlbnRlclopOwogICAgICAgICAgICAgICAgaWYgKHNpZGUgPT09ICd0b3AnIHx8IHNpZGUgPT09ICdib3R0b20nKSB7CiAgICAgICAgICAgICAgICAgIHBUb3AueiArPSBvdXREaXIgKiB0b3BBbG9uZzsKICAgICAgICAgICAgICAgICAgcEJvdC56ICs9IG91dERpciAqIGJvdHRvbUFsb25nOwogICAgICAgICAgICAgICAgICBjb25zdCBvZmYgPSAoc3RhaXJXIC8gMikgLSAwLjE1OwogICAgICAgICAgICAgICAgICBjb25zdCBsZWZ0VG9wID0gcFRvcC5jbG9uZSgpOyBsZWZ0VG9wLnggLT0gb2ZmOwogICAgICAgICAgICAgICAgICBjb25zdCBsZWZ0Qm90ID0gcEJvdC5jbG9uZSgpOyBsZWZ0Qm90LnggLT0gb2ZmOwogICAgICAgICAgICAgICAgICBjb25zdCByaWdodFRvcCA9IHBUb3AuY2xvbmUoKTsgcmlnaHRUb3AueCArPSBvZmY7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHJpZ2h0Qm90ID0gcEJvdC5jbG9uZSgpOyByaWdodEJvdC54ICs9IG9mZjsKICAgICAgICAgICAgICAgICAgYWRkQ3lsaW5kZXJCZXR3ZWVuKGxlZnRCb3QsIGxlZnRUb3AsIHJhaWxSLCBmcmFtZU1hdCk7CiAgICAgICAgICAgICAgICAgIGFkZEN5bGluZGVyQmV0d2VlbihyaWdodEJvdCwgcmlnaHRUb3AsIHJhaWxSLCBmcmFtZU1hdCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBwVG9wLnggKz0gb3V0RGlyICogdG9wQWxvbmc7CiAgICAgICAgICAgICAgICAgIHBCb3QueCArPSBvdXREaXIgKiBib3R0b21BbG9uZzsKICAgICAgICAgICAgICAgICAgY29uc3Qgb2ZmID0gKHN0YWlyVyAvIDIpIC0gMC4xNTsKICAgICAgICAgICAgICAgICAgY29uc3QgbGVmdFRvcCA9IHBUb3AuY2xvbmUoKTsgbGVmdFRvcC56IC09IG9mZjsKICAgICAgICAgICAgICAgICAgY29uc3QgbGVmdEJvdCA9IHBCb3QuY2xvbmUoKTsgbGVmdEJvdC56IC09IG9mZjsKICAgICAgICAgICAgICAgICAgY29uc3QgcmlnaHRUb3AgPSBwVG9wLmNsb25lKCk7IHJpZ2h0VG9wLnogKz0gb2ZmOwogICAgICAgICAgICAgICAgICBjb25zdCByaWdodEJvdCA9IHBCb3QuY2xvbmUoKTsgcmlnaHRCb3QueiArPSBvZmY7CiAgICAgICAgICAgICAgICAgIGFkZEN5bGluZGVyQmV0d2VlbihsZWZ0Qm90LCBsZWZ0VG9wLCByYWlsUiwgZnJhbWVNYXQpOwogICAgICAgICAgICAgICAgICBhZGRDeWxpbmRlckJldHdlZW4ocmlnaHRCb3QsIHJpZ2h0VG9wLCByYWlsUiwgZnJhbWVNYXQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIGZvciAoY29uc3QgcyBvZiBzdGFpcnMpIHsKICAgICAgICAgICAgICAgIGlmICghcyB8fCAhcy5zaWRlKSBjb250aW51ZTsKICAgICAgICAgICAgICAgIGNvbnN0IHNpZGUgPSBzLnNpZGU7CiAgICAgICAgICAgICAgICBpZiAoc2lkZSA9PT0gJ3RvcCcgfHwgc2lkZSA9PT0gJ2JvdHRvbScpIHsKICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHNlZ0NvdW50WCAtIDEsIChzLmluZGV4IHwgMCkpKTsKICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhaXJXID0gc2VnTGVuWCAqIDAuOTI7CiAgICAgICAgICAgICAgICAgIGNvbnN0IGN4ID0gLXRvdGFsVyAvIDIgKyAoaSArIDAuNSkgKiBzZWdMZW5YOwogICAgICAgICAgICAgICAgICBjb25zdCBvdXREaXIgPSAoc2lkZSA9PT0gJ3RvcCcpID8gLTEgOiAxOwogICAgICAgICAgICAgICAgICBjb25zdCBlZGdlWiA9IChzaWRlID09PSAndG9wJykgPyAoLXRvdGFsRCAvIDIpIDogKHRvdGFsRCAvIDIpOwogICAgICAgICAgICAgICAgICBmb3IgKGxldCBzdGVwID0gMDsgc3RlcCA8IHN0ZXBDb3VudDsgc3RlcCsrKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgeSA9IHN0ZXAgKiByaXNlICsgcmlzZSAvIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWxvbmcgPSAoc3RlcENvdW50IC0gc3RlcCAtIDAuNSkgKiBzdGVwRGVwdGg7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3ogPSBlZGdlWiArIG91dERpciAqIGFsb25nOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyYW1lID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkJveEdlb21ldHJ5KHN0YWlyVywgcmlzZSwgc3RlcERlcHRoICogMC45OCksIGZyYW1lTWF0KTsKICAgICAgICAgICAgICAgICAgICBmcmFtZS5wb3NpdGlvbi5zZXQoY3gsIHksIGN6KTsKICAgICAgICAgICAgICAgICAgICBncm91cC5hZGQoZnJhbWUpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRyZWFkID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkJveEdlb21ldHJ5KHN0YWlyVyAqIDAuOTYsIHJpc2UgKiAwLjA4LCBzdGVwRGVwdGggKiAwLjkwKSwgdHJlYWRNYXQpOwogICAgICAgICAgICAgICAgICAgIHRyZWFkLnBvc2l0aW9uLnNldChjeCwgc3RlcCAqIHJpc2UgKyByaXNlIC0gKHJpc2UgKiAwLjA0KSwgY3opOwogICAgICAgICAgICAgICAgICAgIGdyb3VwLmFkZCh0cmVhZCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgbWF5YmVBZGRIYW5kcmFpbHMoc2lkZSwgY3gsIGVkZ2VaLCBzdGFpclcsIG91dERpcik7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBjb25zdCBpID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oc2VnQ291bnRaIC0gMSwgKHMuaW5kZXggfCAwKSkpOwogICAgICAgICAgICAgICAgICBjb25zdCBzdGFpclcgPSBzZWdMZW5aICogMC45MjsKICAgICAgICAgICAgICAgICAgY29uc3QgY3ogPSAtdG90YWxEIC8gMiArIChpICsgMC41KSAqIHNlZ0xlblo7CiAgICAgICAgICAgICAgICAgIGNvbnN0IG91dERpciA9IChzaWRlID09PSAnbGVmdCcpID8gLTEgOiAxOwogICAgICAgICAgICAgICAgICBjb25zdCBlZGdlWCA9IChzaWRlID09PSAnbGVmdCcpID8gKC10b3RhbFcgLyAyKSA6ICh0b3RhbFcgLyAyKTsKICAgICAgICAgICAgICAgICAgZm9yIChsZXQgc3RlcCA9IDA7IHN0ZXAgPCBzdGVwQ291bnQ7IHN0ZXArKykgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHkgPSBzdGVwICogcmlzZSArIHJpc2UgLyAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGFsb25nID0gKHN0ZXBDb3VudCAtIHN0ZXAgLSAwLjUpICogc3RlcERlcHRoOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGN4ID0gZWRnZVggKyBvdXREaXIgKiBhbG9uZzsKICAgICAgICAgICAgICAgICAgICBjb25zdCBmcmFtZSA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5Cb3hHZW9tZXRyeShzdGVwRGVwdGggKiAwLjk4LCByaXNlLCBzdGFpclcpLCBmcmFtZU1hdCk7CiAgICAgICAgICAgICAgICAgICAgZnJhbWUucG9zaXRpb24uc2V0KGN4LCB5LCBjeik7CiAgICAgICAgICAgICAgICAgICAgZ3JvdXAuYWRkKGZyYW1lKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0cmVhZCA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5Cb3hHZW9tZXRyeShzdGVwRGVwdGggKiAwLjkwLCByaXNlICogMC4wOCwgc3RhaXJXICogMC45NiksIHRyZWFkTWF0KTsKICAgICAgICAgICAgICAgICAgICB0cmVhZC5wb3NpdGlvbi5zZXQoY3gsIHN0ZXAgKiByaXNlICsgcmlzZSAtIChyaXNlICogMC4wNCksIGN6KTsKICAgICAgICAgICAgICAgICAgICBncm91cC5hZGQodHJlYWQpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIG1heWJlQWRkSGFuZHJhaWxzKHNpZGUsIGVkZ2VYLCBjeiwgc3RhaXJXLCBvdXREaXIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIGdyb3VwOwogICAgICAgICAgICB9OwoKCiAgICAgICAgLy8gQ2hhaXIgcHJvdG90eXBlcyAoZ2xvYmFsIHN0eWxlKQogICAgICAgIC8vIENoYWlyIEdMQiBsb2FkaW5nIChvcHRpb25hbCkuIElmIGEgR0xCIGZhaWxzIHRvIGxvYWQgKG9yIENPUlMgYmxvY2tzIGl0KSwgd2UgZmFsbCBiYWNrIHRvIHByb2NlZHVyYWwgY2hhaXJzLgogICAgICAgIGNvbnN0IENIQUlSX0dMQl9VUkxTID0gewogICAgICAgICAgICBydXN0aWNfY3Jvc3NiYWNrOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvcnVzdGljX3dvb2Rlbl9jaGFpcl8wMTE5MDEyNDE4X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgZm9sZGluZ193aGl0ZTogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2ZvbGRpbmdfY2hhaXJfMDExOTAyNTY0M190ZXh0dXJlLmdsYicsCiAgICAgICAgICAgIHdoaXRlX3Jlc2luX3BhZGRlZDogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3doaXRlX3Jlc2luX3BhZGRlZF9jaGFpcjAxMTkwMzE4MjJfdGV4dHVyZS5nbGInLAogICAgICAgICAgICBibGFja19wYWRkZWRfZm9sZGluZzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2JsYWNrX3BhZGRlZF9mb2xkaW5nX18wMTE5MDMzODIzX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgd2hpdGVfZmFuYmFjazogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3doaXRlX2ZhbmJhY2tfY2hhaXJfMDEyMDAxNDAwMV90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgIGJhbnF1ZXRfY2hhaXI6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9iYW5xdWV0X2NoYWlyXzAxMjUyMDAzMDlfdGV4dHVyZS5nbGInLAogICAgICAgICAgICB3aWxsb3dfY2hhaXI6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC93aWxsb3dfY2hhaXJfMDEyNTIwMTIxNF90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgIGxvdWlzX3h2aV9nb2xkOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvbG91aXNfeHZpX2dvbGRfd2l0aF9iXzAxMjUyMDExMzBfdGV4dHVyZS5nbGInLAogICAgICAgICAgICBiZW50d29vZDogJ2h0dHBzOi8vMTQwMzMyNzgtOTMzNjkzODMxNTAxNzAyNzc1LnByZXZpZXcuZWRpdG15c2l0ZS5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2JlbnR3b29kX2NoYWlyXzAxMjQwMzUwNDNfdGV4dHVyZS5nbGInLAoKICAgICAgICB9OwoKICAgICAgICAvLyBGb290LWJhc2VkIHNpemluZzogd2Ugbm9ybWFsaXplIGVhY2ggR0xCIHNvIGl0cyB0b3RhbCBoZWlnaHQgbWF0Y2hlcyB0aGVzZSB2YWx1ZXMuCiAgICAgICAgY29uc3QgQ0hBSVJfR0xCX1RBUkdFVF9IRUlHSFRfRlQgPSB7CiAgICAgICAgICAgIHJ1c3RpY19jcm9zc2JhY2s6IDMuMCwKICAgICAgICAgICAgZm9sZGluZ193aGl0ZTogMy4wNSwKICAgICAgICAgICAgd2hpdGVfcmVzaW5fcGFkZGVkOiAzLjA1LAogICAgICAgICAgICBibGFja19wYWRkZWRfZm9sZGluZzogMy4wNSwKICAgICAgICAgICAgd2hpdGVfZmFuYmFjazogMy4wNSwKICAgICAgICAgICAgYmFucXVldF9jaGFpcjogMy4wLAogICAgICAgICAgICB3aWxsb3dfY2hhaXI6IDMuMCwKICAgICAgICAgICAgbG91aXNfeHZpX2dvbGQ6IDMuMSwKICAgICAgICAgICAgYmVudHdvb2Q6IDIuOSwKCiAgICAgICAgfTsKCiAgICAgICAgY29uc3QgY2hhaXJHbGJQcm90b0J5U3R5bGUgPSB7fTsKICAgICAgICBjb25zdCBjaGFpckdsYkxvYWRTdGFydGVkQnlTdHlsZSA9IHt9OwoKICAgICAgICAvLyBGdXJuaXR1cmUgR0xCIGxvYWRpbmcgKG1vZGVybiBsb3VuZ2UgKyBpbmZpbml0eSBiYXIpLiBGYWxscyBiYWNrIHRvIHByb2NlZHVyYWwgcGxhY2Vob2xkZXJzLgogICAgICAgIGNvbnN0IEZVUk5JVFVSRV9HTEJfVVJMUyA9IHsKICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2UtYXJtbGVzcyc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9hcm1sZXNzX2NoYWlyX21vZGVybl8wMTIwMTk0NzI4X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utb3R0b21hbic6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9tb2Rlcm5fb3R0b21hbl8wMTIwMTk1NzU4X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2UtY29mZmVlLWxlZCc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9sZWRfdGFibGVfMDEyMDIwMjAzMV90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLWxvdmVzZWF0LWl2b3J5JzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2l2b3J5X2ZhdXhfbGVhdGhlcl9sb18wMTIwMjE0NzEyX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2UtY29ybmVyJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2Nvcm5lcl9jaGFpcl8wMTIwMjIxODE5X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2UtZW5kLXRhYmxlLWJsYWNrJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2JsYWNrX2VuZF90YWJsZV8wMTIwMjE0MzUzX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2UtY29mZmVlLWluZmluaXR5JzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2luZmluaXR5X2xlZF9jb2ZmZWVfdF8wMTIwMjA0NDE4X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2UtY2x1Yi1jaGFpci1ibGFjayc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9ibGFja19jbHViX2NoYWlyXzAxMjAyMDM2MDNfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAnaW5maW5pdHktYmFyJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2xlZF9hY3J5bGljX2luZmluaXR5X2Jhci5nbGInLAoKICAgICAgICAgICAgLy8gRXh0cmEgM0Qgc2VydmljZS9kZWNvci9pbmZsYXRhYmxlcy9mb2xpYWdlCiAgICAgICAgICAgICdiYXItMy1iYXJyZWwnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvM19iYXJyZWxfYmFyXzAxMjIwMTQ3NDFfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAncGF0aW8taGVhdGVyJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3BhdGlvX2hlYXRlcl8wMTI0MDMzMDIwX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgJ29mZmljZS1jaGFpcic6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9vZmZpY2VfY2hhaXJfMDEyNDAzMjMyNF90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICdkZWNvci1jaXJjbGUtYXJjaCc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9jaXJjbGVfYXJjaF8wMTIyMDA1NjU3X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgJ2RlY29yLWJhcnJlbC1hcmNoJzogJ2h0dHBzOi8vMTQwMzMyNzgtOTMzNjkzODMxNTAxNzAyNzc1LnByZXZpZXcuZWRpdG15c2l0ZS5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L21lc2h5X2FpX2JhcnJlbF9hcmNoXzAxMjIwMTU5MzhfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAnaW5mbGF0YWJsZS1vYnN0YWNsZS1jb3Vyc2UnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvY29sb3JmdWxfaW5mbGF0YWJsZV9vYnN0YWNsZV8wMTI0MDMyMTIyX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgJ2ZvbGlhZ2UtaGVkZ2UnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvZ3JlZW5faGVkZ2VfMDEyNDAzMjkyMV90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgLy8gVGFibGVzICsgcHJvcHMgKG5ldykKICAgICAgICAgICAgICAncGljbmljLXRhYmxlLWNsYXNzaWMnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvcGljbmljX3RhYmxlX2NsYXNzaWNfMDEyNTE4NTMwNl90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2Zhcm0tdGFibGUtOGZ0JzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2Zhcm1fdGFibGVfMDEyNTE4NTIzNl90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2J1ZmZldC10YWJsZS1zZXR1cCc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9idWZmZXRfdGFibGVfc2V0dXBfMDEyNTE5NTAwNF90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2N1cnZlZC1mb2xkaW5nLXRhYmxlcyc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9jdXJ2ZWRfZm9sZGluZ190YWJsZXNfMDEyNTE5NDAwNV90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ3JvdW5kLXRhYmxlLTVmdC1mb2xkaW5nJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3JvdW5kX2ZvbGRpbmdfdGFibGVfXzAxMjUyMDA0NDlfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdiYW5xdWV0LXRhYmxlLThmdC13b29kJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4LzhmdF9mb2xkaW5nX3RhYmxlX3dvXzAxMjUyMDA0MjJfdGV4dHVyZS5nbGInLAoKICAgICAgICAgICAgICAvLyBEZWNvciArIGZvbGlhZ2UKICAgICAgICAgICAgICAnZGVjb3Itd2hpc2tleS1iYXJyZWwnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvd2hpc2tleV9iYXJyZWxfMDEyNTE4NDk1N190ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2RlY29yLWJhcnJlbC1saWdodC1wb3N0JzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2JhcnJlbF9saWdodF9wb3N0XzAxMjUxOTQ4MDdfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdmb2xpYWdlLWJveHdvb2QtaGVkZ2Utd2FsbCc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9ib3h3b29kX2hlZGdlX3dhbGxfMDEyNTE4NTEzM190ZXh0dXJlLmdsYicsCgogICAgICAgICAgICAgIC8vIFNlcnZpY2UgLyBESiAvIHN0YXRpb25zCiAgICAgICAgICAgICAgJ3N0YXRpb24tcG9ydGFibGUtcmVzdHJvb20tdHJhaWxlcic6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9wb3J0YWJsZV9yZXN0cm9vbV90cmFpbGVyXzAxMjUxODQ4MTBfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdzdGF0aW9uLWJicSc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9iYnFfMDEyNTE5NTE0MV90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ3N0YXRpb24tY29mZmVlLXVybic6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9jb2ZmZWVfdXJuXzAxMjUxOTUwNDFfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdkai1zcGVha2VyLW9uLXN0YW5kJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3NwZWFrZXJfb25fc3RhbmRfMDEyNTE5NDg0M190ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2RqLWthcmFva2UtbWFjaGluZSc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9rYXJhb2tlX3BhcnR5X3NwZWFrZXJfMDEyNTE5NDYzMl90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2RqLXByb2plY3Rpb24tc2NyZWVuJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3Byb2plY3Rpb25fc2NyZWVuXzAxMjUyMDAwNTlfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdkai1wb2RpdW0nOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvcG9kaXVtXzAxMjUxOTQyNDRfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdzdGF0aW9uLXBob3RvLWJvb3RoLXNldHVwJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3Bob3RvX2Jvb3RoX3NldHVwXzAxMjUxOTQxMjFfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdzdGF0aW9uLXBob3RvLWJvb3RoLXRhYmxldG9wJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3Bob3RvX2Jvb3RoXzAxMjUxOTQwMzlfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdzdGF0aW9uLWh1bnRlci1hcmNhZGUnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvaHVudGVyX2FyY2FkXzAxMjUxOTQ1MzhfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdzdGF0aW9uLXRyYXNoLWNvbnRhaW5lcic6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC90cmFzaF9jb250YWluZXJfMDEyNTIwMDcwMF90ZXh0dXJlLmdsYicsCgogICAgICAgICAgICAgIC8vIEluZmxhdGFibGVzCiAgICAgICAgICAgICAgJ2luZmxhdGFibGUtYm91bmN5LWhvdXNlLWJsb2Nrcyc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9ib3VuY3lfaG91c2VfYmxvY2tzX18wMTI1MTk0NTEwX3RleHR1cmUuZ2xiJywKCiAgICAgICAgICAgICAgLy8gU3RhbmRhbG9uZSBzdG9vbHMgKGNoYWlycyB0YWIpCiAgICAgICAgICAgICAgJ2NoYWlyLXNsZWVrLXN3aXZlbC1zdG9vbCc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9zbGVla19zd2l2ZWxfc3Rvb2xfMDEyNTIwMDg1OF90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2NoYWlyLXN0b29sLXNjb29wZXItd2hpdGUnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvc3Rvb2xfc2Nvb3Blcl93aGl0ZV8wMTI1MjAwODMxX3RleHR1cmUuZ2xiJywKCiAgICAgICAgICAgICAgLy8gTmV3OiBjaGFpcnMgKG5vbi1nbG9iYWwgcHJvcHMpCiAgICAgICAgICAgICAgJ2NoYWlyLWFkaXJvbmRhY2snOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvYWRpcm9uZGFja19jaGFpcl8wMTI3MTgyNDU2X3RleHR1cmUuZ2xiJywKCiAgICAgICAgICAgICAgLy8gTmV3OiB0YWJsZXMgLyB0YWJsZXRvcCAvIHByb3BzCiAgICAgICAgICAgICAgJ3BpY25pYy10YWJsZS1raWRzLWdyZWVuJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2tpZHNfZ3JlZW5fcGljbmljX3RhYl8wMTI2MTg1MzM2X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgICAncGljbmljLXRhYmxlLXBsYXN0aWMnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvcGxhc3RpY19waWNuaWNfdGFibGVfMDEyNjE3NTMyNV90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ3BpY25pYy1vYXNpcyc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9waWNuaWNfb2FzaXNfMDEyNzE4MTgzMl90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2hlYWQtdGFibGUtOGZ0LXNraXJ0ZWQnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvaGVhZF90YWJsZV84ZnRfc2tpcnRlXzAxMjYxODEzMzJfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICd3aGl0ZS1taW5pbWFsaXN0LXRhYmxlJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3doaXRlX21pbmltYWxpc3RfdGFibF8wMTI3MTgyMDI1X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgICAnd2lyZWZyYW1lLWNvY2t0YWlsLXRhYmxlJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3dpcmVmcmFtZV9jb2NrdGFpbF90YV8wMTI3MTgyODIxX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgICAnY29ja3RhaWwtdGFibGUtbW9kZXJuLW1pbmltYWxpc3QnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvbW9kZXJuX21pbmltYWxpc3RfY29ja3RhaWxfdGFibGVfMDEyNzE4MjQxMF90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2NvY2t0YWlsLXRhYmxlLWx1bWlub3VzJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2x1bWlub3VzX2NvY2t0YWlsX3RhYl8wMTI3MTgyMjQwX3RleHR1cmUuZ2xiJywKCiAgICAgICAgICAgICAgLy8gTmV3OiB0cnVzc2luZwogICAgICAgICAgICAgICd0cnVzcy1zdGFnZS1saWdodC1wdXJwbGUnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvcHVycGxlX3N0YWdlX2xpZ2h0XzAxMjYxODUyMjJfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICd0cnVzcy10di1zdGFuZCc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC90dl9vbl90cnVzc19zdGFuZF8wMTI2MTc1ODM4X3RleHR1cmUuZ2xiJywKCiAgICAgICAgICAgICAgLy8gTmV3OiBzZXJ2aWNlIC8gc3RhdGlvbnMKICAgICAgICAgICAgICAnc3RhdGlvbi1mcmlkZ2Utb24td2hlZWxzJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2ZyaWRnZV9vbl93aGVlXzAxMjYxODE0MjBfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdzdGF0aW9uLXBvcGNvcm4tY2FydCc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9wb3Bjb3JuX2NhcnRfMDEyNjE4MTE0NV90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ3N0YXRpb24tYXJjYWRlLXJhY2luZy1jbGFzc2ljJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2FyY2FkZV9yYWNpbmdfY2xhc3NpY18wMTI2MTc1NTAzX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgICAnc3RhdGlvbi1hcmNhZGUtcnVzaC1yYWNpbmcnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvYXJjYWRlX3J1c2hfcmFjaW5nXzAxMjcxODI1NDdfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdzdGF0aW9uLXJhY2luZy1zaW0nOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvcmFjaW5nX3NpbV8wMTI3MTgyNjA3X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgICAnYmFyLW1vZGVybic6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9iYXIwMTI3MTgxOTEwX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgICAnYmFyLXdoaXRlLWJhY2stYmFyJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3doaXRlX2JhY2tfYmFyXzAxMjcxODI2MzdfdGV4dHVyZS5nbGInLAoKICAgICAgICAgICAgICAvLyBOZXc6IGRlY29yIChpbmNsIHRhYmxldG9wKQogICAgICAgICAgICAgICdkZWNvci1jYW52YXMtZWFzZWwnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvYmxhbmtfY2FudmFzX29uX2Vhc2VsXzAxMjYxNzU3NTJfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdkZWNvci1jdXBjYWtlLXN0YW5kJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2N1cGNha2Vfc3RhbmRfMDEyNjE4MTI0Ml90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2RlY29yLWhleC1zaGVsZic6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9oZXhhZ29uYWxfc2hlbGZfZGVzaWdfMDEyNjE3NTM0OF90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2RlY29yLW1ldGFsLWJvb2tzaGVsZic6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9tZXRhbF9ib29rc2hlbGZfMDEyNzE4MjY1N190ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2RlY29yLWdvbGRlbi1zaGVsdmluZy11bml0JzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2dvbGRlbl9zaGVsdmluZ191bml0XzAxMjcxODI1MjFfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdkZWNvci11bWJyZWxsYS1zaGFkZSc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC91bWJyZWxsYV9zaGFkZV8wMTI3MTgyMzAzX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgICAnZGVjb3Itc3RhZ2Utc3RlcHMtYWx1bWludW0nOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvc3RhZ2VfYWx1bWludW1fc3RlcHNfMDEyNzE4MjIwOV90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ2RlY29yLWJsZWFjaGVycy11bmZ1cmxlZCc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9ibGVhY2hlcnNfdW5mdXJsZWRfMDEyNzE4MjE0MV90ZXh0dXJlLmdsYicsCgogICAgICAgICAgICAgIC8vIE5ldzogbG91bmdlIC8gY291Y2gtc3R5bGUgKDMyIGluIHRhbGwpCiAgICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utc29mYS1jdXJ2ZWQtdmVsdmV0LWJsYWNrJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2JsYWNrX2N1cnZlZF92ZWx2ZXRfc29mYV8wMTI3MTgzNjE2X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgICAnbW9kZXJuLWxvdW5nZS1zb2ZhLWN1cnZ5LWdyZWVuJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2dyZWVuX2N1cnZleV9zb2ZhXzAxMjcxODM1MzlfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLXNvZmEtY3VydmVkLWVsZWdhbmNlLXdoaXRlLWEnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvd2hpdGVfY3VydmVkX2VsZWdhbmNlX3NvZmFfMDEyNzE4MzQ1N190ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utc29mYS1sLXNoYXBlZC1tb2Rlcm4tYmxhY2snOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvYmlhY2tfbF9zaGFwZWRfbW9kZXJuX3NvZmFfMDEyNzE4MzQyOV90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utc29mYS1zZWN0aW9uYWwtY3JlYW0nOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvY3JlYW1fc2VjdGlvbmFsXzAxMjcxODMzNTNfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLXNvZmEtY3VydmVkLWdyZXknOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvZ3JleV9jdXJ2ZWRfc29mYV8wMTI3MTgzMjM1X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgICAnbW9kZXJuLWxvdW5nZS1zb2ZhLWNyZXNjZW50LXdoaXRlJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3doaXRlX2NyZXNjZW50X3NvZmFfMDEyNzE4MzIxMV90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utc29mYS1jdXJ2ZWQtZWxlZ2FuY2Utd2hpdGUtYic6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC93aGl0ZV9jdXJ2ZWRfZWxlZ2FuY2Vfc29mYV8wMTI3MTgzMTQwX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgICAnbW9kZXJuLWxvdW5nZS1zb2ZhLWN1cnZlLWdyZWVuJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2dyZWVuX2N1cnZlX3NvZmFfMDEyNzE4MzEwOV90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utc29mYS1lbGVnYW50LWJsYWNrJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2VsZWdhbnRfYmxhY2tfc29mYV8wMTI3MTgzMDQ4X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgICAnbW9kZXJuLWxvdW5nZS1zb2ZhLWNvcm5lci1jb21mb3J0LWdyZWVuJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2dyZWVuX2Nvcm5lcl9jb21mb3J0XzAxMjcxODMwMThfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLXNvZmEtc2VjdGlvbmFsLXdoaXRlJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L3doaXRlX3NlY3Rpb25hbF9zb2ZhXzAxMjcxODI5NDhfdGV4dHVyZS5nbGInLAogICAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLXNvZmEtY29tZm9ydC13aGl0ZSc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC93aGl0ZV9jb21mb3J0X3NvZmFfMDEyNzE4MjkxOF90ZXh0dXJlLmdsYicsCiAgICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utc29mYS1oYXJtb255LWdyZWVuJzogJ2h0dHBzOi8vd3d3LjMwNnBhcnR5cmVudGFscy5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2dyZWVuX2hhcm1vbnlfc29mYV8wMTI3MTgyODQzX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgICAnbW9kZXJuLWxvdW5nZS1vdHRvbWFuLWN1YmUtd2hpdGUnOiAnaHR0cHM6Ly93d3cuMzA2cGFydHlyZW50YWxzLmNvbS91cGxvYWRzLzEvNC8wLzMvMTQwMzMyNzgvd2hpdGVfY3ViZV9vdHRvbWFuXzAxMjcxODE3NTJfdGV4dHVyZS5nbGInLAoKICAgICAgICB9OwoKICAgICAgICAvLyBOb3JtYWxpemUgZWFjaCBHTEIgc28gaXRzIHRvdGFsIGhlaWdodCBtYXRjaGVzIHRoZXNlIGZvb3QgdmFsdWVzLgogICAgICAgIGNvbnN0IEZVUk5JVFVSRV9HTEJfVEFSR0VUX0hFSUdIVF9GVCA9IHsKICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2UtYXJtbGVzcyc6IDI3LjUgLyAxMiwKICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utb3R0b21hbic6IDE3IC8gMTIsCiAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLWNvZmZlZS1sZWQnOiAxNiAvIDEyLAogICAgICAgICAgICAnbW9kZXJuLWxvdW5nZS1sb3Zlc2VhdC1pdm9yeSc6IDQ0LjA5IC8gMTIsCiAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLWNvcm5lcic6IDI3LjUgLyAxMiwKICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2UtZW5kLXRhYmxlLWJsYWNrJzogMTcgLyAxMiwKICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2UtY29mZmVlLWluZmluaXR5JzogMTcuOCAvIDEyLAogICAgICAgICAgICAnbW9kZXJuLWxvdW5nZS1jbHViLWNoYWlyLWJsYWNrJzogMzAuNSAvIDEyLAogICAgICAgICAgICAnaW5maW5pdHktYmFyJzogNDAgLyAxMiwKCiAgICAgICAgICAgIC8vIEV4dHJhIDNEIHNlcnZpY2UvZGVjb3IvaW5mbGF0YWJsZXMvZm9saWFnZQogICAgICAgICAgICAnYmFyLTMtYmFycmVsJzogMy41LAogICAgICAgICAgICAncGF0aW8taGVhdGVyJzogNywKICAgICAgICAgICAgJ29mZmljZS1jaGFpcic6IDIuOTIsCiAgICAgICAgICAgICdkZWNvci1jaXJjbGUtYXJjaCc6IDcsCiAgICAgICAgICAgICdkZWNvci1iYXJyZWwtYXJjaCc6IDgsCiAgICAgICAgICAgICdpbmZsYXRhYmxlLW9ic3RhY2xlLWNvdXJzZSc6IDgsCiAgICAgICAgICAgICAgLy8gVGFibGVzICsgcHJvcHMgKG5ldykKICAgICAgICAgICAgICAncGljbmljLXRhYmxlLWNsYXNzaWMnOiAyLjUsCiAgICAgICAgICAgICAgJ2Zhcm0tdGFibGUtOGZ0JzogMi41LAogICAgICAgICAgICAgICdidWZmZXQtdGFibGUtc2V0dXAnOiAzLjIsCiAgICAgICAgICAgICAgJ2N1cnZlZC1mb2xkaW5nLXRhYmxlcyc6IDIuNSwKICAgICAgICAgICAgICAncm91bmQtdGFibGUtNWZ0LWZvbGRpbmcnOiAyLjUsCiAgICAgICAgICAgICAgJ2JhbnF1ZXQtdGFibGUtOGZ0LXdvb2QnOiAyLjUsCgogICAgICAgICAgICAgIC8vIERlY29yICsgZm9saWFnZQogICAgICAgICAgICAgICdkZWNvci13aGlza2V5LWJhcnJlbCc6IDMsCiAgICAgICAgICAgICAgJ2RlY29yLWJhcnJlbC1saWdodC1wb3N0JzogMTAsCiAgICAgICAgICAgICAgJ2ZvbGlhZ2UtYm94d29vZC1oZWRnZS13YWxsJzogOCwKCiAgICAgICAgICAgICAgLy8gU2VydmljZSAvIERKIC8gc3RhdGlvbnMKICAgICAgICAgICAgICAnc3RhdGlvbi1wb3J0YWJsZS1yZXN0cm9vbS10cmFpbGVyJzogOS41LAogICAgICAgICAgICAgICdzdGF0aW9uLWJicSc6IDQsCiAgICAgICAgICAgICAgJ3N0YXRpb24tY29mZmVlLXVybic6IDEuNSwKICAgICAgICAgICAgICAnZGotc3BlYWtlci1vbi1zdGFuZCc6IDYuNSwKICAgICAgICAgICAgICAnZGota2FyYW9rZS1tYWNoaW5lJzogMy41LAogICAgICAgICAgICAgICdkai1wcm9qZWN0aW9uLXNjcmVlbic6IDcuNSwKICAgICAgICAgICAgICAnZGotcG9kaXVtJzogNCwKICAgICAgICAgICAgICAnc3RhdGlvbi1waG90by1ib290aC1zZXR1cCc6IDcsCiAgICAgICAgICAgICAgJ3N0YXRpb24tcGhvdG8tYm9vdGgtdGFibGV0b3AnOiAxLjUsCiAgICAgICAgICAgICAgJ3N0YXRpb24taHVudGVyLWFyY2FkZSc6IDYsCiAgICAgICAgICAgICAgJ3N0YXRpb24tdHJhc2gtY29udGFpbmVyJzogNCwKCiAgICAgICAgICAgICAgLy8gSW5mbGF0YWJsZXMKICAgICAgICAgICAgICAnaW5mbGF0YWJsZS1ib3VuY3ktaG91c2UtYmxvY2tzJzogOSwKCiAgICAgICAgICAgICAgLy8gU3RhbmRhbG9uZSBzdG9vbHMgLyBjaGFpcnMKICAgICAgICAgICAgICAnY2hhaXItc2xlZWstc3dpdmVsLXN0b29sJzogMywKICAgICAgICAgICAgICAnY2hhaXItc3Rvb2wtc2Nvb3Blci13aGl0ZSc6IDMsCiAgICAgICAgICAgICAgJ2NoYWlyLWFkaXJvbmRhY2snOiAzOSAvIDEyLAoKICAgICAgICAgICAgICAvLyBOZXc6IHRhYmxlcyAvIHRhYmxldG9wIC8gcHJvcHMKICAgICAgICAgICAgICAncGljbmljLXRhYmxlLWtpZHMtZ3JlZW4nOiAxLjUsCiAgICAgICAgICAgICAgJ3BpY25pYy10YWJsZS1wbGFzdGljJzogMi41LAogICAgICAgICAgICAgICdwaWNuaWMtb2FzaXMnOiAxLjUsCiAgICAgICAgICAgICAgJ2hlYWQtdGFibGUtOGZ0LXNraXJ0ZWQnOiAyLjUsCiAgICAgICAgICAgICAgJ3doaXRlLW1pbmltYWxpc3QtdGFibGUnOiAyLjUsCiAgICAgICAgICAgICAgJ3dpcmVmcmFtZS1jb2NrdGFpbC10YWJsZSc6IDQyIC8gMTIsCiAgICAgICAgICAgICAgJ2NvY2t0YWlsLXRhYmxlLW1vZGVybi1taW5pbWFsaXN0JzogNDIgLyAxMiwKICAgICAgICAgICAgICAnY29ja3RhaWwtdGFibGUtbHVtaW5vdXMnOiA0MiAvIDEyLAoKICAgICAgICAgICAgICAvLyBOZXc6IHRydXNzaW5nCiAgICAgICAgICAgICAgJ3RydXNzLXN0YWdlLWxpZ2h0LXB1cnBsZSc6IDIsCiAgICAgICAgICAgICAgJ3RydXNzLXR2LXN0YW5kJzogNywKCiAgICAgICAgICAgICAgLy8gTmV3OiBzZXJ2aWNlIC8gc3RhdGlvbnMKICAgICAgICAgICAgICAnc3RhdGlvbi1mcmlkZ2Utb24td2hlZWxzJzogMy41LAogICAgICAgICAgICAgICdzdGF0aW9uLXBvcGNvcm4tY2FydCc6IDYsCiAgICAgICAgICAgICAgJ3N0YXRpb24tYXJjYWRlLXJhY2luZy1jbGFzc2ljJzogNS41LAogICAgICAgICAgICAgICdzdGF0aW9uLWFyY2FkZS1ydXNoLXJhY2luZyc6IDUuNSwKICAgICAgICAgICAgICAnc3RhdGlvbi1yYWNpbmctc2ltJzogNS41LAogICAgICAgICAgICAgICdiYXItbW9kZXJuJzogNDIgLyAxMiwKICAgICAgICAgICAgICAnYmFyLXdoaXRlLWJhY2stYmFyJzogNywKCiAgICAgICAgICAgICAgLy8gTmV3OiBkZWNvciAoaW5jbCB0YWJsZXRvcCkKICAgICAgICAgICAgICAnZGVjb3ItY2FudmFzLWVhc2VsJzogNiwKICAgICAgICAgICAgICAnZGVjb3ItY3VwY2FrZS1zdGFuZCc6IDEuNSwKICAgICAgICAgICAgICAnZGVjb3ItaGV4LXNoZWxmJzogNiwKICAgICAgICAgICAgICAnZGVjb3ItbWV0YWwtYm9va3NoZWxmJzogNiwKICAgICAgICAgICAgICAnZGVjb3ItZ29sZGVuLXNoZWx2aW5nLXVuaXQnOiA2LAogICAgICAgICAgICAgICdkZWNvci11bWJyZWxsYS1zaGFkZSc6IDgsCiAgICAgICAgICAgICAgJ2RlY29yLXN0YWdlLXN0ZXBzLWFsdW1pbnVtJzogMi41LAogICAgICAgICAgICAgICdkZWNvci1ibGVhY2hlcnMtdW5mdXJsZWQnOiA0LjUsCgogICAgICAgICAgICAgIC8vIE5ldzogbG91bmdlIC8gY291Y2gtc3R5bGUgKDMyIGluIHRhbGwpCiAgICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utc29mYS1jdXJ2ZWQtdmVsdmV0LWJsYWNrJzogMzIgLyAxMiwKICAgICAgICAgICAgICAnbW9kZXJuLWxvdW5nZS1zb2ZhLWN1cnZ5LWdyZWVuJzogMzIgLyAxMiwKICAgICAgICAgICAgICAnbW9kZXJuLWxvdW5nZS1zb2ZhLWN1cnZlZC1lbGVnYW5jZS13aGl0ZS1hJzogMzIgLyAxMiwKICAgICAgICAgICAgICAnbW9kZXJuLWxvdW5nZS1zb2ZhLWwtc2hhcGVkLW1vZGVybi1ibGFjayc6IDMyIC8gMTIsCiAgICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utc29mYS1zZWN0aW9uYWwtY3JlYW0nOiAzMiAvIDEyLAogICAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLXNvZmEtY3VydmVkLWdyZXknOiAzMiAvIDEyLAogICAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLXNvZmEtY3Jlc2NlbnQtd2hpdGUnOiAzMiAvIDEyLAogICAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLXNvZmEtY3VydmVkLWVsZWdhbmNlLXdoaXRlLWInOiAzMiAvIDEyLAogICAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLXNvZmEtY3VydmUtZ3JlZW4nOiAzMiAvIDEyLAogICAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLXNvZmEtZWxlZ2FudC1ibGFjayc6IDMyIC8gMTIsCiAgICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utc29mYS1jb3JuZXItY29tZm9ydC1ncmVlbic6IDMyIC8gMTIsCiAgICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utc29mYS1zZWN0aW9uYWwtd2hpdGUnOiAzMiAvIDEyLAogICAgICAgICAgICAgICdtb2Rlcm4tbG91bmdlLXNvZmEtY29tZm9ydC13aGl0ZSc6IDMyIC8gMTIsCiAgICAgICAgICAgICAgJ21vZGVybi1sb3VuZ2Utc29mYS1oYXJtb255LWdyZWVuJzogMzIgLyAxMiwKICAgICAgICAgICAgICAnbW9kZXJuLWxvdW5nZS1vdHRvbWFuLWN1YmUtd2hpdGUnOiAxNyAvIDEyLAoKICAgICAgICAgICAgICAvLyBPdGhlciBmb2xpYWdlCiAgICAgICAgICAgICAgJ2ZvbGlhZ2UtaGVkZ2UnOiA0LAoKICAgICAgICB9OwoKICAgICAgICAvLyBQZW9wbGUgR0xCIGxvYWRpbmcgKGUuZy4gVGhlIFJlbnRhbCBHdXkgYXZhdGFyKS4gRmFsbHMgYmFjayB0byBhIGJhc2ljIHBsYWNlaG9sZGVyLgogICAgICAgIGNvbnN0IFBFT1BMRV9HTEJfVVJMUyA9IHsKICAgICAgICAgICAgJ3BlcnNvbi10aGUtcmVudGFsLWd1eSc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC90aGVfcmVudGFsX2d1eV8wMTIwMDY0MzAzX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgJ3BlcnNvbi1ncm9vbSc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9ncm9vbV8wMTI0MDMzMTAzX3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgJ3BlcnNvbi1icmlkZSc6ICdodHRwczovL3d3dy4zMDZwYXJ0eXJlbnRhbHMuY29tL3VwbG9hZHMvMS80LzAvMy8xNDAzMzI3OC9icmlkZV8wMTI0MDM0MzE3X3RleHR1cmUuZ2xiJywKICAgICAgICAgICAgJ3BlcnNvbi1qdXN0aWNlLW9mLXBlYWNlJzogJ2h0dHBzOi8vMTQwMzMyNzgtOTMzNjkzODMxNTAxNzAyNzc1LnByZXZpZXcuZWRpdG15c2l0ZS5jb20vdXBsb2Fkcy8xLzQvMC8zLzE0MDMzMjc4L2p1c3RpY2Vfb2ZfcGVhY2VfMDEyNDAzNDQxMV90ZXh0dXJlLmdsYicsCgogICAgICAgIH07CiAgICAgICAgY29uc3QgUEVPUExFX0dMQl9UQVJHRVRfSEVJR0hUX0ZUID0gewogICAgICAgICAgICAncGVyc29uLXRoZS1yZW50YWwtZ3V5JzogNi4wLAogICAgICAgICAgICAncGVyc29uLWdyb29tJzogNiwKICAgICAgICAgICAgJ3BlcnNvbi1icmlkZSc6IDUuNDIsCiAgICAgICAgICAgICdwZXJzb24tanVzdGljZS1vZi1wZWFjZSc6IDYsCgogICAgICAgIH07CgogICAgICAgIGNvbnN0IHBlb3BsZUdsYlByb3RvQnlLZXkgPSB7fTsKICAgICAgICBjb25zdCBwZW9wbGVHbGJMb2FkU3RhcnRlZEJ5S2V5ID0ge307CgogICAgICAgIGNvbnN0IGZ1cm5pdHVyZUdsYlByb3RvQnlLZXkgPSB7fTsKICAgICAgICBjb25zdCBmdXJuaXR1cmVHbGJMb2FkU3RhcnRlZEJ5S2V5ID0ge307CgogICAgICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZUZ1cm5pdHVyZUdMQihwcm90bywga2V5KSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBwcm90by51cGRhdGVNYXRyaXhXb3JsZCh0cnVlKTsKICAgICAgICAgICAgICAgIGNvbnN0IGJveCA9IG5ldyBUSFJFRS5Cb3gzKCkuc2V0RnJvbU9iamVjdChwcm90byk7CiAgICAgICAgICAgICAgICBjb25zdCBzaXplID0gbmV3IFRIUkVFLlZlY3RvcjMoKTsKICAgICAgICAgICAgICAgIGJveC5nZXRTaXplKHNpemUpOwoKICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEggPSBGVVJOSVRVUkVfR0xCX1RBUkdFVF9IRUlHSFRfRlRba2V5XSB8fCAyLjA7CiAgICAgICAgICAgICAgICBpZiAoc2l6ZS55ICYmIHNpemUueSA+IDApIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBzYyA9IHRhcmdldEggLyBzaXplLnk7CiAgICAgICAgICAgICAgICAgICAgcHJvdG8uc2NhbGUuc2V0U2NhbGFyKHNjKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBwcm90by51cGRhdGVNYXRyaXhXb3JsZCh0cnVlKTsKICAgICAgICAgICAgICAgIGNvbnN0IGJveDIgPSBuZXcgVEhSRUUuQm94MygpLnNldEZyb21PYmplY3QocHJvdG8pOwogICAgICAgICAgICAgICAgaWYgKGJveDIubWluLnkgIT09IDApIHByb3RvLnBvc2l0aW9uLnkgLT0gYm94Mi5taW4ueTsKCiAgICAgICAgICAgICAgICBwcm90by51cGRhdGVNYXRyaXhXb3JsZCh0cnVlKTsKICAgICAgICAgICAgICAgIGNvbnN0IGJveDMgPSBuZXcgVEhSRUUuQm94MygpLnNldEZyb21PYmplY3QocHJvdG8pOwogICAgICAgICAgICAgICAgY29uc3QgY2VudGVyID0gbmV3IFRIUkVFLlZlY3RvcjMoKTsKICAgICAgICAgICAgICAgIGJveDMuZ2V0Q2VudGVyKGNlbnRlcik7CiAgICAgICAgICAgICAgICBwcm90by5wb3NpdGlvbi54IC09IGNlbnRlci54OwogICAgICAgICAgICAgICAgcHJvdG8ucG9zaXRpb24ueiAtPSBjZW50ZXIuejsKCiAgICAgICAgICAgICAgICBwcm90by50cmF2ZXJzZSgobikgPT4gewogICAgICAgICAgICAgICAgICAgIGlmIChuICYmIG4uaXNNZXNoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG4uY2FzdFNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIG4ucmVjZWl2ZVNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBub3JtYWxpemVQZW9wbGVHTEIocHJvdG8sIGtleSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcHJvdG8udXBkYXRlTWF0cml4V29ybGQodHJ1ZSk7CiAgICAgICAgICAgICAgICBjb25zdCBib3ggPSBuZXcgVEhSRUUuQm94MygpLnNldEZyb21PYmplY3QocHJvdG8pOwogICAgICAgICAgICAgICAgY29uc3Qgc2l6ZSA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7CiAgICAgICAgICAgICAgICBib3guZ2V0U2l6ZShzaXplKTsKCiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRIID0gUEVPUExFX0dMQl9UQVJHRVRfSEVJR0hUX0ZUW2tleV0gfHwgNi4wOwogICAgICAgICAgICAgICAgaWYgKHNpemUueSAmJiBzaXplLnkgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2MgPSB0YXJnZXRIIC8gc2l6ZS55OwogICAgICAgICAgICAgICAgICAgIHByb3RvLnNjYWxlLnNldFNjYWxhcihzYyk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcHJvdG8udXBkYXRlTWF0cml4V29ybGQodHJ1ZSk7CiAgICAgICAgICAgICAgICBjb25zdCBib3gyID0gbmV3IFRIUkVFLkJveDMoKS5zZXRGcm9tT2JqZWN0KHByb3RvKTsKICAgICAgICAgICAgICAgIGlmIChib3gyLm1pbi55ICE9PSAwKSBwcm90by5wb3NpdGlvbi55IC09IGJveDIubWluLnk7CgogICAgICAgICAgICAgICAgcHJvdG8udXBkYXRlTWF0cml4V29ybGQodHJ1ZSk7CiAgICAgICAgICAgICAgICBjb25zdCBib3gzID0gbmV3IFRIUkVFLkJveDMoKS5zZXRGcm9tT2JqZWN0KHByb3RvKTsKICAgICAgICAgICAgICAgIGNvbnN0IGNlbnRlciA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7CiAgICAgICAgICAgICAgICBib3gzLmdldENlbnRlcihjZW50ZXIpOwogICAgICAgICAgICAgICAgcHJvdG8ucG9zaXRpb24ueCAtPSBjZW50ZXIueDsKICAgICAgICAgICAgICAgIHByb3RvLnBvc2l0aW9uLnogLT0gY2VudGVyLno7CgogICAgICAgICAgICAgICAgcHJvdG8udHJhdmVyc2UoKG4pID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAobiAmJiBuLmlzTWVzaCkgewogICAgICAgICAgICAgICAgICAgICAgICBuLmNhc3RTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBuLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gdHVuZUZ1cm5pdHVyZUdsYk1hdGVyaWFscyhrZXksIHJvb3QpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJvb3QudHJhdmVyc2UoKG4pID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoIW4gfHwgIW4uaXNNZXNoIHx8ICFuLm1hdGVyaWFsKSByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0cyA9IEFycmF5LmlzQXJyYXkobi5tYXRlcmlhbCkgPyBuLm1hdGVyaWFsIDogW24ubWF0ZXJpYWxdOwogICAgICAgICAgICAgICAgICAgIG1hdHMuZm9yRWFjaCgobSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW0pIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG0ubWFwKSBtLm1hcC5lbmNvZGluZyA9IFRIUkVFLnNSR0JFbmNvZGluZzsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG0uZW1pc3NpdmVNYXApIG0uZW1pc3NpdmVNYXAuZW5jb2RpbmcgPSBUSFJFRS5zUkdCRW5jb2Rpbmc7CiAgICAgICAgICAgICAgICAgICAgICAgIG0uc2lkZSA9IFRIUkVFLkRvdWJsZVNpZGU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbS5tZXRhbG5lc3MgPT09ICdudW1iZXInKSBtLm1ldGFsbmVzcyA9IE1hdGgubWF4KDAsIE1hdGgubWluKG0ubWV0YWxuZXNzLCAwLjYpKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtLnJvdWdobmVzcyA9PT0gJ251bWJlcicpIG0ucm91Z2huZXNzID0gTWF0aC5tYXgobS5yb3VnaG5lc3MsIDAuNDUpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYXAgPSAwLjM1OwogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG0uZW52TWFwSW50ZW5zaXR5ID09PSAnbnVtYmVyJykgbS5lbnZNYXBJbnRlbnNpdHkgPSBNYXRoLm1pbihtLmVudk1hcEludGVuc2l0eSwgY2FwKTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBtLmVudk1hcEludGVuc2l0eSA9IGNhcDsKICAgICAgICAgICAgICAgICAgICAgICAgbS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgbi5tYXRlcmlhbCA9IEFycmF5LmlzQXJyYXkobi5tYXRlcmlhbCkgPyBtYXRzIDogbWF0c1swXTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gdHVuZVBlb3BsZUdsYk1hdGVyaWFscyhrZXksIHJvb3QpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJvb3QudHJhdmVyc2UoKG4pID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoIW4gfHwgIW4uaXNNZXNoIHx8ICFuLm1hdGVyaWFsKSByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0cyA9IEFycmF5LmlzQXJyYXkobi5tYXRlcmlhbCkgPyBuLm1hdGVyaWFsIDogW24ubWF0ZXJpYWxdOwogICAgICAgICAgICAgICAgICAgIG1hdHMuZm9yRWFjaCgobSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW0pIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG0ubWFwKSBtLm1hcC5lbmNvZGluZyA9IFRIUkVFLnNSR0JFbmNvZGluZzsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG0uZW1pc3NpdmVNYXApIG0uZW1pc3NpdmVNYXAuZW5jb2RpbmcgPSBUSFJFRS5zUkdCRW5jb2Rpbmc7CiAgICAgICAgICAgICAgICAgICAgICAgIG0uc2lkZSA9IFRIUkVFLkRvdWJsZVNpZGU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbS5tZXRhbG5lc3MgPT09ICdudW1iZXInKSBtLm1ldGFsbmVzcyA9IE1hdGgubWF4KDAsIE1hdGgubWluKG0ubWV0YWxuZXNzLCAwLjU1KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbS5yb3VnaG5lc3MgPT09ICdudW1iZXInKSBtLnJvdWdobmVzcyA9IE1hdGgubWF4KG0ucm91Z2huZXNzLCAwLjQ1KTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FwID0gMC4zNTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtLmVudk1hcEludGVuc2l0eSA9PT0gJ251bWJlcicpIG0uZW52TWFwSW50ZW5zaXR5ID0gTWF0aC5taW4obS5lbnZNYXBJbnRlbnNpdHksIGNhcCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgbS5lbnZNYXBJbnRlbnNpdHkgPSBjYXA7CiAgICAgICAgICAgICAgICAgICAgICAgIG0ubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIG4ubWF0ZXJpYWwgPSBBcnJheS5pc0FycmF5KG4ubWF0ZXJpYWwpID8gbWF0cyA6IG1hdHNbMF07CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkge30KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGFwcGx5TG9hZGVkUGVvcGxlVG9TY2VuZShrZXkpIHsKICAgICAgICAgICAgY29uc3QgcHJvdG8gPSBwZW9wbGVHbGJQcm90b0J5S2V5W2tleV07CiAgICAgICAgICAgIGlmICghcHJvdG8gfHwgIXNjZW5lKSByZXR1cm47CgogICAgICAgICAgICBjb25zdCB0YXJnZXRzID0gW107CiAgICAgICAgICAgIHNjZW5lLnRyYXZlcnNlKChvYmopID0+IHsKICAgICAgICAgICAgICAgIGlmIChvYmogJiYgb2JqLnVzZXJEYXRhICYmIG9iai51c2VyRGF0YS5pc1BlcnNvbiAmJiBvYmoudXNlckRhdGEucGVyc29uS2V5ID09PSBrZXkpIHRhcmdldHMucHVzaChvYmopOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKCF0YXJnZXRzLmxlbmd0aCkgcmV0dXJuOwoKICAgICAgICAgICAgdGFyZ2V0cy5mb3JFYWNoKChnKSA9PiB7CiAgICAgICAgICAgICAgICB3aGlsZSAoZy5jaGlsZHJlbi5sZW5ndGgpIGcucmVtb3ZlKGcuY2hpbGRyZW5bMF0pOwogICAgICAgICAgICAgICAgY29uc3QgaW5zdCA9IHByb3RvLmNsb25lKHRydWUpOwogICAgICAgICAgICAgICAgZy5hZGQoaW5zdCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZW5zdXJlUGVvcGxlR2xiTG9hZGVkKGtleSkgewogICAgICAgICAgICBjb25zdCBrID0gU3RyaW5nKGtleSB8fCAnJyk7CiAgICAgICAgICAgIGNvbnN0IHVybCA9IFBFT1BMRV9HTEJfVVJMU1trXTsKICAgICAgICAgICAgaWYgKCF1cmwpIHJldHVybjsKICAgICAgICAgICAgaWYgKHBlb3BsZUdsYlByb3RvQnlLZXlba10pIHJldHVybjsKICAgICAgICAgICAgaWYgKHBlb3BsZUdsYkxvYWRTdGFydGVkQnlLZXlba10pIHJldHVybjsKICAgICAgICAgICAgaWYgKCFUSFJFRSB8fCAhVEhSRUUuR0xURkxvYWRlcikgcmV0dXJuOwoKICAgICAgICAgICAgcGVvcGxlR2xiTG9hZFN0YXJ0ZWRCeUtleVtrXSA9IHRydWU7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCBsb2FkZXIgPSBuZXcgVEhSRUUuR0xURkxvYWRlcigpOwogICAgICAgICAgICAgICAgaWYgKGxvYWRlci5zZXRDcm9zc09yaWdpbikgbG9hZGVyLnNldENyb3NzT3JpZ2luKCdhbm9ueW1vdXMnKTsKICAgICAgICAgICAgICAgIGxvYWRlci5sb2FkKHVybCwKICAgICAgICAgICAgICAgICAgICAoZ2x0ZikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByb290ID0gKGdsdGYgJiYgKGdsdGYuc2NlbmUgfHwgKGdsdGYuc2NlbmVzICYmIGdsdGYuc2NlbmVzWzBdKSkpIHx8IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcm9vdCkgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICBub3JtYWxpemVQZW9wbGVHTEIocm9vdCwgayk7CiAgICAgICAgICAgICAgICAgICAgICAgIHR1bmVQZW9wbGVHbGJNYXRlcmlhbHMoaywgcm9vdCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHBlb3BsZUdsYlByb3RvQnlLZXlba10gPSByb290OwogICAgICAgICAgICAgICAgICAgICAgICBhcHBseUxvYWRlZFBlb3BsZVRvU2NlbmUoayk7CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgICAgICAgICAgICAgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBwZW9wbGVHbGJMb2FkU3RhcnRlZEJ5S2V5W2tdID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgcGVvcGxlR2xiTG9hZFN0YXJ0ZWRCeUtleVtrXSA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBhcHBseUxvYWRlZEZ1cm5pdHVyZVRvU2NlbmUoa2V5KSB7CiAgICAgICAgICAgIGNvbnN0IHByb3RvID0gZnVybml0dXJlR2xiUHJvdG9CeUtleVtrZXldOwogICAgICAgICAgICBpZiAoIXByb3RvIHx8ICFzY2VuZSkgcmV0dXJuOwoKICAgICAgICAgICAgY29uc3QgdGFyZ2V0cyA9IFtdOwogICAgICAgICAgICBzY2VuZS50cmF2ZXJzZSgob2JqKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAob2JqICYmIG9iai51c2VyRGF0YSAmJiBvYmoudXNlckRhdGEuaXNGdXJuaXR1cmUgJiYgb2JqLnVzZXJEYXRhLmZ1cm5pdHVyZUtleSA9PT0ga2V5KSB0YXJnZXRzLnB1c2gob2JqKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmICghdGFyZ2V0cy5sZW5ndGgpIHJldHVybjsKCiAgICAgICAgICAgIHRhcmdldHMuZm9yRWFjaCgoZykgPT4gewogICAgICAgICAgICAgICAgd2hpbGUgKGcuY2hpbGRyZW4ubGVuZ3RoKSBnLnJlbW92ZShnLmNoaWxkcmVuWzBdKTsKICAgICAgICAgICAgICAgIGNvbnN0IGluc3QgPSBwcm90by5jbG9uZSh0cnVlKTsKICAgICAgICAgICAgICAgIGcuYWRkKGluc3QpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGVuc3VyZUZ1cm5pdHVyZUdsYkxvYWRlZChrZXkpIHsKICAgICAgICAgICAgY29uc3QgayA9IFN0cmluZyhrZXkgfHwgJycpOwogICAgICAgICAgICBjb25zdCB1cmwgPSBGVVJOSVRVUkVfR0xCX1VSTFNba107CiAgICAgICAgICAgIGlmICghdXJsKSByZXR1cm47CiAgICAgICAgICAgIGlmIChmdXJuaXR1cmVHbGJQcm90b0J5S2V5W2tdKSByZXR1cm47CiAgICAgICAgICAgIGlmIChmdXJuaXR1cmVHbGJMb2FkU3RhcnRlZEJ5S2V5W2tdKSByZXR1cm47CiAgICAgICAgICAgIGlmICghVEhSRUUgfHwgIVRIUkVFLkdMVEZMb2FkZXIpIHJldHVybjsKCiAgICAgICAgICAgIGZ1cm5pdHVyZUdsYkxvYWRTdGFydGVkQnlLZXlba10gPSB0cnVlOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgbG9hZGVyID0gbmV3IFRIUkVFLkdMVEZMb2FkZXIoKTsKICAgICAgICAgICAgICAgIGlmIChsb2FkZXIuc2V0Q3Jvc3NPcmlnaW4pIGxvYWRlci5zZXRDcm9zc09yaWdpbignYW5vbnltb3VzJyk7CiAgICAgICAgICAgICAgICBsb2FkZXIubG9hZCh1cmwsCiAgICAgICAgICAgICAgICAgICAgKGdsdGYpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm9vdCA9IChnbHRmICYmIChnbHRmLnNjZW5lIHx8IChnbHRmLnNjZW5lcyAmJiBnbHRmLnNjZW5lc1swXSkpKSB8fCBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJvb3QpIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXplRnVybml0dXJlR0xCKHJvb3QsIGspOwogICAgICAgICAgICAgICAgICAgICAgICB0dW5lRnVybml0dXJlR2xiTWF0ZXJpYWxzKGssIHJvb3QpOwogICAgICAgICAgICAgICAgICAgICAgICBmdXJuaXR1cmVHbGJQcm90b0J5S2V5W2tdID0gcm9vdDsKICAgICAgICAgICAgICAgICAgICAgICAgYXBwbHlMb2FkZWRGdXJuaXR1cmVUb1NjZW5lKGspOwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkLAogICAgICAgICAgICAgICAgICAgICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgZnVybml0dXJlR2xiTG9hZFN0YXJ0ZWRCeUtleVtrXSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGZ1cm5pdHVyZUdsYkxvYWRTdGFydGVkQnlLZXlba10gPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gbm9ybWFsaXplQ2hhaXJTdHlsZShzdHlsZSkgewogICAgICAgICAgICBjb25zdCBzID0gU3RyaW5nKHN0eWxlIHx8ICdmb2xkaW5nX3doaXRlJyk7CiAgICAgICAgICAgIHJldHVybiBzID09PSAncnVzdGljX2Nyb3NzYmFja19vYWsnID8gJ3J1c3RpY19jcm9zc2JhY2snIDogczsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZUNoYWlyR0xCKHByb3RvLCBzdHlsZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcHJvdG8udXBkYXRlTWF0cml4V29ybGQodHJ1ZSk7CiAgICAgICAgICAgICAgICBjb25zdCBib3ggPSBuZXcgVEhSRUUuQm94MygpLnNldEZyb21PYmplY3QocHJvdG8pOwogICAgICAgICAgICAgICAgY29uc3Qgc2l6ZSA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7CiAgICAgICAgICAgICAgICBib3guZ2V0U2l6ZShzaXplKTsKCiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRIID0gQ0hBSVJfR0xCX1RBUkdFVF9IRUlHSFRfRlRbc3R5bGVdIHx8IDMuMDsKICAgICAgICAgICAgICAgIGlmIChzaXplLnkgJiYgc2l6ZS55ID4gMCkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjID0gdGFyZ2V0SCAvIHNpemUueTsKICAgICAgICAgICAgICAgICAgICBwcm90by5zY2FsZS5zZXRTY2FsYXIoc2MpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHByb3RvLnVwZGF0ZU1hdHJpeFdvcmxkKHRydWUpOwogICAgICAgICAgICAgICAgY29uc3QgYm94MiA9IG5ldyBUSFJFRS5Cb3gzKCkuc2V0RnJvbU9iamVjdChwcm90byk7CiAgICAgICAgICAgICAgICBpZiAoYm94Mi5taW4ueSAhPT0gMCkgcHJvdG8ucG9zaXRpb24ueSAtPSBib3gyLm1pbi55OwoKICAgICAgICAgICAgICAgIHByb3RvLnVwZGF0ZU1hdHJpeFdvcmxkKHRydWUpOwogICAgICAgICAgICAgICAgY29uc3QgYm94MyA9IG5ldyBUSFJFRS5Cb3gzKCkuc2V0RnJvbU9iamVjdChwcm90byk7CiAgICAgICAgICAgICAgICBjb25zdCBjZW50ZXIgPSBuZXcgVEhSRUUuVmVjdG9yMygpOwogICAgICAgICAgICAgICAgYm94My5nZXRDZW50ZXIoY2VudGVyKTsKICAgICAgICAgICAgICAgIHByb3RvLnBvc2l0aW9uLnggLT0gY2VudGVyLng7CiAgICAgICAgICAgICAgICBwcm90by5wb3NpdGlvbi56IC09IGNlbnRlci56OwoKICAgICAgICAgICAgICAgIHByb3RvLnRyYXZlcnNlKChuKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG4gJiYgbi5pc01lc2gpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbi5jYXN0U2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgbi5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgLy8gc3dhbGxvdwogICAgICAgICAgICB9CiAgICAgICAgfQoKCgogICAgICAgIGZ1bmN0aW9uIHR1bmVDaGFpckdsYk1hdGVyaWFscyhyZXNvbHZlZFN0eWxlLCByb290KSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCBpc1J1c3RpYyA9IHJlc29sdmVkU3R5bGUgPT09ICdydXN0aWNfY3Jvc3NiYWNrJzsKICAgICAgICAgICAgICAgIGNvbnN0IGlzUGxhc3RpYyA9IHJlc29sdmVkU3R5bGUgPT09ICdmb2xkaW5nX3doaXRlJyB8fCByZXNvbHZlZFN0eWxlID09PSAnZm9sZGluZ193aGl0ZV9jb21tZXJjaWFsJyB8fCByZXNvbHZlZFN0eWxlID09PSAnZm9sZGluZ19ibGFjaycgfHwgcmVzb2x2ZWRTdHlsZSA9PT0gJ3doaXRlX3Jlc2luX3BhZGRlZCcgfHwgcmVzb2x2ZWRTdHlsZSA9PT0gJ2JsYWNrX3BhZGRlZF9mb2xkaW5nJyB8fCByZXNvbHZlZFN0eWxlID09PSAnd2hpdGVfZmFuYmFjayc7CiAgICAgICAgICAgICAgICBjb25zdCBpc1doaXRlUGxhc3RpYyA9IHJlc29sdmVkU3R5bGUgPT09ICdmb2xkaW5nX3doaXRlJyB8fCByZXNvbHZlZFN0eWxlID09PSAnZm9sZGluZ193aGl0ZV9jb21tZXJjaWFsJyB8fCByZXNvbHZlZFN0eWxlID09PSAnd2hpdGVfcmVzaW5fcGFkZGVkJyB8fCByZXNvbHZlZFN0eWxlID09PSAnd2hpdGVfZmFuYmFjayc7CgogICAgICAgICAgICAgICAgcm9vdC50cmF2ZXJzZSgobikgPT4gewogICAgICAgICAgICAgICAgICAgIGlmICghbiB8fCAhbi5pc01lc2gpIHJldHVybjsKICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRzID0gQXJyYXkuaXNBcnJheShuLm1hdGVyaWFsKSA/IG4ubWF0ZXJpYWwgOiBbbi5tYXRlcmlhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHVuZWQgPSBtYXRzLm1hcCgobWF0KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWF0KSByZXR1cm4gbWF0OwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtID0gbWF0LmNsb25lID8gbWF0LmNsb25lKCkgOiBtYXQ7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAobS5tYXApIG0ubWFwLmVuY29kaW5nID0gVEhSRUUuc1JHQkVuY29kaW5nOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobS5lbWlzc2l2ZU1hcCkgbS5lbWlzc2l2ZU1hcC5lbmNvZGluZyA9IFRIUkVFLnNSR0JFbmNvZGluZzsKCiAgICAgICAgICAgICAgICAgICAgICAgIG0uc2lkZSA9IFRIUkVFLkRvdWJsZVNpZGU7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG0ubWV0YWxuZXNzID09PSAnbnVtYmVyJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3JpZ01ldGFsID0gbS5tZXRhbG5lc3M7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNSdXN0aWMgfHwgaXNQbGFzdGljKSBtLm1ldGFsbmVzcyA9IDAuMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9yaWdNZXRhbCA+IDAuNjUpIG0ubWV0YWxuZXNzID0gMC4yNTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgbS5tZXRhbG5lc3MgPSBNYXRoLm1heCgwLjAsIE1hdGgubWluKG9yaWdNZXRhbCwgMC40NSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbS5yb3VnaG5lc3MgPT09ICdudW1iZXInKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcmlnUm91Z2ggPSBtLnJvdWdobmVzczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZsb29yID0gKGlzUnVzdGljIHx8IGlzUGxhc3RpYykgPyAwLjc1IDogMC41NTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0ucm91Z2huZXNzID0gTWF0aC5tYXgob3JpZ1JvdWdoLCBmbG9vcik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhcCA9IChpc1J1c3RpYyB8fCBpc1BsYXN0aWMpID8gMC4yNSA6IDAuMzU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbS5lbnZNYXBJbnRlbnNpdHkgPT09ICdudW1iZXInKSBtLmVudk1hcEludGVuc2l0eSA9IE1hdGgubWluKG0uZW52TWFwSW50ZW5zaXR5LCBjYXApOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIG0uZW52TWFwSW50ZW5zaXR5ID0gY2FwOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzV2hpdGVQbGFzdGljICYmIG0uY29sb3IgJiYgIW0ubWFwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdmcgPSAobS5jb2xvci5yICsgbS5jb2xvci5nICsgbS5jb2xvci5iKSAvIDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXZnIDwgMC4xNSkgbS5jb2xvci5zZXQoMHhmYWZhZmEpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBtLm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG07CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgbi5tYXRlcmlhbCA9IEFycmF5LmlzQXJyYXkobi5tYXRlcmlhbCkgPyB0dW5lZCA6IHR1bmVkWzBdOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIGFwcGx5TG9hZGVkQ2hhaXJUb1NjZW5lKHN0eWxlKSB7CiAgICAgICAgICAgIGNvbnN0IHByb3RvID0gY2hhaXJHbGJQcm90b0J5U3R5bGVbc3R5bGVdOwogICAgICAgICAgICBpZiAoIXByb3RvIHx8ICFzY2VuZSkgcmV0dXJuOwoKICAgICAgICAgICAgY29uc3QgdGFyZ2V0cyA9IFtdOwogICAgICAgICAgICBzY2VuZS50cmF2ZXJzZSgob2JqKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAob2JqICYmIG9iai51c2VyRGF0YSAmJiBvYmoudXNlckRhdGEuaXNDaGFpciAmJiBvYmoudXNlckRhdGEuY2hhaXJTdHlsZSA9PT0gc3R5bGUpIHRhcmdldHMucHVzaChvYmopOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmICghdGFyZ2V0cy5sZW5ndGgpIHJldHVybjsKCiAgICAgICAgICAgIHRhcmdldHMuZm9yRWFjaCgoZykgPT4gewogICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHZpc3VhbCBjaGlsZHJlbiAoa2VlcCB0aGUgZ3JvdXAgaXRzZWxmIHNvIHRyYW5zZm9ybXMgcmVtYWluKQogICAgICAgICAgICAgICAgd2hpbGUgKGcuY2hpbGRyZW4ubGVuZ3RoKSBnLnJlbW92ZShnLmNoaWxkcmVuWzBdKTsKICAgICAgICAgICAgICAgIGNvbnN0IGluc3QgPSBwcm90by5jbG9uZSh0cnVlKTsKICAgICAgICAgICAgICAgIGcuYWRkKGluc3QpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGVuc3VyZUNoYWlyR2xiTG9hZGVkKHN0eWxlUmF3KSB7CiAgICAgICAgICAgIGNvbnN0IHN0eWxlID0gbm9ybWFsaXplQ2hhaXJTdHlsZShzdHlsZVJhdyk7CiAgICAgICAgICAgIGNvbnN0IHVybCA9IENIQUlSX0dMQl9VUkxTW3N0eWxlXTsKICAgICAgICAgICAgaWYgKCF1cmwpIHJldHVybjsKICAgICAgICAgICAgaWYgKGNoYWlyR2xiUHJvdG9CeVN0eWxlW3N0eWxlXSkgcmV0dXJuOwogICAgICAgICAgICBpZiAoY2hhaXJHbGJMb2FkU3RhcnRlZEJ5U3R5bGVbc3R5bGVdKSByZXR1cm47CiAgICAgICAgICAgIGlmICghVEhSRUUgfHwgIVRIUkVFLkdMVEZMb2FkZXIpIHJldHVybjsKCiAgICAgICAgICAgIGNoYWlyR2xiTG9hZFN0YXJ0ZWRCeVN0eWxlW3N0eWxlXSA9IHRydWU7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCBsb2FkZXIgPSBuZXcgVEhSRUUuR0xURkxvYWRlcigpOwogICAgICAgICAgICAgICAgaWYgKGxvYWRlci5zZXRDcm9zc09yaWdpbikgbG9hZGVyLnNldENyb3NzT3JpZ2luKCdhbm9ueW1vdXMnKTsKICAgICAgICAgICAgICAgIGxvYWRlci5sb2FkKHVybCwKICAgICAgICAgICAgICAgICAgICAoZ2x0ZikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByb290ID0gKGdsdGYgJiYgKGdsdGYuc2NlbmUgfHwgKGdsdGYuc2NlbmVzICYmIGdsdGYuc2NlbmVzWzBdKSkpIHx8IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcm9vdCkgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICBub3JtYWxpemVDaGFpckdMQihyb290LCBzdHlsZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHR1bmVDaGFpckdsYk1hdGVyaWFscyhzdHlsZSwgcm9vdCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoYWlyR2xiUHJvdG9CeVN0eWxlW3N0eWxlXSA9IHJvb3Q7CiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGx5TG9hZGVkQ2hhaXJUb1NjZW5lKHN0eWxlKTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCwKICAgICAgICAgICAgICAgICAgICAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFsbG93IHJldHJ5IG9uIGhhcmQgZmFpbHVyZQogICAgICAgICAgICAgICAgICAgICAgICBjaGFpckdsYkxvYWRTdGFydGVkQnlTdHlsZVtzdHlsZV0gPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICBjaGFpckdsYkxvYWRTdGFydGVkQnlTdHlsZVtzdHlsZV0gPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29uc3QgY2hhaXJQcm90b0NhY2hlID0gbmV3IE1hcCgpOwoKICAgICAgICBmdW5jdGlvbiBidWlsZENoYWlyUHJvdG90eXBlKHN0eWxlLCBjdXNoaW9uT24pIHsKICAgICAgICAgICAgY29uc3QgZyA9IG5ldyBUSFJFRS5Hcm91cCgpOwogICAgICAgICAgICBjb25zdCBzZWF0SCA9IDEuNjsKICAgICAgICAgICAgY29uc3QgdyA9IDEuMjU7CiAgICAgICAgICAgIGNvbnN0IGQgPSAxLjE1OwoKICAgICAgICAgICAgY29uc3QgbWV0YWxMaWdodCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweDljYTNhZiwgbWV0YWxuZXNzOiAwLjQ1LCByb3VnaG5lc3M6IDAuNSB9KTsKICAgICAgICAgICAgY29uc3QgbWV0YWxEYXJrICA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweDExMTgyNywgbWV0YWxuZXNzOiAwLjU1LCByb3VnaG5lc3M6IDAuNDUgfSk7CiAgICAgICAgICAgIGNvbnN0IHBsYXN0aWNXaGl0ZSA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweGY4ZmFmYywgcm91Z2huZXNzOiAwLjg1LCBtZXRhbG5lc3M6IDAuMCB9KTsKICAgICAgICAgICAgY29uc3QgcGxhc3RpY0JsYWNrID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4MGIwZjE2LCByb3VnaG5lc3M6IDAuNywgbWV0YWxuZXNzOiAwLjA1IH0pOwoKICAgICAgICAgICAgY29uc3Qgd2FybU9hayA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweGIwN2E0YSwgcm91Z2huZXNzOiAwLjg1LCBtZXRhbG5lc3M6IDAuMDUgfSk7CiAgICAgICAgICAgIGNvbnN0IG9ha1NlYXQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogMHhjMDg5NWQsIHJvdWdobmVzczogMC45LCBtZXRhbG5lc3M6IDAuMDMgfSk7CgogICAgICAgICAgICBjb25zdCBjaGlhdmFyaUdvbGQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogMHhkNGIyNGMsIHJvdWdobmVzczogMC41LCBtZXRhbG5lc3M6IDAuMjUgfSk7CiAgICAgICAgICAgIGNvbnN0IGNoaWF2YXJpU2lsdmVyID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4ZDFkNWRiLCByb3VnaG5lc3M6IDAuMzUsIG1ldGFsbmVzczogMC44IH0pOwogICAgICAgICAgICBjb25zdCBjaGlhdmFyaVdoaXRlID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4ZjhmYWZjLCByb3VnaG5lc3M6IDAuODUsIG1ldGFsbmVzczogMC4wNSB9KTsKICAgICAgICAgICAgY29uc3QgY3VzaGlvbldoaXRlID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4ZjhmYWZjLCByb3VnaG5lc3M6IDAuOTUsIG1ldGFsbmVzczogMC4wIH0pOwoKICAgICAgICAgICAgZnVuY3Rpb24gdHViZShsZW4sIHIsIG1hdCkgewogICAgICAgICAgICAgICAgY29uc3QgbSA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KHIsIHIsIGxlbiwgMTApLCBtYXQpOwogICAgICAgICAgICAgICAgbS5jYXN0U2hhZG93ID0gdHJ1ZTsgbS5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHJldHVybiBtOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc3R5bGUgPT09ICdmb2xkaW5nX3doaXRlJyB8fCBzdHlsZSA9PT0gJ2ZvbGRpbmdfd2hpdGVfY29tbWVyY2lhbCcgfHwgc3R5bGUgPT09ICdmb2xkaW5nX2JsYWNrJykgewogICAgICAgICAgICAgICAgY29uc3Qgc3R5bGVLZXkgPSBzdHlsZSB8fCAnZm9sZGluZ193aGl0ZSc7CiAgICAgICAgICAgICAgICBjb25zdCBpc0JsYWNrID0gc3R5bGVLZXkgPT09ICdmb2xkaW5nX2JsYWNrJzsKICAgICAgICAgICAgICAgIGNvbnN0IGlzQ29tbWVyY2lhbCA9IHN0eWxlS2V5ID09PSAnZm9sZGluZ193aGl0ZV9jb21tZXJjaWFsJzsKCiAgICAgICAgICAgICAgICAvLyBSZWZlcmVuY2UgZGltZW5zaW9ucyAoZmVldCkgZnJvbSBjaGFpciBzcGVjIGltYWdlOiAzMS41IiBILCAxNy41IiBXLCAxOCIgRAogICAgICAgICAgICAgICAgY29uc3Qgb3ZlcmFsbEggPSAyLjYyNTsKICAgICAgICAgICAgICAgIGNvbnN0IG92ZXJhbGxXID0gMTcuNSAvIDEyOwogICAgICAgICAgICAgICAgY29uc3Qgb3ZlcmFsbEQgPSAxOCAvIDEyOwoKICAgICAgICAgICAgICAgIGNvbnN0IHR1YmVSMiA9IDAuMDQ7CiAgICAgICAgICAgICAgICBjb25zdCBzZWF0VGggPSAwLjA1NTsKICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tUaCA9IDAuMDU1OwogICAgICAgICAgICAgICAgY29uc3Qgc2VhdFkgPSAxLjQ2OwogICAgICAgICAgICAgICAgY29uc3Qgc2VhdFogPSAwLjEwOwoKICAgICAgICAgICAgICAgIGNvbnN0IGZyYW1lQ29sb3IgPSBpc0JsYWNrID8gMHgwYjBmMTYgOiAoaXNDb21tZXJjaWFsID8gMHhiMGI4YzIgOiAweGY4ZmFmYyk7CiAgICAgICAgICAgICAgICBjb25zdCBmcmFtZU1hdCA9IG5ldyBUSFJFRS5NZXNoUGh5c2ljYWxNYXRlcmlhbCh7CiAgICAgICAgICAgICAgICAgICAgY29sb3I6IGZyYW1lQ29sb3IsCiAgICAgICAgICAgICAgICAgICAgbWV0YWxuZXNzOiBpc0JsYWNrID8gMC4xNCA6IDAuMTAsCiAgICAgICAgICAgICAgICAgICAgcm91Z2huZXNzOiBpc0JsYWNrID8gMC41NSA6IChpc0NvbW1lcmNpYWwgPyAwLjcyIDogMC43OCksCiAgICAgICAgICAgICAgICAgICAgY2xlYXJjb2F0OiAwLjEyLAogICAgICAgICAgICAgICAgICAgIGNsZWFyY29hdFJvdWdobmVzczogMC44NSwKICAgICAgICAgICAgICAgICAgICBlbnZNYXBJbnRlbnNpdHk6IDAuMTgsCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGNvbnN0IGJvbHRNYXQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogMHgxMTExMTEsIG1ldGFsbmVzczogMC43NSwgcm91Z2huZXNzOiAwLjMsIGVudk1hcEludGVuc2l0eTogMC4zIH0pOwogICAgICAgICAgICAgICAgY29uc3QgZm9vdE1hdCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweDBiMGYxNiwgbWV0YWxuZXNzOiAwLjA1LCByb3VnaG5lc3M6IDAuODUgfSk7CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gbWFrZU5vaXNlVGV4dHVyZShzZWVkLCBzaXplLCBiYXNlLCByYW5nZSkgewogICAgICAgICAgICAgICAgICAgIHNpemUgPSBzaXplIHx8IDY0OwogICAgICAgICAgICAgICAgICAgIGJhc2UgPSAoYmFzZSA9PSBudWxsID8gMjEwIDogYmFzZSk7CiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSAocmFuZ2UgPT0gbnVsbCA/IDM1IDogcmFuZ2UpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IGNhbnZhcy5oZWlnaHQgPSBzaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICAgICAgICAgICAgICAgIGlmICghY3R4KSByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbWcgPSBjdHguY3JlYXRlSW1hZ2VEYXRhKHNpemUsIHNpemUpOwogICAgICAgICAgICAgICAgICAgIGxldCBzID0gKHNlZWQgfCAwKSB8fCAxOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJuZCA9ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgcyBePSAocyA8PCAxMykgJiAweGZmZmZmZmZmOwogICAgICAgICAgICAgICAgICAgICAgICBzIF49IChzID4+IDE3KSAmIDB4ZmZmZmZmZmY7CiAgICAgICAgICAgICAgICAgICAgICAgIHMgXj0gKHMgPDwgNSkgJiAweGZmZmZmZmZmOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChzID4+PiAwKSAvIDQyOTQ5NjcyOTUpOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbWcuZGF0YS5sZW5ndGg7IGkgKz0gNCkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2ID0gYmFzZSArIE1hdGguZmxvb3Iocm5kKCkgKiByYW5nZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5kYXRhW2kgKyAwXSA9IHY7CiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5kYXRhW2kgKyAxXSA9IHY7CiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5kYXRhW2kgKyAyXSA9IHY7CiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5kYXRhW2kgKyAzXSA9IDI1NTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY3R4LnB1dEltYWdlRGF0YShpbWcsIDAsIDApOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRleCA9IG5ldyBUSFJFRS5DYW52YXNUZXh0dXJlKGNhbnZhcyk7CiAgICAgICAgICAgICAgICAgICAgdGV4LndyYXBTID0gdGV4LndyYXBUID0gVEhSRUUuUmVwZWF0V3JhcHBpbmc7CiAgICAgICAgICAgICAgICAgICAgdGV4LnJlcGVhdC5zZXQoNiwgNik7CiAgICAgICAgICAgICAgICAgICAgdGV4Lm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnN0IHJvdWdoVGV4ID0gbWFrZU5vaXNlVGV4dHVyZShpc0JsYWNrID8gMTAxIDogMjAyLCA2NCwgMjA1LCA0NSk7CgogICAgICAgICAgICAgICAgY29uc3QgcGxhc3RpY0NvbG9yID0gaXNCbGFjayA/IDB4MGIwZjE2IDogMHhmYWZhZmE7CiAgICAgICAgICAgICAgICBjb25zdCBwbGFzdGljSW5zZXQgPSBpc0JsYWNrID8gMHgwZjE3MmEgOiAweGYxZjVmOTsKCiAgICAgICAgICAgICAgICBjb25zdCBwbGFzdGljTWF0ID0gbmV3IFRIUkVFLk1lc2hQaHlzaWNhbE1hdGVyaWFsKHsKICAgICAgICAgICAgICAgICAgICBjb2xvcjogcGxhc3RpY0NvbG9yLAogICAgICAgICAgICAgICAgICAgIHJvdWdobmVzczogaXNCbGFjayA/IDAuODYgOiAwLjkwLAogICAgICAgICAgICAgICAgICAgIG1ldGFsbmVzczogMC4wMiwKICAgICAgICAgICAgICAgICAgICByb3VnaG5lc3NNYXA6IHJvdWdoVGV4IHx8IHVuZGVmaW5lZCwKICAgICAgICAgICAgICAgICAgICBjbGVhcmNvYXQ6IGlzQmxhY2sgPyAwLjA4IDogMC4xNiwKICAgICAgICAgICAgICAgICAgICBjbGVhcmNvYXRSb3VnaG5lc3M6IGlzQmxhY2sgPyAwLjc1IDogMC42NSwKICAgICAgICAgICAgICAgICAgICBlbnZNYXBJbnRlbnNpdHk6IDAuMTQsCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGNvbnN0IHBsYXN0aWNJbnNldE1hdCA9IG5ldyBUSFJFRS5NZXNoUGh5c2ljYWxNYXRlcmlhbCh7CiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHBsYXN0aWNJbnNldCwKICAgICAgICAgICAgICAgICAgICByb3VnaG5lc3M6IGlzQmxhY2sgPyAwLjgyIDogMC44NiwKICAgICAgICAgICAgICAgICAgICBtZXRhbG5lc3M6IDAuMDIsCiAgICAgICAgICAgICAgICAgICAgcm91Z2huZXNzTWFwOiByb3VnaFRleCB8fCB1bmRlZmluZWQsCiAgICAgICAgICAgICAgICAgICAgY2xlYXJjb2F0OiBpc0JsYWNrID8gMC4wNiA6IDAuMTIsCiAgICAgICAgICAgICAgICAgICAgY2xlYXJjb2F0Um91Z2huZXNzOiBpc0JsYWNrID8gMC43OCA6IDAuNzAsCiAgICAgICAgICAgICAgICAgICAgZW52TWFwSW50ZW5zaXR5OiAwLjE0LAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gcm91bmRlZFJlY3RTaGFwZSh3MiwgZDIsIHIyKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcnIgPSBNYXRoLm1heCgwLjAxLCBNYXRoLm1pbihyMiwgTWF0aC5taW4odzIsIGQyKSAvIDMpKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbmV3IFRIUkVFLlNoYXBlKCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgeCA9IC13MiAvIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgeSA9IC1kMiAvIDI7CiAgICAgICAgICAgICAgICAgICAgcy5tb3ZlVG8oeCArIHJyLCB5KTsKICAgICAgICAgICAgICAgICAgICBzLmxpbmVUbyh4ICsgdzIgLSByciwgeSk7CiAgICAgICAgICAgICAgICAgICAgcy5xdWFkcmF0aWNDdXJ2ZVRvKHggKyB3MiwgeSwgeCArIHcyLCB5ICsgcnIpOwogICAgICAgICAgICAgICAgICAgIHMubGluZVRvKHggKyB3MiwgeSArIGQyIC0gcnIpOwogICAgICAgICAgICAgICAgICAgIHMucXVhZHJhdGljQ3VydmVUbyh4ICsgdzIsIHkgKyBkMiwgeCArIHcyIC0gcnIsIHkgKyBkMik7CiAgICAgICAgICAgICAgICAgICAgcy5saW5lVG8oeCArIHJyLCB5ICsgZDIpOwogICAgICAgICAgICAgICAgICAgIHMucXVhZHJhdGljQ3VydmVUbyh4LCB5ICsgZDIsIHgsIHkgKyBkMiAtIHJyKTsKICAgICAgICAgICAgICAgICAgICBzLmxpbmVUbyh4LCB5ICsgcnIpOwogICAgICAgICAgICAgICAgICAgIHMucXVhZHJhdGljQ3VydmVUbyh4LCB5LCB4ICsgcnIsIHkpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBzOwogICAgICAgICAgICAgICAgfQoKCiAgICAgICAgICAgICAgICBmdW5jdGlvbiByb3VuZGVkUmVjdFBhdGgodzIsIGQyLCByMiwgY3gsIGN5KSB7CiAgICAgICAgICAgICAgICAgICAgY3ggPSBjeCB8fCAwOwogICAgICAgICAgICAgICAgICAgIGN5ID0gY3kgfHwgMDsKICAgICAgICAgICAgICAgICAgICBjb25zdCByciA9IE1hdGgubWF4KDAuMDEsIE1hdGgubWluKHIyLCBNYXRoLm1pbih3MiwgZDIpIC8gMykpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHAgPSBuZXcgVEhSRUUuUGF0aCgpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHggPSAtdzIgLyAyICsgY3g7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgeSA9IC1kMiAvIDIgKyBjeTsKICAgICAgICAgICAgICAgICAgICBwLm1vdmVUbyh4ICsgcnIsIHkpOwogICAgICAgICAgICAgICAgICAgIHAubGluZVRvKHggKyB3MiAtIHJyLCB5KTsKICAgICAgICAgICAgICAgICAgICBwLnF1YWRyYXRpY0N1cnZlVG8oeCArIHcyLCB5LCB4ICsgdzIsIHkgKyBycik7CiAgICAgICAgICAgICAgICAgICAgcC5saW5lVG8oeCArIHcyLCB5ICsgZDIgLSBycik7CiAgICAgICAgICAgICAgICAgICAgcC5xdWFkcmF0aWNDdXJ2ZVRvKHggKyB3MiwgeSArIGQyLCB4ICsgdzIgLSByciwgeSArIGQyKTsKICAgICAgICAgICAgICAgICAgICBwLmxpbmVUbyh4ICsgcnIsIHkgKyBkMik7CiAgICAgICAgICAgICAgICAgICAgcC5xdWFkcmF0aWNDdXJ2ZVRvKHgsIHkgKyBkMiwgeCwgeSArIGQyIC0gcnIpOwogICAgICAgICAgICAgICAgICAgIHAubGluZVRvKHgsIHkgKyBycik7CiAgICAgICAgICAgICAgICAgICAgcC5xdWFkcmF0aWNDdXJ2ZVRvKHgsIHksIHggKyByciwgeSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHA7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gYXBwbHlEaXNoKGdlbywgdzIsIGQyLCB0aGlja25lc3MsIGRpcCkgewogICAgICAgICAgICAgICAgICAgIGdlby5jb21wdXRlQm91bmRpbmdCb3goKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXhZID0gZ2VvLmJvdW5kaW5nQm94Lm1heC55OwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvcyA9IGdlby5hdHRyaWJ1dGVzLnBvc2l0aW9uOwogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcG9zLmNvdW50OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeCA9IHBvcy5nZXRYKGkpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB5ID0gcG9zLmdldFkoaSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHogPSBwb3MuZ2V0WihpKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHkgPCBtYXhZIC0gdGhpY2tuZXNzICogMC41NSkgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG54ID0geCAvICh3MiAvIDIpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBueiA9IHogLyAoZDIgLyAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgclNxID0gTWF0aC5taW4oMSwgbnggKiBueCArIG56ICogbnopOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmYWxsID0gTWF0aC5tYXgoMCwgMSAtIHJTcSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvcy5zZXRZKGksIHkgLSBkaXAgKiBmYWxsKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcG9zLm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBnZW8uY29tcHV0ZVZlcnRleE5vcm1hbHMoKTsKICAgICAgICAgICAgICAgIH0KCgogICAgICAgICAgICAgICAgZnVuY3Rpb24gYXBwbHlCYWNrQ3VydmUoZ2VvLCB3MiwgYW1vdW50KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcG9zID0gZ2VvLmF0dHJpYnV0ZXMucG9zaXRpb247CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3MuY291bnQ7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB4ID0gcG9zLmdldFgoaSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHogPSBwb3MuZ2V0WihpKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnggPSB4IC8gKHcyIC8gMik7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJvdyA9IChueCAqIG54KSAqIGFtb3VudDsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zLnNldFooaSwgeiArIGJvdyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHBvcy5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgZ2VvLmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gdHViZUJldHdlZW4oYSwgYiwgcjIsIG1hdCwgcmFkaWFsU2VncykgewogICAgICAgICAgICAgICAgICAgIHJhZGlhbFNlZ3MgPSByYWRpYWxTZWdzIHx8IDIwOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpciA9IG5ldyBUSFJFRS5WZWN0b3IzKCkuc3ViVmVjdG9ycyhiLCBhKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBsZW4gPSBkaXIubGVuZ3RoKCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2VvID0gbmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkocjIsIHIyLCBsZW4sIHJhZGlhbFNlZ3MpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IG0gPSBuZXcgVEhSRUUuTWVzaChnZW8sIG1hdCk7CiAgICAgICAgICAgICAgICAgICAgbS5wb3NpdGlvbi5jb3B5KGEpLmFkZFNjYWxlZFZlY3RvcihkaXIsIDAuNSk7CiAgICAgICAgICAgICAgICAgICAgbS5xdWF0ZXJuaW9uLnNldEZyb21Vbml0VmVjdG9ycyhuZXcgVEhSRUUuVmVjdG9yMygwLCAxLCAwKSwgZGlyLm5vcm1hbGl6ZSgpKTsKICAgICAgICAgICAgICAgICAgICBtLmNhc3RTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIG0ucmVjZWl2ZVNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG07CiAgICAgICAgICAgICAgICB9CgoKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHR1YmVDdXJ2ZShwb2ludHMsIHIyLCBtYXQsIHR1YnVsYXJTZWdzLCByYWRpYWxTZWdzKSB7CiAgICAgICAgICAgICAgICAgICAgdHVidWxhclNlZ3MgPSB0dWJ1bGFyU2VncyB8fCA0ODsKICAgICAgICAgICAgICAgICAgICByYWRpYWxTZWdzID0gcmFkaWFsU2VncyB8fCAyMDsKICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJ2ZSA9IG5ldyBUSFJFRS5DYXRtdWxsUm9tQ3VydmUzKHBvaW50cyk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2VvID0gbmV3IFRIUkVFLlR1YmVHZW9tZXRyeShjdXJ2ZSwgdHVidWxhclNlZ3MsIHIyLCByYWRpYWxTZWdzLCBmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbSA9IG5ldyBUSFJFRS5NZXNoKGdlbywgbWF0KTsKICAgICAgICAgICAgICAgICAgICBtLmNhc3RTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIG0ucmVjZWl2ZVNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gU2VhdAogICAgICAgICAgICAgICAgY29uc3Qgc1cgPSBvdmVyYWxsVyAqIDAuOTc7CiAgICAgICAgICAgICAgICBjb25zdCBzRCA9IG92ZXJhbGxEICogMC44NDsKCiAgICAgICAgICAgICAgICBjb25zdCBzZWF0R2VvID0gbmV3IFRIUkVFLkV4dHJ1ZGVHZW9tZXRyeShyb3VuZGVkUmVjdFNoYXBlKHNXLCBzRCwgMC4xNiksIHsKICAgICAgICAgICAgICAgICAgICBkZXB0aDogc2VhdFRoLAogICAgICAgICAgICAgICAgICAgIHN0ZXBzOiAxLAogICAgICAgICAgICAgICAgICAgIGJldmVsRW5hYmxlZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBiZXZlbFRoaWNrbmVzczogMC4wMTUsCiAgICAgICAgICAgICAgICAgICAgYmV2ZWxTaXplOiAwLjA0LAogICAgICAgICAgICAgICAgICAgIGJldmVsU2VnbWVudHM6IDYsCiAgICAgICAgICAgICAgICAgICAgY3VydmVTZWdtZW50czogMjQsCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHNlYXRHZW8udHJhbnNsYXRlKDAsIDAsIC1zZWF0VGggLyAyKTsKICAgICAgICAgICAgICAgIHNlYXRHZW8ucm90YXRlWCgtTWF0aC5QSSAvIDIpOwogICAgICAgICAgICAgICAgc2VhdEdlby50cmFuc2xhdGUoMCwgc2VhdFksIHNlYXRaKTsKICAgICAgICAgICAgICAgIGFwcGx5RGlzaChzZWF0R2VvLCBzVywgc0QsIHNlYXRUaCwgMC4wNDUpOwogICAgICAgICAgICAgICAgY29uc3Qgc2VhdCA9IG5ldyBUSFJFRS5NZXNoKHNlYXRHZW8sIHBsYXN0aWNNYXQpOwogICAgICAgICAgICAgICAgc2VhdC5jYXN0U2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHNlYXQucmVjZWl2ZVNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICBnLmFkZChzZWF0KTsKCiAgICAgICAgICAgICAgICBjb25zdCBzZWF0SW5zZXRHZW8gPSBuZXcgVEhSRUUuRXh0cnVkZUdlb21ldHJ5KHJvdW5kZWRSZWN0U2hhcGUoc1cgLSAwLjE0LCBzRCAtIDAuMTQsIDAuMTIpLCB7CiAgICAgICAgICAgICAgICAgICAgZGVwdGg6IDAuMDEyLAogICAgICAgICAgICAgICAgICAgIHN0ZXBzOiAxLAogICAgICAgICAgICAgICAgICAgIGJldmVsRW5hYmxlZDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgY3VydmVTZWdtZW50czogMTgsCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHNlYXRJbnNldEdlby50cmFuc2xhdGUoMCwgMCwgLTAuMDEyIC8gMik7CiAgICAgICAgICAgICAgICBzZWF0SW5zZXRHZW8ucm90YXRlWCgtTWF0aC5QSSAvIDIpOwogICAgICAgICAgICAgICAgc2VhdEluc2V0R2VvLnRyYW5zbGF0ZSgwLCBzZWF0WSArIHNlYXRUaCAqIDAuMjgsIHNlYXRaKTsKICAgICAgICAgICAgICAgIGFwcGx5RGlzaChzZWF0SW5zZXRHZW8sIHNXIC0gMC4xNCwgc0QgLSAwLjE0LCAwLjAxMiwgMC4wMyk7CiAgICAgICAgICAgICAgICBjb25zdCBzZWF0SW5zZXRNZXNoID0gbmV3IFRIUkVFLk1lc2goc2VhdEluc2V0R2VvLCBwbGFzdGljSW5zZXRNYXQpOwogICAgICAgICAgICAgICAgc2VhdEluc2V0TWVzaC5jYXN0U2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHNlYXRJbnNldE1lc2gucmVjZWl2ZVNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICBnLmFkZChzZWF0SW5zZXRNZXNoKTsKCiAgICAgICAgICAgICAgICAvLyBCYWNrcmVzdCAobW9sZGVkIHBsYXN0aWM6IGhhbmRsZSBjdXRvdXQgKyBzdWJ0bGUgd3JhcCBjdXJ2ZSkKICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tXID0gc1cgKiAxLjAyOwogICAgICAgICAgICAgICAgY29uc3QgYmFja0ggPSAwLjYwOwogICAgICAgICAgICAgICAgY29uc3QgYmFja1ogPSAtKG92ZXJhbGxEIC8gMikgKyAwLjM0OwogICAgICAgICAgICAgICAgY29uc3QgYmFja1kgPSBvdmVyYWxsSCAtIDAuNDA7CgogICAgICAgICAgICAgICAgY29uc3QgaGFuZGxlVyA9IGJhY2tXICogMC41MjsKICAgICAgICAgICAgICAgIGNvbnN0IGhhbmRsZUggPSBiYWNrSCAqIDAuMTk7CiAgICAgICAgICAgICAgICBjb25zdCBoYW5kbGVSID0gMC4wNjsKICAgICAgICAgICAgICAgIGNvbnN0IGhhbmRsZUNZID0gYmFja0ggKiAwLjE2OwoKICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tTaGFwZSA9IHJvdW5kZWRSZWN0U2hhcGUoYmFja1csIGJhY2tILCAwLjE4KTsKICAgICAgICAgICAgICAgIGJhY2tTaGFwZS5ob2xlcy5wdXNoKHJvdW5kZWRSZWN0UGF0aChoYW5kbGVXLCBoYW5kbGVILCBoYW5kbGVSLCAwLCBoYW5kbGVDWSkpOwoKICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tHZW8gPSBuZXcgVEhSRUUuRXh0cnVkZUdlb21ldHJ5KGJhY2tTaGFwZSwgewogICAgICAgICAgICAgICAgICAgIGRlcHRoOiBiYWNrVGgsCiAgICAgICAgICAgICAgICAgICAgc3RlcHM6IDEsCiAgICAgICAgICAgICAgICAgICAgYmV2ZWxFbmFibGVkOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGJldmVsVGhpY2tuZXNzOiAwLjAxMiwKICAgICAgICAgICAgICAgICAgICBiZXZlbFNpemU6IDAuMDM1LAogICAgICAgICAgICAgICAgICAgIGJldmVsU2VnbWVudHM6IDYsCiAgICAgICAgICAgICAgICAgICAgY3VydmVTZWdtZW50czogMjQsCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGJhY2tHZW8udHJhbnNsYXRlKDAsIDAsIC1iYWNrVGggLyAyKTsKICAgICAgICAgICAgICAgIGFwcGx5QmFja0N1cnZlKGJhY2tHZW8sIGJhY2tXLCAwLjA1KTsKCiAgICAgICAgICAgICAgICBjb25zdCBiYWNrID0gbmV3IFRIUkVFLk1lc2goYmFja0dlbywgcGxhc3RpY01hdCk7CiAgICAgICAgICAgICAgICBiYWNrLnBvc2l0aW9uLnNldCgwLCBiYWNrWSwgYmFja1opOwogICAgICAgICAgICAgICAgYmFjay5yb3RhdGlvbi54ID0gMC4yMjsKICAgICAgICAgICAgICAgIGJhY2suY2FzdFNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICBiYWNrLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgZy5hZGQoYmFjayk7CgogICAgICAgICAgICAgICAgY29uc3QgYmFja0luc2V0U2hhcGUgPSByb3VuZGVkUmVjdFNoYXBlKGJhY2tXIC0gMC4xNCwgYmFja0ggLSAwLjEyLCAwLjE0KTsKICAgICAgICAgICAgICAgIGJhY2tJbnNldFNoYXBlLmhvbGVzLnB1c2gocm91bmRlZFJlY3RQYXRoKGhhbmRsZVcgLSAwLjEwLCBoYW5kbGVIIC0gMC4wNiwgTWF0aC5tYXgoMC4wNCwgaGFuZGxlUiAtIDAuMDIpLCAwLCBoYW5kbGVDWSkpOwoKICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tJbnNldEdlbyA9IG5ldyBUSFJFRS5FeHRydWRlR2VvbWV0cnkoYmFja0luc2V0U2hhcGUsIHsKICAgICAgICAgICAgICAgICAgICBkZXB0aDogMC4wMTIsCiAgICAgICAgICAgICAgICAgICAgc3RlcHM6IDEsCiAgICAgICAgICAgICAgICAgICAgYmV2ZWxFbmFibGVkOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBjdXJ2ZVNlZ21lbnRzOiAxOCwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgYmFja0luc2V0R2VvLnRyYW5zbGF0ZSgwLCAwLCAtMC4wMTIgLyAyKTsKICAgICAgICAgICAgICAgIGFwcGx5QmFja0N1cnZlKGJhY2tJbnNldEdlbywgYmFja1cgLSAwLjE0LCAwLjA1KTsKCiAgICAgICAgICAgICAgICBjb25zdCBiYWNrSW5zZXRNZXNoID0gbmV3IFRIUkVFLk1lc2goYmFja0luc2V0R2VvLCBwbGFzdGljSW5zZXRNYXQpOwogICAgICAgICAgICAgICAgYmFja0luc2V0TWVzaC5wb3NpdGlvbi5jb3B5KGJhY2sucG9zaXRpb24pOwogICAgICAgICAgICAgICAgYmFja0luc2V0TWVzaC5yb3RhdGlvbi5jb3B5KGJhY2sucm90YXRpb24pOwogICAgICAgICAgICAgICAgYmFja0luc2V0TWVzaC50cmFuc2xhdGVaKGJhY2tUaCAqIDAuNTUpOwogICAgICAgICAgICAgICAgYmFja0luc2V0TWVzaC5jYXN0U2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJhY2tJbnNldE1lc2gucmVjZWl2ZVNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICBnLmFkZChiYWNrSW5zZXRNZXNoKTsKCiAgICAgICAgICAgICAgICAvLyBGcmFtZSB0dWJlcwogICAgICAgICAgICAgICAgY29uc3QgeExlZyA9IG92ZXJhbGxXIC8gMiAtIDAuMTA7CiAgICAgICAgICAgICAgICBjb25zdCB6RnJvbnQgPSBvdmVyYWxsRCAvIDIgLSAwLjEyOwogICAgICAgICAgICAgICAgY29uc3QgekJhY2sgPSAtb3ZlcmFsbEQgLyAyICsgMC4xMjsKCiAgICAgICAgICAgICAgICBjb25zdCBmbDAgPSBuZXcgVEhSRUUuVmVjdG9yMygteExlZywgMC4wMiwgekZyb250KTsKICAgICAgICAgICAgICAgIGNvbnN0IGZyMCA9IG5ldyBUSFJFRS5WZWN0b3IzKHhMZWcsIDAuMDIsIHpGcm9udCk7CiAgICAgICAgICAgICAgICBjb25zdCBibDAgPSBuZXcgVEhSRUUuVmVjdG9yMygteExlZywgMC4wMiwgekJhY2spOwogICAgICAgICAgICAgICAgY29uc3QgYnIwID0gbmV3IFRIUkVFLlZlY3RvcjMoeExlZywgMC4wMiwgekJhY2spOwoKICAgICAgICAgICAgICAgIGNvbnN0IGZsMSA9IG5ldyBUSFJFRS5WZWN0b3IzKC14TGVnLCBzZWF0WSArIDAuMTAsIHpGcm9udCAtIDAuMjApOwogICAgICAgICAgICAgICAgY29uc3QgZnIxID0gbmV3IFRIUkVFLlZlY3RvcjMoeExlZywgc2VhdFkgKyAwLjEwLCB6RnJvbnQgLSAwLjIwKTsKICAgICAgICAgICAgICAgIGNvbnN0IGJsMSA9IG5ldyBUSFJFRS5WZWN0b3IzKC14TGVnLCBvdmVyYWxsSCAtIDAuMTAsIHpCYWNrICsgMC4xNSk7CiAgICAgICAgICAgICAgICBjb25zdCBicjEgPSBuZXcgVEhSRUUuVmVjdG9yMyh4TGVnLCBvdmVyYWxsSCAtIDAuMTAsIHpCYWNrICsgMC4xNSk7CgogICAgICAgICAgICAgICAgZy5hZGQodHViZUN1cnZlKFtmbDAsIG5ldyBUSFJFRS5WZWN0b3IzKC14TGVnLCBzZWF0WSAqIDAuNjAsIHpGcm9udCAtIDAuMDUpLCBmbDFdLCB0dWJlUjIsIGZyYW1lTWF0LCA1MiwgMjIpKTsKICAgICAgICAgICAgICAgIGcuYWRkKHR1YmVDdXJ2ZShbZnIwLCBuZXcgVEhSRUUuVmVjdG9yMyh4TGVnLCBzZWF0WSAqIDAuNjAsIHpGcm9udCAtIDAuMDUpLCBmcjFdLCB0dWJlUjIsIGZyYW1lTWF0LCA1MiwgMjIpKTsKICAgICAgICAgICAgICAgIGcuYWRkKHR1YmVDdXJ2ZShbYmwwLCBuZXcgVEhSRUUuVmVjdG9yMygteExlZywgb3ZlcmFsbEggKiAwLjU1LCB6QmFjayArIDAuMDIpLCBibDFdLCB0dWJlUjIsIGZyYW1lTWF0LCA1NiwgMjIpKTsKICAgICAgICAgICAgICAgIGcuYWRkKHR1YmVDdXJ2ZShbYnIwLCBuZXcgVEhSRUUuVmVjdG9yMyh4TGVnLCBvdmVyYWxsSCAqIDAuNTUsIHpCYWNrICsgMC4wMiksIGJyMV0sIHR1YmVSMiwgZnJhbWVNYXQsIDU2LCAyMikpOwoKICAgICAgICAgICAgICAgIC8vIEZsb29yIGNyb3NzYmFycwogICAgICAgICAgICAgICAgZy5hZGQodHViZUJldHdlZW4obmV3IFRIUkVFLlZlY3RvcjMoLXhMZWcsIDAuMTgsIHpGcm9udCArIDAuMDIpLCBuZXcgVEhSRUUuVmVjdG9yMyh4TGVnLCAwLjE4LCB6RnJvbnQgKyAwLjAyKSwgdHViZVIyICogMC45LCBmcmFtZU1hdCwgMjApKTsKICAgICAgICAgICAgICAgIGcuYWRkKHR1YmVCZXR3ZWVuKG5ldyBUSFJFRS5WZWN0b3IzKC14TGVnLCAwLjE4LCB6QmFjayAtIDAuMDIpLCBuZXcgVEhSRUUuVmVjdG9yMyh4TGVnLCAwLjE4LCB6QmFjayAtIDAuMDIpLCB0dWJlUjIgKiAwLjksIGZyYW1lTWF0LCAyMCkpOwoKICAgICAgICAgICAgICAgIC8vIFVuZGVyLXNlYXQgc3VwcG9ydCBiYXJzCiAgICAgICAgICAgICAgICBnLmFkZCh0dWJlQmV0d2VlbihuZXcgVEhSRUUuVmVjdG9yMygteExlZyArIDAuMDMsIHNlYXRZIC0gMC4xOCwgc2VhdFogKyAwLjM4KSwgbmV3IFRIUkVFLlZlY3RvcjMoeExlZyAtIDAuMDMsIHNlYXRZIC0gMC4xOCwgc2VhdFogKyAwLjM4KSwgdHViZVIyICogMC44LCBmcmFtZU1hdCwgMTgpKTsKICAgICAgICAgICAgICAgIGcuYWRkKHR1YmVCZXR3ZWVuKG5ldyBUSFJFRS5WZWN0b3IzKC14TGVnICsgMC4wMywgc2VhdFkgLSAwLjIwLCBzZWF0WiAtIDAuMzQpLCBuZXcgVEhSRUUuVmVjdG9yMyh4TGVnIC0gMC4wMywgc2VhdFkgLSAwLjIwLCBzZWF0WiAtIDAuMzQpLCB0dWJlUjIgKiAwLjgsIGZyYW1lTWF0LCAxOCkpOwoKICAgICAgICAgICAgICAgIC8vIFNpZGUgWCBicmFjZXMKICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc2lkZSBvZiBbLTEsIDFdKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgeCA9IHNpZGUgKiB4TGVnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGExID0gbmV3IFRIUkVFLlZlY3RvcjMoeCwgMC41NSwgekZyb250IC0gMC4wNSk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYjEgPSBuZXcgVEhSRUUuVmVjdG9yMyh4LCAxLjEwLCB6QmFjayArIDAuMjIpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGEyID0gbmV3IFRIUkVFLlZlY3RvcjMoeCwgMC45MiwgekZyb250IC0gMC4xOCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYjIgPSBuZXcgVEhSRUUuVmVjdG9yMyh4LCAwLjY4LCB6QmFjayArIDAuMTApOwogICAgICAgICAgICAgICAgICAgIGcuYWRkKHR1YmVCZXR3ZWVuKGExLCBiMSwgdHViZVIyICogMC43MiwgZnJhbWVNYXQsIDE4KSk7CiAgICAgICAgICAgICAgICAgICAgZy5hZGQodHViZUJldHdlZW4oYTIsIGIyLCB0dWJlUjIgKiAwLjcyLCBmcmFtZU1hdCwgMTgpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBUb3AgYmFyIGJlaGluZCBiYWNrcmVzdAogICAgICAgICAgICAgICAgZy5hZGQodHViZUJldHdlZW4obmV3IFRIUkVFLlZlY3RvcjMoLXhMZWcsIG92ZXJhbGxIIC0gMC4xNiwgekJhY2sgKyAwLjE2KSwgbmV3IFRIUkVFLlZlY3RvcjMoeExlZywgb3ZlcmFsbEggLSAwLjE2LCB6QmFjayArIDAuMTYpLCB0dWJlUjIgKiAwLjksIGZyYW1lTWF0LCAyMCkpOwoKICAgICAgICAgICAgICAgIC8vIFBpdm90IGJvbHRzCiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHNpZGUgb2YgWy0xLCAxXSkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGJvbHQgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeSgwLjA1NSwgMC4wNTUsIDAuMDQsIDI0KSwgYm9sdE1hdCk7CiAgICAgICAgICAgICAgICAgICAgYm9sdC5wb3NpdGlvbi5zZXQoc2lkZSAqIHhMZWcsIHNlYXRZIC0gMC4xMCwgMC4wMik7CiAgICAgICAgICAgICAgICAgICAgYm9sdC5yb3RhdGlvbi56ID0gTWF0aC5QSSAvIDI7CiAgICAgICAgICAgICAgICAgICAgYm9sdC5jYXN0U2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBib2x0LnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGcuYWRkKGJvbHQpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIFJ1YmJlciBmZWV0CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHYgb2YgW2ZsMCwgZnIwLCBibDAsIGJyMF0pIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBmb290ID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkodHViZVIyICogMS4wOCwgdHViZVIyICogMS4wOCwgMC4wOCwgMjApLCBmb290TWF0KTsKICAgICAgICAgICAgICAgICAgICBmb290LnBvc2l0aW9uLnNldCh2LngsIDAuMDQsIHYueik7CiAgICAgICAgICAgICAgICAgICAgZm9vdC5jYXN0U2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBmb290LnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGcuYWRkKGZvb3QpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBlbHNlIGlmIChTdHJpbmcoc3R5bGUgfHwgJycpLnN0YXJ0c1dpdGgoJ2NoaWF2YXJpXycpKSB7CiAgICAvLyBDaGlhdmFyaSAoYWltZWQgdG8gbWF0Y2ggcmVmOiBzbW9vdGggZmluaXNoLCBhY2N1cmF0ZSBwcm9wb3J0aW9ucywgcmVkdWNlZCBnbGFyZSkKICAgIGNvbnN0IGlzR29sZCA9IChzdHlsZSA9PT0gJ2NoaWF2YXJpX2dvbGQnKTsKICAgIGNvbnN0IGlzU2lsdmVyID0gKHN0eWxlID09PSAnY2hpYXZhcmlfc2lsdmVyJyk7CgogICAgLy8gUmVmZXJlbmNlIHByb3BvcnRpb25zIChmZWV0KQogICAgY29uc3Qgc2VhdEhlaWdodCA9IDEuNDg7ICAgICAgLy8gMTcuNyIKICAgIGNvbnN0IHNlYXRXaWR0aCA9IDEuMzE7ICAgICAgIC8vIDE1LjciCiAgICBjb25zdCBzZWF0RGVwdGggPSAxLjI3OyAgICAgICAvLyB+MTUuMiIKICAgIGNvbnN0IG92ZXJhbGxIZWlnaHQgPSAzLjAyOyAgIC8vIDM2LjIiCgogICAgY29uc3QgZnJhbWVDb2xvciA9IGlzR29sZCA/IDB4YzhhMjRhIDogaXNTaWx2ZXIgPyAweGQxZDVkYiA6IDB4ZjhmYWZjOwogICAgY29uc3QgdHJpbUNvbG9yICA9IGlzR29sZCA/IDB4YTk4MjJlIDogaXNTaWx2ZXIgPyAweDlhYTNhZCA6IDB4ZTJlOGYwOwoKICAgIGZ1bmN0aW9uIG1ha2VOb2lzZVRleHR1cmUoc2VlZCwgc2l6ZSkgewogICAgICAgIHNpemUgPSBzaXplIHx8IDY0OwogICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICAgIGNhbnZhcy53aWR0aCA9IGNhbnZhcy5oZWlnaHQgPSBzaXplOwogICAgICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICAgIGlmICghY3R4KSByZXR1cm4gbnVsbDsKICAgICAgICBjb25zdCBpbWcgPSBjdHguY3JlYXRlSW1hZ2VEYXRhKHNpemUsIHNpemUpOwogICAgICAgIGxldCBzID0gKHNlZWQgfCAwKSB8fCAxOwogICAgICAgIGNvbnN0IHJuZCA9ICgpID0+IHsKICAgICAgICAgICAgcyBePSAocyA8PCAxMykgJiAweGZmZmZmZmZmOwogICAgICAgICAgICBzIF49IChzID4+IDE3KSAmIDB4ZmZmZmZmZmY7CiAgICAgICAgICAgIHMgXj0gKHMgPDwgNSkgJiAweGZmZmZmZmZmOwogICAgICAgICAgICByZXR1cm4gKChzID4+PiAwKSAvIDQyOTQ5NjcyOTUpOwogICAgICAgIH07CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbWcuZGF0YS5sZW5ndGg7IGkgKz0gNCkgewogICAgICAgICAgICBjb25zdCB2ID0gMjE1ICsgTWF0aC5mbG9vcihybmQoKSAqIDMwKTsKICAgICAgICAgICAgaW1nLmRhdGFbaSArIDBdID0gdjsKICAgICAgICAgICAgaW1nLmRhdGFbaSArIDFdID0gdjsKICAgICAgICAgICAgaW1nLmRhdGFbaSArIDJdID0gdjsKICAgICAgICAgICAgaW1nLmRhdGFbaSArIDNdID0gMjU1OwogICAgICAgIH0KICAgICAgICBjdHgucHV0SW1hZ2VEYXRhKGltZywgMCwgMCk7CiAgICAgICAgY29uc3QgdGV4ID0gbmV3IFRIUkVFLkNhbnZhc1RleHR1cmUoY2FudmFzKTsKICAgICAgICB0ZXgud3JhcFMgPSB0ZXgud3JhcFQgPSBUSFJFRS5SZXBlYXRXcmFwcGluZzsKICAgICAgICB0ZXgucmVwZWF0LnNldCg1LCA1KTsKICAgICAgICB0ZXgubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICAgIHJldHVybiB0ZXg7CiAgICB9CgogICAgY29uc3Qgcm91Z2hUZXggPSBtYWtlTm9pc2VUZXh0dXJlKGlzR29sZCA/IDExIDogKGlzU2lsdmVyID8gMjIgOiAzMykpOwoKICAgIGNvbnN0IGNoYWlyTWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsKICAgICAgICBjb2xvcjogZnJhbWVDb2xvciwKICAgICAgICBtZXRhbG5lc3M6IGlzU2lsdmVyID8gMC4yNSA6IChpc0dvbGQgPyAwLjIyIDogMC4wNSksCiAgICAgICAgcm91Z2huZXNzOiBpc1NpbHZlciA/IDAuNzggOiAoaXNHb2xkID8gMC43MiA6IDAuODUpLAogICAgICAgIHJvdWdobmVzc01hcDogcm91Z2hUZXggfHwgdW5kZWZpbmVkLAogICAgICAgIGVudk1hcEludGVuc2l0eTogMC4xOCwKICAgIH0pOwoKICAgIGNvbnN0IGFjY2VudE1hdCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7CiAgICAgICAgY29sb3I6IHRyaW1Db2xvciwKICAgICAgICBtZXRhbG5lc3M6IGlzU2lsdmVyID8gMC4yOCA6IChpc0dvbGQgPyAwLjI0IDogMC4wNiksCiAgICAgICAgcm91Z2huZXNzOiBpc1NpbHZlciA/IDAuODAgOiAoaXNHb2xkID8gMC43NSA6IDAuODcpLAogICAgICAgIHJvdWdobmVzc01hcDogcm91Z2hUZXggfHwgdW5kZWZpbmVkLAogICAgICAgIGVudk1hcEludGVuc2l0eTogMC4xOCwKICAgIH0pOwoKICAgIGNvbnN0IGN1c2hpb25NYXQgPSBjdXNoaW9uV2hpdGU7CgogICAgY29uc3QgaGFsZlcgPSBzZWF0V2lkdGggLyAyOwogICAgY29uc3QgaGFsZkQgPSBzZWF0RGVwdGggLyAyOwogICAgY29uc3QgaW5zZXRYID0gaGFsZlcgLSAwLjA4OwogICAgY29uc3QgaW5zZXRaID0gaGFsZkQgLSAwLjA4OwogICAgY29uc3QgcmVhclogPSAtaW5zZXRaOwogICAgY29uc3QgZnJvbnRaID0gaW5zZXRaOwogICAgY29uc3Qgc2VhdFogPSAwLjA1OwogICAgY29uc3QgYmFja1pNaWQgPSByZWFyWiAtIDAuMDg7CiAgICAgICAgY29uc3QgYmFja1pUb3AgPSByZWFyWiAtIDAuMTI7CiAgICAgICAgY29uc3QgcG9zdFRvcFogPSByZWFyWiAtIDAuMTM7CgogICAgZnVuY3Rpb24gcm91bmRlZFJlY3QodzIsIGQyLCByKSB7CiAgICAgICAgY29uc3QgcnIgPSBNYXRoLm1heCgwLjAxLCBNYXRoLm1pbihyLCBNYXRoLm1pbih3MiwgZDIpIC8gMykpOwogICAgICAgIGNvbnN0IHMgPSBuZXcgVEhSRUUuU2hhcGUoKTsKICAgICAgICBjb25zdCB4ID0gLXcyIC8gMjsKICAgICAgICBjb25zdCB5ID0gLWQyIC8gMjsKICAgICAgICBzLm1vdmVUbyh4ICsgcnIsIHkpOwogICAgICAgIHMubGluZVRvKHggKyB3MiAtIHJyLCB5KTsKICAgICAgICBzLnF1YWRyYXRpY0N1cnZlVG8oeCArIHcyLCB5LCB4ICsgdzIsIHkgKyBycik7CiAgICAgICAgcy5saW5lVG8oeCArIHcyLCB5ICsgZDIgLSBycik7CiAgICAgICAgcy5xdWFkcmF0aWNDdXJ2ZVRvKHggKyB3MiwgeSArIGQyLCB4ICsgdzIgLSByciwgeSArIGQyKTsKICAgICAgICBzLmxpbmVUbyh4ICsgcnIsIHkgKyBkMik7CiAgICAgICAgcy5xdWFkcmF0aWNDdXJ2ZVRvKHgsIHkgKyBkMiwgeCwgeSArIGQyIC0gcnIpOwogICAgICAgIHMubGluZVRvKHgsIHkgKyBycik7CiAgICAgICAgcy5xdWFkcmF0aWNDdXJ2ZVRvKHgsIHksIHggKyByciwgeSk7CiAgICAgICAgcmV0dXJuIHM7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwbHlEaXNoKGdlbywgdzIsIGQyLCB0aGljaywgZGlwKSB7CiAgICAgICAgaWYgKCFkaXApIHJldHVybjsKICAgICAgICBjb25zdCBwb3MgPSBnZW8uYXR0cmlidXRlcy5wb3NpdGlvbjsKICAgICAgICBjb25zdCBodyA9IE1hdGgubWF4KDAuMDAwMSwgdzIgLyAyKTsKICAgICAgICBjb25zdCBoZCA9IE1hdGgubWF4KDAuMDAwMSwgZDIgLyAyKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvcy5jb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IHkgPSBwb3MuZ2V0WShpKTsKICAgICAgICAgICAgaWYgKHkgPCB0aGljayAqIDAuNjApIGNvbnRpbnVlOwogICAgICAgICAgICBjb25zdCB4ID0gcG9zLmdldFgoaSk7CiAgICAgICAgICAgIGNvbnN0IHogPSBwb3MuZ2V0WihpKTsKICAgICAgICAgICAgY29uc3QgcnggPSB4IC8gaHc7CiAgICAgICAgICAgIGNvbnN0IHJ6ID0geiAvIGhkOwogICAgICAgICAgICBjb25zdCByMiA9IHJ4ICogcnggKyByeiAqIHJ6OwogICAgICAgICAgICBjb25zdCBrID0gTWF0aC5tYXgoMCwgMSAtIHIyKTsKICAgICAgICAgICAgY29uc3QgZGVsdGEgPSBkaXAgKiBrICogazsKICAgICAgICAgICAgcG9zLnNldFkoaSwgeSAtIGRlbHRhKTsKICAgICAgICB9CiAgICAgICAgcG9zLm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgICBnZW8uY29tcHV0ZVZlcnRleE5vcm1hbHMoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBtYWtlU2VhdCh3MiwgZDIsIHRoaWNrLCBtYXQsIGRpcCkgewogICAgICAgIGNvbnN0IHNoYXBlID0gcm91bmRlZFJlY3QodzIsIGQyLCAwLjE4KTsKICAgICAgICBjb25zdCBnZW8gPSBuZXcgVEhSRUUuRXh0cnVkZUdlb21ldHJ5KHNoYXBlLCB7CiAgICAgICAgICAgIGRlcHRoOiB0aGljaywKICAgICAgICAgICAgc3RlcHM6IDEsCiAgICAgICAgICAgIGJldmVsRW5hYmxlZDogdHJ1ZSwKICAgICAgICAgICAgYmV2ZWxUaGlja25lc3M6IDAuMDIsCiAgICAgICAgICAgIGJldmVsU2l6ZTogMC4wMiwKICAgICAgICAgICAgYmV2ZWxTZWdtZW50czogNSwKICAgICAgICB9KTsKICAgICAgICBnZW8ucm90YXRlWCgtTWF0aC5QSSAvIDIpOwogICAgICAgIGFwcGx5RGlzaChnZW8sIHcyLCBkMiwgdGhpY2ssIGRpcCk7CiAgICAgICAgY29uc3QgbSA9IG5ldyBUSFJFRS5NZXNoKGdlbywgbWF0KTsKICAgICAgICBtLmNhc3RTaGFkb3cgPSB0cnVlOyBtLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgIHJldHVybiBtOwogICAgfQoKICAgIGZ1bmN0aW9uIG1ha2VUdXJuZWRMYXRoZShoLCByU2hhZnQsIHJOb2RlLCByQmFzZSwgcmluZ1lzKSB7CiAgICAgICAgY29uc3QgcHRzID0gW107CiAgICAgICAgY29uc3QgeTAgPSAtaCAvIDI7CiAgICAgICAgY29uc3QgcHVzaCA9ICh5LCByKSA9PiBwdHMucHVzaChuZXcgVEhSRUUuVmVjdG9yMihyLCB5KSk7CgogICAgICAgIHB1c2goeTAsIHJCYXNlKTsKICAgICAgICBwdXNoKHkwICsgMC4wNiwgckJhc2UgKiAwLjk0KTsKICAgICAgICBwdXNoKHkwICsgMC4xMiwgclNoYWZ0KTsKCiAgICAgICAgZm9yIChjb25zdCB5eSBvZiByaW5nWXMpIHsKICAgICAgICAgICAgY29uc3QgeSA9IHkwICsgeXk7CiAgICAgICAgICAgIGlmICh5IDw9IHkwICsgMC4xNiB8fCB5ID49IHkwICsgaCAtIDAuMTgpIGNvbnRpbnVlOwogICAgICAgICAgICBwdXNoKHkgLSAwLjAzMCwgclNoYWZ0ICogMC45Nyk7CiAgICAgICAgICAgIHB1c2goeSAtIDAuMDEwLCByTm9kZSk7CiAgICAgICAgICAgIHB1c2goeSwgck5vZGUgKiAxLjAyKTsKICAgICAgICAgICAgcHVzaCh5ICsgMC4wMTAsIHJOb2RlKTsKICAgICAgICAgICAgcHVzaCh5ICsgMC4wMzAsIHJTaGFmdCAqIDAuOTcpOwogICAgICAgICAgICBwdXNoKHkgKyAwLjA3NSwgclNoYWZ0KTsKICAgICAgICB9CgogICAgICAgIHB1c2goeTAgKyBoIC0gMC4xMCwgclNoYWZ0KTsKICAgICAgICBwdXNoKHkwICsgaCAtIDAuMDYsIHJOb2RlKTsKICAgICAgICBwdXNoKHkwICsgaCAtIDAuMDIsIHJTaGFmdCAqIDAuOTcpOwogICAgICAgIHB1c2goeTAgKyBoLCByU2hhZnQgKiAwLjk1KTsKCiAgICAgICAgY29uc3QgZ2VvID0gbmV3IFRIUkVFLkxhdGhlR2VvbWV0cnkocHRzLCA2NCk7CiAgICAgICAgZ2VvLmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7CiAgICAgICAgcmV0dXJuIGdlbzsKICAgIH0KCiAgICBjb25zdCBwb3N0SCA9IG92ZXJhbGxIZWlnaHQ7CiAgICBjb25zdCB0b3BSYWlsWSA9IG92ZXJhbGxIZWlnaHQgLSAwLjA0OwogICAgY29uc3QgY3Jvd25SYWlsWSA9IHRvcFJhaWxZIC0gMC41ODsKICAgIGNvbnN0IG1pZFJhaWxZID0gY3Jvd25SYWlsWSAtIDAuMjg7CiAgICBjb25zdCBsb3dSYWlsWSA9IG1pZFJhaWxZIC0gMC4yMjsKCiAgICBjb25zdCBsZWdGcm9udEdlbyA9IG1ha2VUdXJuZWRMYXRoZShzZWF0SGVpZ2h0LCAwLjA0MiwgMC4wNTIsIDAuMDUwLCBbMC4zMCwgMC42MCwgMC45MCwgMS4yMF0pOwogICAgY29uc3Qgc3BpbmRsZUggPSBNYXRoLm1heCgwLjMwLCAodG9wUmFpbFkgLSBjcm93blJhaWxZKSAtIDAuMTApOwogICAgY29uc3Qgc3BpbmRsZUdlbyA9IG1ha2VUdXJuZWRMYXRoZShzcGluZGxlSCwgMC4wMTgsIDAuMDI0LCAwLjAxOCwgWzAuMTIsIDAuMjRdKTsKCiAgICBmdW5jdGlvbiBhZGRGcm9udExlZyh4LCB6LCB0aWx0WikgewogICAgICAgIGNvbnN0IG0gPSBuZXcgVEhSRUUuTWVzaChsZWdGcm9udEdlbywgY2hhaXJNYXQpOwogICAgICAgIG0ucG9zaXRpb24uc2V0KHgsIHNlYXRIZWlnaHQgLyAyLCB6KTsKICAgICAgICBtLnJvdGF0aW9uLnogPSB0aWx0WjsKICAgICAgICBtLmNhc3RTaGFkb3cgPSB0cnVlOyBtLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgIGcuYWRkKG0pOwogICAgfQoKICAgIGFkZEZyb250TGVnKC1pbnNldFgsIGZyb250WiwgLTAuMDEwKTsKICAgIGFkZEZyb250TGVnKGluc2V0WCwgIGZyb250WiwgIDAuMDEwKTsKCiAgICBmdW5jdGlvbiBhZGRDdXJ2ZWRCYWNrUG9zdCh4LCB6LCBiZW5kWikgewogICAgICAgIGNvbnN0IGdycCA9IG5ldyBUSFJFRS5Hcm91cCgpOwogICAgICAgIGdycC5wb3NpdGlvbi5zZXQoeCwgMCwgeik7CgogICAgICAgIGNvbnN0IGN1cnZlID0gbmV3IFRIUkVFLkNhdG11bGxSb21DdXJ2ZTMoWwogICAgICAgICAgICBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAwKSwKICAgICAgICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoMCwgc2VhdEhlaWdodCAqIDAuOTUsIDApLAogICAgICAgICAgICBuZXcgVEhSRUUuVmVjdG9yMygwLCBwb3N0SCAqIDAuNzIsIGJlbmRaICogMC41NSksCiAgICAgICAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKDAsIHBvc3RILCBiZW5kWiksCiAgICAgICAgXSk7CgogICAgICAgIGNvbnN0IHR1YmVHZW8gPSBuZXcgVEhSRUUuVHViZUdlb21ldHJ5KGN1cnZlLCA1NCwgMC4wNDMsIDE0LCBmYWxzZSk7CiAgICAgICAgY29uc3QgdHViZSA9IG5ldyBUSFJFRS5NZXNoKHR1YmVHZW8sIGNoYWlyTWF0KTsKICAgICAgICB0dWJlLmNhc3RTaGFkb3cgPSB0cnVlOyB0dWJlLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgIGdycC5hZGQodHViZSk7CgogICAgICAgIGNvbnN0IGNvbGxhckdlbyA9IG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KDAuMDQzICogMS4xMCwgMC4wNDMgKiAxLjEwLCAwLjA1NSwgMTgpOwogICAgICAgIGNvbnN0IHRWYWxzID0gWzAuMTAsIDAuMjQsIDAuMzgsIDAuNTIsIDAuNjYsIDAuODAsIDAuOTJdOwogICAgICAgIGZvciAoY29uc3QgdCBvZiB0VmFscykgewogICAgICAgICAgICBjb25zdCBwID0gY3VydmUuZ2V0UG9pbnQodCk7CiAgICAgICAgICAgIGNvbnN0IHRhbmcgPSBjdXJ2ZS5nZXRUYW5nZW50KHQpLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBjb25zdCBxID0gbmV3IFRIUkVFLlF1YXRlcm5pb24oKS5zZXRGcm9tVW5pdFZlY3RvcnMobmV3IFRIUkVFLlZlY3RvcjMoMCwgMSwgMCksIHRhbmcpOwogICAgICAgICAgICBjb25zdCByaW5nID0gbmV3IFRIUkVFLk1lc2goY29sbGFyR2VvLCBhY2NlbnRNYXQpOwogICAgICAgICAgICByaW5nLnBvc2l0aW9uLmNvcHkocCk7CiAgICAgICAgICAgIHJpbmcuc2V0Um90YXRpb25Gcm9tUXVhdGVybmlvbihxKTsKICAgICAgICAgICAgcmluZy5jYXN0U2hhZG93ID0gdHJ1ZTsgcmluZy5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgZ3JwLmFkZChyaW5nKTsKICAgICAgICB9CgogICAgICAgIGcuYWRkKGdycCk7CiAgICB9CgogICAgYWRkQ3VydmVkQmFja1Bvc3QoLWluc2V0WCwgcmVhclosIC0wLjEzKTsKICAgIGFkZEN1cnZlZEJhY2tQb3N0KGluc2V0WCwgIHJlYXJaLCAtMC4xMyk7CgogICAgY29uc3QgY2FwR2VvID0gbmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkoMC4wNTAsIDAuMDUwLCAwLjA3LCAxOCk7CiAgICBjb25zdCBrbm9iR2VvID0gbmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KDAuMDQ4LCAxOCwgMTQpOwogICAgY29uc3QgY2FwTCA9IG5ldyBUSFJFRS5NZXNoKGNhcEdlbywgYWNjZW50TWF0KTsgY2FwTC5wb3NpdGlvbi5zZXQoLWluc2V0WCwgcG9zdEggKyAwLjAyLCBwb3N0VG9wWik7CiAgICBjb25zdCBjYXBSID0gY2FwTC5jbG9uZSgpOyBjYXBSLnBvc2l0aW9uLnggPSBpbnNldFg7CiAgICBjb25zdCBrbm9iTCA9IG5ldyBUSFJFRS5NZXNoKGtub2JHZW8sIGFjY2VudE1hdCk7IGtub2JMLnBvc2l0aW9uLnNldCgtaW5zZXRYLCBwb3N0SCArIDAuMDcsIHBvc3RUb3BaKTsKICAgIGNvbnN0IGtub2JSID0ga25vYkwuY2xvbmUoKTsga25vYlIucG9zaXRpb24ueCA9IGluc2V0WDsKICAgIGcuYWRkKGNhcEwsIGNhcFIsIGtub2JMLCBrbm9iUik7CgogICAgY29uc3QgcmltID0gbWFrZVNlYXQoc2VhdFdpZHRoICsgMC4xMCwgc2VhdERlcHRoICsgMC4xMCwgMC4xMCwgYWNjZW50TWF0LCAwLjApOwogICAgcmltLnBvc2l0aW9uLnNldCgwLCBzZWF0SGVpZ2h0ICsgMC4wMiwgc2VhdFopOwogICAgZy5hZGQocmltKTsKCiAgICBjb25zdCBwYW4gPSBtYWtlU2VhdChzZWF0V2lkdGggLSAwLjA1LCBzZWF0RGVwdGggLSAwLjA1LCAwLjA3LCBjaGFpck1hdCwgMC4wMjIpOwogICAgcGFuLnBvc2l0aW9uLnNldCgwLCBzZWF0SGVpZ2h0ICsgMC4wNSwgc2VhdFopOwogICAgZy5hZGQocGFuKTsKCiAgICBmdW5jdGlvbiBhZGRTdHJldGNoZXJSZWN0KHksIHIpIHsKICAgICAgICBjb25zdCBnZW9XID0gbmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkociwgciwgKGluc2V0WCAqIDIpIC0gMC4wNiwgMjQpOwogICAgICAgIGNvbnN0IGdlb0QgPSBuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeShyLCByLCAoaW5zZXRaICogMikgLSAwLjA2LCAyNCk7CgogICAgICAgIGNvbnN0IGYgPSBuZXcgVEhSRUUuTWVzaChnZW9XLCBjaGFpck1hdCk7IGYucG9zaXRpb24uc2V0KDAsIHksIGZyb250Wik7IGYucm90YXRpb24ueiA9IE1hdGguUEkgLyAyOwogICAgICAgIGNvbnN0IGIgPSBmLmNsb25lKCk7IGIucG9zaXRpb24ueiA9IHJlYXJaOwoKICAgICAgICBjb25zdCBsID0gbmV3IFRIUkVFLk1lc2goZ2VvRCwgY2hhaXJNYXQpOyBsLnBvc2l0aW9uLnNldCgtaW5zZXRYLCB5LCAwKTsgbC5yb3RhdGlvbi54ID0gTWF0aC5QSSAvIDI7CiAgICAgICAgY29uc3Qgck0gPSBsLmNsb25lKCk7IHJNLnBvc2l0aW9uLnggPSBpbnNldFg7CgogICAgICAgIFtmLCBiLCBsLCByTV0uZm9yRWFjaChtID0+IHsgbS5jYXN0U2hhZG93ID0gdHJ1ZTsgbS5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsgZy5hZGQobSk7IH0pOwogICAgfQoKICAgIGFkZFN0cmV0Y2hlclJlY3QoMC42MiwgMC4wMzApOwogICAgYWRkU3RyZXRjaGVyUmVjdCgwLjkwLCAwLjAzMik7CgogICAgZnVuY3Rpb24gYWRkQmFja1JhaWwoeSwgcmFkaXVzLCBsZW4sIHpQb3MpIHsKICAgICAgICBjb25zdCBjb3JlID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkocmFkaXVzICogMC45MiwgcmFkaXVzICogMC45MiwgbGVuLCAyOCksIGNoYWlyTWF0KTsKICAgICAgICBjb3JlLnBvc2l0aW9uLnNldCgwLCB5LCB6UG9zKTsKICAgICAgICBjb3JlLnJvdGF0aW9uLnogPSBNYXRoLlBJIC8gMjsKICAgICAgICBjb3JlLmNhc3RTaGFkb3cgPSB0cnVlOyBjb3JlLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgIGcuYWRkKGNvcmUpOwoKICAgICAgICBjb25zdCBjb2xsYXJHZW8gPSBuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeShyYWRpdXMgKiAxLjA2LCByYWRpdXMgKiAxLjA2LCByYWRpdXMgKiAwLjY1LCAyMCk7CiAgICAgICAgY29uc3QgeHMgPSBbLTAuNDYsIDAuMCwgMC40Nl07CiAgICAgICAgZm9yIChjb25zdCB0IG9mIHhzKSB7CiAgICAgICAgICAgIGNvbnN0IGNvbGxhciA9IG5ldyBUSFJFRS5NZXNoKGNvbGxhckdlbywgYWNjZW50TWF0KTsKICAgICAgICAgICAgY29sbGFyLnBvc2l0aW9uLnNldCh0ICogKGxlbiAvIDIgLSByYWRpdXMgKiAxLjEpLCB5LCB6UG9zKTsKICAgICAgICAgICAgY29sbGFyLnJvdGF0aW9uLnogPSBNYXRoLlBJIC8gMjsKICAgICAgICAgICAgY29sbGFyLmNhc3RTaGFkb3cgPSB0cnVlOyBjb2xsYXIucmVjZWl2ZVNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgIGcuYWRkKGNvbGxhcik7CiAgICAgICAgfQogICAgfQoKICAgIGFkZEJhY2tSYWlsKGxvd1JhaWxZLCAgIDAuMDM2LCBzZWF0V2lkdGggLSAwLjE4LCBiYWNrWk1pZCk7CiAgICBhZGRCYWNrUmFpbChtaWRSYWlsWSwgICAwLjAzNiwgc2VhdFdpZHRoIC0gMC4xNCwgYmFja1pNaWQpOwogICAgYWRkQmFja1JhaWwoY3Jvd25SYWlsWSwgMC4wNDAsIHNlYXRXaWR0aCAtIDAuMTIsIGJhY2taVG9wKTsKICAgIGFkZEJhY2tSYWlsKHRvcFJhaWxZLCAgIDAuMDQyLCBzZWF0V2lkdGggLSAwLjEwLCBiYWNrWlRvcCk7CgogICAgY29uc3Qgc3BpbmRsZUNvdW50ID0gNjsKICAgIGNvbnN0IGlubmVyID0gc2VhdFdpZHRoIC0gMC4zMDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3BpbmRsZUNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCB0ID0gKGkgKyAxKSAvIChzcGluZGxlQ291bnQgKyAxKTsKICAgICAgICBjb25zdCB4ID0gLWlubmVyIC8gMiArIHQgKiBpbm5lcjsKICAgICAgICBjb25zdCBzcCA9IG5ldyBUSFJFRS5NZXNoKHNwaW5kbGVHZW8sIGNoYWlyTWF0KTsKICAgICAgICBzcC5wb3NpdGlvbi5zZXQoeCwgKGNyb3duUmFpbFkgKyAwLjA2KSArIHNwaW5kbGVIIC8gMiwgYmFja1pUb3ApOwogICAgICAgIHNwLmNhc3RTaGFkb3cgPSB0cnVlOyBzcC5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsKICAgICAgICBnLmFkZChzcCk7CiAgICB9CgogICAgaWYgKGN1c2hpb25PbikgewogICAgICAgIGNvbnN0IHBhZCA9IG1ha2VTZWF0KHNlYXRXaWR0aCAtIDAuMTAsIHNlYXREZXB0aCAtIDAuMTAsIDAuMDYsIGN1c2hpb25NYXQsIDAuMDE4KTsKICAgICAgICBwYWQucG9zaXRpb24uc2V0KDAsIHNlYXRIZWlnaHQgKyAwLjEyLCBzZWF0Wik7CiAgICAgICAgZy5hZGQocGFkKTsKICAgIH0KCgoKfSBlbHNlIGlmIChzdHlsZSA9PT0gJ3J1c3RpY19jcm9zc2JhY2tfb2FrJykgewoKICAgICAgICAgICAgICAgIGNvbnN0IGxlZ0ggPSBzZWF0SDsKICAgICAgICAgICAgICAgIGNvbnN0IGxlZ0dlbyA9IG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KDAuMDY1LCAwLjA3NSwgbGVnSCwgMTIpOwogICAgICAgICAgICAgICAgY29uc3QgaW5zZXQgPSAwLjExOwogICAgICAgICAgICAgICAgW1stMSwtMV0sWzEsLTFdLFstMSwxXSxbMSwxXV0uZm9yRWFjaCgoW3N4LHN6XSkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGxlZyA9IG5ldyBUSFJFRS5NZXNoKGxlZ0dlbywgd2FybU9hayk7CiAgICAgICAgICAgICAgICAgICAgbGVnLnBvc2l0aW9uLnNldChzeCoody8yLWluc2V0KSwgbGVnSC8yLCBzeiooZC8yLWluc2V0KSk7CiAgICAgICAgICAgICAgICAgICAgbGVnLmNhc3RTaGFkb3cgPSB0cnVlOyBsZWcucmVjZWl2ZVNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgZy5hZGQobGVnKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGNvbnN0IHNlYXQgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQm94R2VvbWV0cnkodywgMC4xMCwgZCksIG9ha1NlYXQpOwogICAgICAgICAgICAgICAgc2VhdC5wb3NpdGlvbi5zZXQoMCwgc2VhdEgsIDApOwogICAgICAgICAgICAgICAgc2VhdC5jYXN0U2hhZG93ID0gdHJ1ZTsgc2VhdC5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGcuYWRkKHNlYXQpOwoKICAgICAgICAgICAgICAgIGNvbnN0IHBvc3RIID0gMy4yNTsKICAgICAgICAgICAgICAgIGNvbnN0IHBvc3RHZW8gPSBuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeSgwLjA2LCAwLjA3NSwgcG9zdEgsIDEyKTsKICAgICAgICAgICAgICAgIGNvbnN0IHBMID0gbmV3IFRIUkVFLk1lc2gocG9zdEdlbywgd2FybU9hayk7IHBMLnBvc2l0aW9uLnNldCgtdy8yK2luc2V0LCBwb3N0SC8yLCAtZC8yKzAuMDYpOwogICAgICAgICAgICAgICAgY29uc3QgcFIgPSBuZXcgVEhSRUUuTWVzaChwb3N0R2VvLCB3YXJtT2FrKTsgcFIucG9zaXRpb24uc2V0KHcvMi1pbnNldCwgcG9zdEgvMiwgLWQvMiswLjA2KTsKICAgICAgICAgICAgICAgIHBMLmNhc3RTaGFkb3cgPSBwUi5jYXN0U2hhZG93ID0gdHJ1ZTsgcEwucmVjZWl2ZVNoYWRvdyA9IHBSLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgZy5hZGQocEwpOyBnLmFkZChwUik7CgogICAgICAgICAgICAgICAgY29uc3QgdG9wUmFpbCA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSh3KzAuMDUsIDAuMTUsIDAuMTgpLCB3YXJtT2FrKTsKICAgICAgICAgICAgICAgIHRvcFJhaWwucG9zaXRpb24uc2V0KDAsIHNlYXRIICsgMS42NSwgLWQvMiArIDAuMTApOwogICAgICAgICAgICAgICAgdG9wUmFpbC5jYXN0U2hhZG93ID0gdHJ1ZTsgdG9wUmFpbC5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGcuYWRkKHRvcFJhaWwpOwoKICAgICAgICAgICAgICAgIGNvbnN0IHBsYW5rR2VvID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KDAuMTIsIDEuNzUsIDAuMDYpOwogICAgICAgICAgICAgICAgY29uc3QgcGxhbmsxID0gbmV3IFRIUkVFLk1lc2gocGxhbmtHZW8sIHdhcm1PYWspOwogICAgICAgICAgICAgICAgcGxhbmsxLnBvc2l0aW9uLnNldCgwLCBzZWF0SCArIDEuMCwgLWQvMiArIDAuMTApOwogICAgICAgICAgICAgICAgcGxhbmsxLnJvdGF0aW9uLnogPSBNYXRoLlBJLzY7CiAgICAgICAgICAgICAgICBwbGFuazEuY2FzdFNoYWRvdyA9IHRydWU7IHBsYW5rMS5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGcuYWRkKHBsYW5rMSk7CgogICAgICAgICAgICAgICAgY29uc3QgcGxhbmsyID0gbmV3IFRIUkVFLk1lc2gocGxhbmtHZW8sIHdhcm1PYWspOwogICAgICAgICAgICAgICAgcGxhbmsyLnBvc2l0aW9uLnNldCgwLCBzZWF0SCArIDEuMCwgLWQvMiArIDAuMTApOwogICAgICAgICAgICAgICAgcGxhbmsyLnJvdGF0aW9uLnogPSAtTWF0aC5QSS82OwogICAgICAgICAgICAgICAgcGxhbmsyLmNhc3RTaGFkb3cgPSB0cnVlOyBwbGFuazIucmVjZWl2ZVNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICBnLmFkZChwbGFuazIpOwoKICAgICAgICAgICAgICAgIGNvbnN0IG1pZFJhaWwgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQm94R2VvbWV0cnkody0wLjE4LCAwLjEwLCAwLjEwKSwgd2FybU9hayk7CiAgICAgICAgICAgICAgICBtaWRSYWlsLnBvc2l0aW9uLnNldCgwLCBzZWF0SCArIDAuOTUsIC1kLzIgKyAwLjEwKTsKICAgICAgICAgICAgICAgIG1pZFJhaWwuY2FzdFNoYWRvdyA9IHRydWU7IG1pZFJhaWwucmVjZWl2ZVNoYWRvdyA9IHRydWU7CiAgICAgICAgICAgICAgICBnLmFkZChtaWRSYWlsKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIGZhbGxiYWNrCiAgICAgICAgICAgICAgICBjb25zdCBzZWF0ID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkJveEdlb21ldHJ5KHcsIDAuMDgsIGQpLCBwbGFzdGljV2hpdGUpOwogICAgICAgICAgICAgICAgc2VhdC5wb3NpdGlvbi5zZXQoMCwgc2VhdEgsIDApOwogICAgICAgICAgICAgICAgc2VhdC5jYXN0U2hhZG93ID0gdHJ1ZTsgc2VhdC5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGcuYWRkKHNlYXQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gZzsKICAgICAgICB9CiAgICAgICAgLy8gQ2hhaXJzIGFyb3VuZCB0YWJsZXM6IGhhbGYtdHVja2VkIHNvIDJEICsgM0QgbWF0Y2guCiAgICAgICAgY29uc3QgQ0hBSVJfVEFCTEVfVFVDS19GUkFDVElPTiA9IDAuNTsgLy8gb3ZlcmxhcCBmcmFjdGlvbiBkcml2ZXMgY2hhaXIgdHVjawogICAgICAgIGNvbnN0IGNoYWlyVGFibGVUdWNrRGlzdENhY2hlID0gbmV3IE1hcCgpOwogICAgICAgIGZ1bmN0aW9uIGdldENoYWlyVGFibGVUdWNrRGlzdEZ0KHJhd1N0eWxlLCBjdXNoaW9uT24pIHsKICAgICAgICAgIGNvbnN0IHN0eWxlID0gbm9ybWFsaXplQ2hhaXJTdHlsZShyYXdTdHlsZSk7CiAgICAgICAgICBjb25zdCBrZXkgPSBzdHlsZSArICJ8IiArIChjdXNoaW9uT24gPyAxIDogMCk7CiAgICAgICAgICBjb25zdCBjYWNoZWQgPSBjaGFpclRhYmxlVHVja0Rpc3RDYWNoZS5nZXQoa2V5KTsKICAgICAgICAgIGlmICh0eXBlb2YgY2FjaGVkID09PSAibnVtYmVyIikgcmV0dXJuIGNhY2hlZDsKCiAgICAgICAgICBjb25zdCBwcm90byA9IGJ1aWxkQ2hhaXJQcm90b3R5cGUoc3R5bGUsICEhY3VzaGlvbk9uKTsKICAgICAgICAgIGNvbnN0IGJveCA9IG5ldyBUSFJFRS5Cb3gzKCkuc2V0RnJvbU9iamVjdChwcm90byk7CiAgICAgICAgICBjb25zdCBzaXplID0gbmV3IFRIUkVFLlZlY3RvcjMoKTsKICAgICAgICAgIGJveC5nZXRTaXplKHNpemUpOwogICAgICAgICAgY29uc3QgZGVwdGggPSBNYXRoLm1heCgwLjAxLCBzaXplLnopOwogICAgICAgICAgY29uc3QgZm9yd2FyZCA9IGJveC5tYXguejsgLy8gK1ogaXMgdGhlICJmcm9udCIgKHRvd2FyZCB0aGUgdGFibGUpCiAgICAgICAgICBjb25zdCBkZXNpcmVkSW5zZXQgPSBkZXB0aCAqIENIQUlSX1RBQkxFX1RVQ0tfRlJBQ1RJT047CiAgICAgICAgICBjb25zdCBkaXN0ID0gTWF0aC5taW4oMC42LCBNYXRoLm1heCgtMC4yNSwgZm9yd2FyZCAtIGRlc2lyZWRJbnNldCkpOwoKICAgICAgICAgIGNoYWlyVGFibGVUdWNrRGlzdENhY2hlLnNldChrZXksIGRpc3QpOwogICAgICAgICAgcmV0dXJuIGRpc3Q7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBjcmVhdGVDaGFpckdyb3VwKHJ5LCBjaGFpclN0eWxlT3ZlcnJpZGUsIGN1c2hpb25PdmVycmlkZSkgewogICAgICAgICAgICBjb25zdCByYXdTdHlsZSA9IGNoYWlyU3R5bGVPdmVycmlkZSB8fCBTVEFURS5jaGFpclN0eWxlIHx8ICdmb2xkaW5nX3doaXRlJzsKICAgICAgICAgICAgY29uc3Qgc3R5bGUgPSBub3JtYWxpemVDaGFpclN0eWxlKHJhd1N0eWxlKTsKICAgIGNvbnN0IGN1c2hpb25PbiA9ICh0eXBlb2YgY3VzaGlvbk92ZXJyaWRlID09PSAnYm9vbGVhbicpID8gY3VzaGlvbk92ZXJyaWRlIDogU1RBVEUuY2hpYXZhcmlDdXNoaW9uOwoKICAgICAgICAgICAgLy8gU3RhcnQgYXN5bmMgR0xCIGxvYWRpbmcgZm9yIHN1cHBvcnRlZCBzdHlsZXMuCiAgICAgICAgICAgIGVuc3VyZUNoYWlyR2xiTG9hZGVkKHN0eWxlKTsKCiAgICAgICAgICAgIC8vIFdyYXAgZXZlcnl0aGluZyBpbiBpdHMgb3duIGdyb3VwIHNvIHdlIGNhbiBob3Qtc3dhcCBjb250ZW50cyBvbmNlIHRoZSBHTEIgZmluaXNoZXMgbG9hZGluZy4KICAgICAgICAgICAgY29uc3QgZyA9IG5ldyBUSFJFRS5Hcm91cCgpOwogICAgICAgICAgICBnLnJvdGF0aW9uLnkgPSByeTsKICAgICAgICAgICAgZy51c2VyRGF0YS5pc0NoYWlyID0gdHJ1ZTsKICAgICAgICAgICAgZy51c2VyRGF0YS5jaGFpclN0eWxlID0gc3R5bGU7CgogICAgICAgICAgICBjb25zdCBnbGJQcm90byA9IGNoYWlyR2xiUHJvdG9CeVN0eWxlW3N0eWxlXTsKICAgICAgICAgICAgaWYgKGdsYlByb3RvKSB7CiAgICAgICAgICAgICAgICBnLmFkZChnbGJQcm90by5jbG9uZSh0cnVlKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gZzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gUHJvY2VkdXJhbCBmYWxsYmFjayAoYWxzbyB1c2VkIHdoaWxlIEdMQiBsb2FkcykKICAgICAgICAgICAgbGV0IGZhbGxiYWNrU3R5bGUgPSBzdHlsZTsKICAgICAgICAgICAgaWYgKHN0eWxlID09PSAnd2hpdGVfcmVzaW5fcGFkZGVkJykgZmFsbGJhY2tTdHlsZSA9ICdmb2xkaW5nX3doaXRlJzsKICAgICAgICAgICAgaWYgKHN0eWxlID09PSAnYmxhY2tfcGFkZGVkX2ZvbGRpbmcnKSBmYWxsYmFja1N0eWxlID0gJ2ZvbGRpbmdfYmxhY2snOwogICAgICAgICAgICBpZiAoc3R5bGUgPT09ICd3aGl0ZV9mYW5iYWNrJykgZmFsbGJhY2tTdHlsZSA9ICdmb2xkaW5nX3doaXRlJzsKCiAgICAgICAgICAgIGNvbnN0IGtleSA9IGZhbGxiYWNrU3R5bGUgKyAnfCcgKyAoU1RBVEUuY2hpYXZhcmlDdXNoaW9uID8gJzEnIDogJzAnKTsKICAgICAgICAgICAgbGV0IHByb3RvID0gY2hhaXJQcm90b0NhY2hlLmdldChrZXkpOwogICAgICAgICAgICBpZiAoIXByb3RvKSB7CiAgICAgICAgICAgICAgICBwcm90byA9IGJ1aWxkQ2hhaXJQcm90b3R5cGUoZmFsbGJhY2tTdHlsZSwgISFTVEFURS5jaGlhdmFyaUN1c2hpb24pOwogICAgICAgICAgICAgICAgY2hhaXJQcm90b0NhY2hlLnNldChrZXksIHByb3RvKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBnLmFkZChwcm90by5jbG9uZSh0cnVlKSk7CiAgICAgICAgICAgIHJldHVybiBnOwogICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IHMgPSBnZXRMYXlvdXRTaXplRnQoKTsKICAgICAgICAgICAgY29uc3QgdyA9IHMudzsKICAgICAgICAgICAgY29uc3QgZCA9IHMuaDsKICAgICAgICAgICAgY29uc3QgY2VudGVyWCA9IHcgLyAyOyBjb25zdCBjZW50ZXJaID0gZCAvIDI7CgogICAgICAgICAgICBpZiAoTU9ERSA9PT0gJ291dHNpZGUnKSB7CiAgICAgICAgICAgICAgICBjb25zdCBncm91bmRNYXQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBtYXA6IGdldFRleCgnZ3Jhc3MnKSB9KTsKICAgICAgICAgICAgICAgIGhvc3RlZExvYWRlci5sb2FkKEdSQVNTX1VSTCwgKG1hcCkgPT4gewogICAgICAgICAgICAgICAgICAgIG1hcC53cmFwUyA9IG1hcC53cmFwVCA9IFRIUkVFLlJlcGVhdFdyYXBwaW5nOwogICAgICAgICAgICAgICAgICAgIG1hcC5yZXBlYXQuc2V0KDgwLCA4MCk7CiAgICAgICAgICAgICAgICAgICAgbWFwLmVuY29kaW5nID0gVEhSRUUuc1JHQkVuY29kaW5nOwogICAgICAgICAgICAgICAgICAgIGdyb3VuZE1hdC5tYXAgPSBtYXA7CiAgICAgICAgICAgICAgICAgICAgZ3JvdW5kTWF0Lm1ldGFsbmVzcyA9IDA7CiAgICAgICAgICAgICAgICAgICAgZ3JvdW5kTWF0Lm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0sIHVuZGVmaW5lZCwgKCkgPT4ge30pOwogICAgICAgICAgICAgICAgY29uc3QgZ3JuZCA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KDE1MDAsIDE1MDApLCBncm91bmRNYXQpOyBncm5kLnJvdGF0aW9uLnggPSAtTWF0aC5QSS8yOyBncm5kLnJlY2VpdmVTaGFkb3cgPSB0cnVlOyBzY2VuZS5hZGQoZ3JuZCk7CgogICAgICAgICAgICAgICAgaWYgKFNUQVRFLnRlbnQpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBtYWluVGVudEdyb3VwID0gY3JlYXRlVGVudE1lc2goU1RBVEUudGVudC53aWR0aCwgU1RBVEUudGVudC5oZWlnaHQsIFNUQVRFLnRlbnQudHlwZSwgZmFsc2UsIFNUQVRFLnRlbnQucG9sZUxlZ0hlaWdodEZ0LCBTVEFURS50ZW50LnBvbGVDZW50ZXJQb2xlSGVpZ2h0RnQsIFNUQVRFLnRlbnQuc2lkZUxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgbWFpblRlbnRHcm91cC5wb3NpdGlvbi5zZXQoY2VudGVyWCwgMCwgY2VudGVyWik7CiAgICAgICAgICAgICAgICAgICAgc2NlbmUuYWRkKG1haW5UZW50R3JvdXApOwoKICAgICAgICAgICAgICAgICAgICBpZiAoU1RBVEUudGVudC5zaWRld2FsbHMpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCB3YWxsSCA9IChTVEFURS50ZW50LnR5cGUgPT09ICdQb2xlJyAmJiB0eXBlb2YgU1RBVEUudGVudC5wb2xlTGVnSGVpZ2h0RnQgPT09ICdudW1iZXInICYmIGlzRmluaXRlKFNUQVRFLnRlbnQucG9sZUxlZ0hlaWdodEZ0KSkgPyBTVEFURS50ZW50LnBvbGVMZWdIZWlnaHRGdCA6IDg7CgogICAgICAgICAgICAgICAgICAgIC8vIEhleCB0ZW50cyB1c2UgNiBmdWxsLWxlbmd0aCAyMCcgcGFuZWxzIChpbmRleCAwLi41KSBiZXR3ZWVuIHZlcnRpY2VzLgogICAgICAgICAgICAgICAgICAgIGlmIChTVEFURS50ZW50LnR5cGUgPT09ICdIZXgnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNpZGVMZW4gPSAodHlwZW9mIFNUQVRFLnRlbnQuc2lkZUxlbmd0aCA9PT0gJ251bWJlcicgJiYgaXNGaW5pdGUoU1RBVEUudGVudC5zaWRlTGVuZ3RoKSkgPyBTVEFURS50ZW50LnNpZGVMZW5ndGggOiAoU1RBVEUudGVudC5oZWlnaHQgLyAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHNpZGVMZW47CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN4ID0gU1RBVEUudGVudC53aWR0aCAvIDI7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN6ID0gU1RBVEUudGVudC5oZWlnaHQgLyAyOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2ZXJ0cyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDYgfSwgKF8sIGkpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSAtTWF0aC5QSSAvIDIgKyBpICogTWF0aC5QSSAvIDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB4OiBjeCArIHIgKiBNYXRoLmNvcyhhKSwgejogY3ogKyByICogTWF0aC5zaW4oYSkgfTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICBTVEFURS50ZW50LnNpZGV3YWxscy5mb3JFYWNoKHdzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3cy5zaWRlICE9PSAnaGV4JykgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9ICgod3MuaW5kZXggJSA2KSArIDYpICUgNjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFWID0gdmVydHNbaV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiViA9IHZlcnRzWyhpICsgMSkgJSA2XTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG14ID0gKGFWLnggKyBiVi54KSAvIDI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBteiA9IChhVi56ICsgYlYueikgLyAyOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpciA9IG5ldyBUSFJFRS5WZWN0b3IzKGJWLnggLSBhVi54LCAwLCBiVi56IC0gYVYueik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB5YXcgPSBNYXRoLmF0YW4yKGRpci56LCBkaXIueCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0d2FyZCA9IG5ldyBUSFJFRS5WZWN0b3IzKG14IC0gY3gsIDAsIG16IC0gY3opOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG91dHdhcmQubGVuZ3RoKCkgPiAwLjAwMDEpIG91dHdhcmQubm9ybWFsaXplKCk7IGVsc2Ugb3V0d2FyZC5zZXQoMCwgMCwgMSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNXaW5kb3cgPSAoKHdzLnR5cGUgfHwgJ3dpbmRvdycpICE9PSAnc29saWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwID0gTWF0aC5tYXgoMSwgTWF0aC5yb3VuZChzaWRlTGVuKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJTVBPUlRBTlQ6IHRoaXMgY29kZSBsaXZlcyBpbnNpZGUgYSB0ZW1wbGF0ZSBzdHJpbmcgKHRoZSBlbWJlZCBIVE1MKS4gRG8gTk9UIHVzZSBiYWNrdGlja3MgaGVyZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRleEtleSA9ICdzaWRld2FsbF8nICsgc3AgKyAnXycgKyAoaXNXaW5kb3cgPyAnd2luJyA6ICdzb2xpZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2FsbE1hdCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IG1hcDogZ2V0VGV4KHRleEtleSksIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUsIHRyYW5zcGFyZW50OiBpc1dpbmRvdywgYWxwaGFUZXN0OiBpc1dpbmRvdyA/IDAuMSA6IDAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3YWxsID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkoc2lkZUxlbiwgd2FsbEgpLCB3YWxsTWF0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhbGwucG9zaXRpb24uc2V0KG14ICsgb3V0d2FyZC54ICogMC4yNSwgd2FsbEggLyAyLCBteiArIG91dHdhcmQueiAqIDAuMjUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FsbC5yb3RhdGlvbi55ID0gLXlhdzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lLmFkZCh3YWxsKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2V0V1NwID0gKHQsIGxlbikgPT4gdCA9PT0gJ1BvcHVwJyA/IDEwIDogKHQgPT09ICdQb2xlJyA/IDIwIDogKGxlbiAlIDE1ID09PSAwID8gMTUgOiAyMCkpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb21wdXRlU2VncyA9IChsZW4pID0+IHsgY29uc3QgbWF4U2VnID0gZ2V0V1NwKFNUQVRFLnRlbnQudHlwZSwgbGVuKTsgY29uc3QgY291bnQgPSBNYXRoLm1heCgxLCBNYXRoLmNlaWwobGVuIC8gbWF4U2VnKSk7IGNvbnN0IHNlZ0xlbiA9IGxlbiAvIGNvdW50OyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY291bnQgfSwgKF8sIGkpID0+ICh7IHN0YXJ0OiBpICogc2VnTGVuLCBsZW5ndGg6IHNlZ0xlbiB9KSk7IH07CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdTZWdzID0gY29tcHV0ZVNlZ3MoU1RBVEUudGVudC53aWR0aCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRTZWdzID0gY29tcHV0ZVNlZ3MoU1RBVEUudGVudC5oZWlnaHQpOwogICAgICAgICAgICAgICAgICAgICAgICBTVEFURS50ZW50LnNpZGV3YWxscy5mb3JFYWNoKHdzID0+IHsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWcgPSAod3Muc2lkZT09PSd0b3AnfHx3cy5zaWRlPT09J2JvdHRvbScpID8gd1NlZ3Nbd3MuaW5kZXhdIDogZFNlZ3Nbd3MuaW5kZXhdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzZWcpIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwID0gc2VnLmxlbmd0aDsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1dpbmRvdyA9ICh3cy50eXBlICE9PSAnc29saWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElNUE9SVEFOVDogdGhpcyBjb2RlIGxpdmVzIGluc2lkZSBhIHRlbXBsYXRlIHN0cmluZyAodGhlIGVtYmVkIEhUTUwpLiBEbyBOT1QgdXNlIGJhY2t0aWNrcyBoZXJlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4S2V5ID0gJ3NpZGV3YWxsXycgKyBNYXRoLm1heCgxLCBNYXRoLnJvdW5kKHNwKSkgKyAnXycgKyAoaXNXaW5kb3cgPyAnd2luJyA6ICdzb2xpZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2FsbE1hdCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IG1hcDogZ2V0VGV4KHRleEtleSksIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUsIHRyYW5zcGFyZW50OiBpc1dpbmRvdywgYWxwaGFUZXN0OiBpc1dpbmRvdyA/IDAuMSA6IDAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3YWxsID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkoc3AsIHdhbGxIKSwgd2FsbE1hdCk7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FsbC5wb3NpdGlvbi55ID0gd2FsbEgvMjsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih3cy5zaWRlPT09J3RvcCcpeyB3YWxsLnBvc2l0aW9uLnggPSBzZWcuc3RhcnQgKyBzcC8yOyB3YWxsLnBvc2l0aW9uLnogPSAwLjI1OyB9IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih3cy5zaWRlPT09J2JvdHRvbScpeyB3YWxsLnBvc2l0aW9uLnggPSBzZWcuc3RhcnQgKyBzcC8yOyB3YWxsLnBvc2l0aW9uLnogPSBTVEFURS50ZW50LmhlaWdodC0wLjI1OyB3YWxsLnJvdGF0aW9uLnk9TWF0aC5QSTsgfSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYod3Muc2lkZT09PSdsZWZ0Jyl7IHdhbGwucG9zaXRpb24ueiA9IHNlZy5zdGFydCArIHNwLzI7IHdhbGwucG9zaXRpb24ueCA9IDAuMjU7IHdhbGwucm90YXRpb24ueT1NYXRoLlBJLzI7IH0gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHdzLnNpZGU9PT0ncmlnaHQnKXsgd2FsbC5wb3NpdGlvbi56ID0gc2VnLnN0YXJ0ICsgc3AvMjsgd2FsbC5wb3NpdGlvbi54ID0gU1RBVEUudGVudC53aWR0aC0wLjI1OyB3YWxsLnJvdGF0aW9uLnk9LU1hdGguUEkvMjsgfSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lLmFkZCh3YWxsKTsgCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnN0IGZsb29yTWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IFNUQVRFLnJvb20uZmxvb3JDb2xvciB9KTsKICAgICAgICAgICAgICAgIGNvbnN0IGZsb29yID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkodywgZCksIGZsb29yTWF0KTsgZmxvb3Iucm90YXRpb24ueCA9IC1NYXRoLlBJLzI7IGZsb29yLnJlY2VpdmVTaGFkb3cgPSB0cnVlOyBmbG9vci5wb3NpdGlvbi5zZXQoY2VudGVyWCwgMCwgY2VudGVyWik7IHNjZW5lLmFkZChmbG9vcik7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHdhbGxzR3JvdXAgPSBuZXcgVEhSRUUuR3JvdXAoKTsKICAgICAgICAgICAgICAgIGNvbnN0IHdhbGxNYXQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogU1RBVEUucm9vbS53YWxsQ29sb3IsIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUgfSk7CiAgICAgICAgICAgICAgICBjb25zdCBySCA9IDEyOwogICAgICAgICAgICAgICAgY29uc3QgdzEgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuUGxhbmVHZW9tZXRyeSh3LCBySCksIHdhbGxNYXQpOyB3MS5wb3NpdGlvbi5zZXQoY2VudGVyWCwgckgvMiwgMCk7IHdhbGxzR3JvdXAuYWRkKHcxKTsKICAgICAgICAgICAgICAgIGNvbnN0IHcyID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkodywgckgpLCB3YWxsTWF0KTsgdzIucG9zaXRpb24uc2V0KGNlbnRlclgsIHJILzIsIGQpOyB3Mi5yb3RhdGlvbi55ID0gTWF0aC5QSTsgd2FsbHNHcm91cC5hZGQodzIpOwogICAgICAgICAgICAgICAgY29uc3QgdzMgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuUGxhbmVHZW9tZXRyeShkLCBySCksIHdhbGxNYXQpOyB3My5wb3NpdGlvbi5zZXQoMCwgckgvMiwgY2VudGVyWik7IHczLnJvdGF0aW9uLnkgPSBNYXRoLlBJLzI7IHdhbGxzR3JvdXAuYWRkKHczKTsKICAgICAgICAgICAgICAgIGNvbnN0IHc0ID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkoZCwgckgpLCB3YWxsTWF0KTsgdzQucG9zaXRpb24uc2V0KHcsIHJILzIsIGNlbnRlclopOyB3NC5yb3RhdGlvbi55ID0gLU1hdGguUEkvMjsgd2FsbHNHcm91cC5hZGQodzQpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb25zdCBjZWlsID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkodywgZCksIHdhbGxNYXQpOyBjZWlsLnBvc2l0aW9uLnNldChjZW50ZXJYLCBySCwgY2VudGVyWik7IGNlaWwucm90YXRpb24ueCA9IE1hdGguUEkvMjsgCiAgICAgICAgICAgICAgICBjZWlsLm5hbWUgPSAiY2VpbGluZyI7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHdhbGxzR3JvdXAudmlzaWJsZSA9IFNUQVRFLnNob3dXYWxsczsKICAgICAgICAgICAgICAgIGNlaWwudmlzaWJsZSA9IFNUQVRFLnNob3dSb29mOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzY2VuZS5hZGQod2FsbHNHcm91cCk7CiAgICAgICAgICAgICAgICBzY2VuZS5hZGQoY2VpbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IGdldFN0Z0ggPSAoZngsIGZ6KSA9PiB7IGxldCBtYXggPSAwOyBTVEFURS5pdGVtcy5mb3JFYWNoKG8gPT4geyBpZiAoby5uYW1lLmluY2x1ZGVzKCdzdGFnZS0nKSkgeyBjb25zdCBkID0gSVRFTV9ERUZTW28ubmFtZV07IGlmICghZCkgcmV0dXJuOyBjb25zdCBvVyA9IG8ud2lkdGggfHwgZC53aWR0aCB8fCAxLCBvRCA9IG8uaGVpZ2h0IHx8IGQuaGVpZ2h0IHx8IDE7IGNvbnN0IG1pblggPSAoby54IC8gQ0VMTF9TSVpFKSAtIGJvcmRlckNlbGxzLCBtaW5aID0gKG8ueSAvIENFTExfU0laRSkgLSBib3JkZXJDZWxsczsgaWYgKGZ4ID49IG1pblggJiYgZnggPD0gbWluWCtvVyAmJiBmeiA+PSBtaW5aICYmIGZ6IDw9IG1pblorb0QpIHsgY29uc3QgaCA9IHBhcnNlSW50KG8uc3RhZ2VIZWlnaHQgfHwgJzI0JykgLyAxMjsgaWYgKGggPiBtYXgpIG1heCA9IGg7IH0gfSB9KTsgcmV0dXJuIG1heDsgfTsKCiAgICAgICAgICAgIFNUQVRFLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBkZWYgPSBJVEVNX0RFRlNbaXRlbS5uYW1lXTsgaWYoIWRlZikgcmV0dXJuOwogICAgICAgICAgICAgICAgY29uc3QgaXcgPSBpdGVtLndpZHRoIHx8IGRlZi53aWR0aCB8fCBkZWYuZGlhbWV0ZXIgfHwgMSwgaWggPSBpdGVtLmhlaWdodCB8fCBkZWYuaGVpZ2h0IHx8IGRlZi5kaWFtZXRlciB8fCAxOwogICAgICAgICAgICAgICAgY29uc3QgZnggPSAoaXRlbS54L0NFTExfU0laRSkgLSBib3JkZXJDZWxscyArIChkZWYudHlwZSA9PT0gJ2RyYXBlJyA/IDAgOiBpdy8yKSwgZnogPSAoaXRlbS55L0NFTExfU0laRSkgLSBib3JkZXJDZWxscyArIChkZWYudHlwZSA9PT0gJ2RyYXBlJyA/IDAgOiBpaC8yKTsKICAgICAgICAgICAgICAgIGNvbnN0IHJvdCA9IC1pdGVtLmFuZ2xlICogKE1hdGguUEkvMTgwKTsKICAgICAgICAgICAgICAgIGlmKGRlZi50eXBlID09PSAnZHJhcGUnICYmIGl0ZW0uZHJhcGVQb2ludHMpIHsKICAgICAgICAgICAgICAgICAgIGNvbnN0IGRQb2ludHMgPSBpdGVtLmRyYXBlUG9pbnRzLm1hcChwID0+IHsKICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmFkID0gLShpdGVtLmFuZ2xlIHx8IDApICogKE1hdGguUEkgLyAxODApOwogICAgICAgICAgICAgICAgICAgICBjb25zdCByeCA9IChwLnggKiBNYXRoLmNvcyhyYWQpIC0gcC55ICogTWF0aC5zaW4ocmFkKSkgLyBDRUxMX1NJWkU7CiAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJ6ID0gKHAueCAqIE1hdGguc2luKHJhZCkgKyBwLnkgKiBNYXRoLmNvcyhyYWQpKSAvIENFTExfU0laRTsKICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgeDogZnggKyByeCwgeTogZnogKyByeiB9OwogICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICBjb25zdCBkSHRzID0gaXRlbS5kcmFwZUhlaWdodHMgfHwgQXJyYXkoaXRlbS5kcmFwZVBvaW50cy5sZW5ndGggLSAxKS5maWxsKGl0ZW0uZHJhcGVIZWlnaHQgfHwgJzhmdCcpOwogICAgICAgICAgICAgICAgICAgc2NlbmUuYWRkKGNyZWF0ZURyYXBlTW9kdWxlKGRQb2ludHMsIGRIdHMsIGl0ZW0uY29sb3IpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZihpdGVtLm5hbWUuaW5jbHVkZXMoJ21vZGVybi1sb3VuZ2UnKSkgewogICAgICAgICAgICAgICAgICAgY29uc3QgZ1kgPSBnZXRTdGdIKGZ4LCBmeik7CiAgICAgICAgICAgICAgICAgICBjb25zdCBsb3VuZ2UgPSBjcmVhdGVNb2Rlcm5Mb3VuZ2UzRChpdGVtLm5hbWUsIGl3LCBpaCwgaXRlbS5jb2xvcik7CiAgICAgICAgICAgICAgICAgICBsb3VuZ2UudXNlckRhdGEuaXNGdXJuaXR1cmUgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgbG91bmdlLnVzZXJEYXRhLmZ1cm5pdHVyZUtleSA9IGl0ZW0ubmFtZTsKICAgICAgICAgICAgICAgICAgIGxvdW5nZS5wb3NpdGlvbi5zZXQoZngsIGdZICsgKGl0ZW0uZWxldmF0aW9uIHx8IDApLCBmeik7CiAgICAgICAgICAgICAgICAgICBsb3VuZ2Uucm90YXRpb24ueSA9IHJvdDsKICAgICAgICAgICAgICAgICAgIGxvdW5nZS50cmF2ZXJzZShuID0+IHsgaWYgKG4gaW5zdGFuY2VvZiBUSFJFRS5NZXNoKSB7IG4uY2FzdFNoYWRvdyA9IHRydWU7IG4ucmVjZWl2ZVNoYWRvdyA9IHRydWU7IH0gfSk7CiAgICAgICAgICAgICAgICAgICBzY2VuZS5hZGQobG91bmdlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZihpdGVtLm5hbWUgPT09ICdpbmZpbml0eS1iYXInKSB7CiAgICAgICAgICAgICAgICAgICBjb25zdCBnWSA9IGdldFN0Z0goZngsIGZ6KTsKICAgICAgICAgICAgICAgICAgIGVuc3VyZUZ1cm5pdHVyZUdsYkxvYWRlZCgnaW5maW5pdHktYmFyJyk7CiAgICAgICAgICAgICAgICAgICBjb25zdCBiYXIgPSBuZXcgVEhSRUUuR3JvdXAoKTsKICAgICAgICAgICAgICAgICAgIGJhci51c2VyRGF0YS5pc0Z1cm5pdHVyZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICBiYXIudXNlckRhdGEuZnVybml0dXJlS2V5ID0gJ2luZmluaXR5LWJhcic7CiAgICAgICAgICAgICAgICAgICBjb25zdCBwcm90byA9IGZ1cm5pdHVyZUdsYlByb3RvQnlLZXlbJ2luZmluaXR5LWJhciddOwogICAgICAgICAgICAgICAgICAgaWYgKHByb3RvKSB7CiAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGluc3QgPSBwcm90by5jbG9uZSh0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgaW5zdC50cmF2ZXJzZShuID0+IHsgaWYgKG4gaW5zdGFuY2VvZiBUSFJFRS5NZXNoKSB7IG4uY2FzdFNoYWRvdyA9IHRydWU7IG4ucmVjZWl2ZVNoYWRvdyA9IHRydWU7IH0gfSk7CiAgICAgICAgICAgICAgICAgICAgIGJhci5hZGQoaW5zdCk7CiAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICBjb25zdCBoMyA9IEZVUk5JVFVSRV9HTEJfVEFSR0VUX0hFSUdIVF9GVFsnaW5maW5pdHktYmFyJ10gfHwgNC4wOwogICAgICAgICAgICAgICAgICAgICBjb25zdCBnZW8gPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoaXcsIGgzLCBpaCk7CiAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweDExMTExMSwgcm91Z2huZXNzOiAwLjg1LCBtZXRhbG5lc3M6IDAuMSB9KTsKICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVzaCA9IG5ldyBUSFJFRS5NZXNoKGdlbywgbWF0KTsKICAgICAgICAgICAgICAgICAgICAgbWVzaC5wb3NpdGlvbi55ID0gaDMgLyAyOwogICAgICAgICAgICAgICAgICAgICBtZXNoLmNhc3RTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICBtZXNoLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICBiYXIuYWRkKG1lc2gpOwogICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgYmFyLnBvc2l0aW9uLnNldChmeCwgZ1kgKyAoaXRlbS5lbGV2YXRpb24gfHwgMCksIGZ6KTsKICAgICAgICAgICAgICAgICAgIGJhci5yb3RhdGlvbi55ID0gcm90OwogICAgICAgICAgICAgICAgICAgc2NlbmUuYWRkKGJhcik7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIH0gZWxzZSBpZihpdGVtLm5hbWUgJiYgISFGVVJOSVRVUkVfR0xCX1VSTFNbaXRlbS5uYW1lXSAmJiAhaXRlbS5uYW1lLmluY2x1ZGVzKCdtb2Rlcm4tbG91bmdlJykgJiYgaXRlbS5uYW1lICE9PSAnaW5maW5pdHktYmFyJykgewogICAgICAgICAgICAgICAgICAgY29uc3QgZ1kgPSBnZXRTdGdIKGZ4LCBmeik7CiAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBpdGVtLm5hbWU7CiAgICAgICAgICAgICAgICAgICBlbnN1cmVGdXJuaXR1cmVHbGJMb2FkZWQoa2V5KTsKICAgICAgICAgICAgICAgICAgIGNvbnN0IGdycCA9IG5ldyBUSFJFRS5Hcm91cCgpOwogICAgICAgICAgICAgICAgICAgZ3JwLnVzZXJEYXRhLmlzRnVybml0dXJlID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgIGdycC51c2VyRGF0YS5mdXJuaXR1cmVLZXkgPSBrZXk7CiAgICAgICAgICAgICAgICAgICBjb25zdCBwcm90byA9IGZ1cm5pdHVyZUdsYlByb3RvQnlLZXlba2V5XTsKICAgICAgICAgICAgICAgICAgIGlmIChwcm90bykgewogICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnN0ID0gcHJvdG8uY2xvbmUodHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgIGluc3QudHJhdmVyc2UobiA9PiB7IGlmIChuIGluc3RhbmNlb2YgVEhSRUUuTWVzaCkgeyBuLmNhc3RTaGFkb3cgPSB0cnVlOyBuLnJlY2VpdmVTaGFkb3cgPSB0cnVlOyB9IH0pOwogICAgICAgICAgICAgICAgICAgICBncnAuYWRkKGluc3QpOwogICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgY29uc3QgaDMgPSBGVVJOSVRVUkVfR0xCX1RBUkdFVF9IRUlHSFRfRlRba2V5XSB8fCA0LjA7CiAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGdlbyA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeShpdywgaDMsIGloKTsKICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IG5ldyBUSFJFRS5Db2xvcihpdGVtLmNvbG9yIHx8ICcjODg4ODg4JyksIHJvdWdobmVzczogMC44NSwgbWV0YWxuZXNzOiAwLjAgfSk7CiAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc2ggPSBuZXcgVEhSRUUuTWVzaChnZW8sIG1hdCk7CiAgICAgICAgICAgICAgICAgICAgIG1lc2gucG9zaXRpb24ueSA9IGgzIC8gMjsKICAgICAgICAgICAgICAgICAgICAgbWVzaC5jYXN0U2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgbWVzaC5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgZ3JwLmFkZChtZXNoKTsKICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgIGdycC5wb3NpdGlvbi5zZXQoZngsIGdZICsgKGl0ZW0uZWxldmF0aW9uIHx8IDApLCBmeik7CiAgICAgICAgICAgICAgICAgICBncnAucm90YXRpb24ueSA9IHJvdDsKICAgICAgICAgICAgICAgICAgIHNjZW5lLmFkZChncnApOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmKGl0ZW0ubmFtZS5pbmNsdWRlcygndHJ1c3Mtc2VjdGlvbicpKSB7CiAgICAgICAgICAgICAgICAgICBjb25zdCBnWSA9IGdldFN0Z0goZngsIGZ6KTsKICAgICAgICAgICAgICAgICAgIGNvbnN0IHRydXNzID0gY3JlYXRlVHJ1c3MzRChpdywgaWgpOwogICAgICAgICAgICAgICAgICAgdHJ1c3MucG9zaXRpb24uc2V0KGZ4LCBnWSArIChpdGVtLmVsZXZhdGlvbiB8fCAwKSwgZnopOwogICAgICAgICAgICAgICAgICAgdHJ1c3Mucm90YXRpb24ueSA9IHJvdDsKICAgICAgICAgICAgICAgICAgIHNjZW5lLmFkZCh0cnVzcyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoaXRlbS5uYW1lLmluY2x1ZGVzKCd0cnVzcy10b3RlbScpKSB7CiAgICAgICAgICAgICAgICAgICBjb25zdCBnWSA9IGdldFN0Z0goZngsIGZ6KTsKICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvdGVtID0gY3JlYXRlVHJ1c3NUb3RlbTNEKGl3KTsKICAgICAgICAgICAgICAgICAgIHRvdGVtLnBvc2l0aW9uLnNldChmeCwgZ1kgKyAoaXRlbS5lbGV2YXRpb24gfHwgMCksIGZ6KTsKICAgICAgICAgICAgICAgICAgIHRvdGVtLnJvdGF0aW9uLnkgPSByb3Q7CiAgICAgICAgICAgICAgICAgICBzY2VuZS5hZGQodG90ZW0pOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmKGl0ZW0ubmFtZS5pbmNsdWRlcygnc3RhZ2UnKSkgewogICAgICAgICAgICAgICAgICAgY29uc3QgaEluID0gcGFyc2VJbnQoaXRlbS5zdGFnZUhlaWdodCB8fCAnMjQnKTsKICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0ZyA9IGNyZWF0ZUJpbGpheFN0YWdlKGl3LCBpaCwgaEluLCBpdGVtLnN0YWdlU2tpcnQgfHwgJ25vbmUnKTsKICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlaWdodEZ0ID0gaEluIC8gMTI7CiAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5zdGFnZUd1YXJkcmFpbHMgJiYgaXRlbS5zdGFnZUd1YXJkcmFpbHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgc3RnLmFkZChjcmVhdGVTdGFnZUd1YXJkcmFpbHMzRChpdywgaWgsIGhlaWdodEZ0LCBpdGVtLnN0YWdlR3VhcmRyYWlscykpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpdGVtLnN0YWdlU3RhaXJzKSAmJiBpdGVtLnN0YWdlU3RhaXJzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgIHN0Zy5hZGQoY3JlYXRlU3RhZ2VTdGFpcnMzRChpdywgaWgsIGhlaWdodEZ0LCBoSW4sIGl0ZW0uc3RhZ2VTdGFpcnMpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICBzdGcucG9zaXRpb24uc2V0KGZ4LCAwLCBmeik7CiAgICAgICAgICAgICAgICAgICBzdGcucm90YXRpb24ueSA9IHJvdDsKICAgICAgICAgICAgICAgICAgIHNjZW5lLmFkZChzdGcpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmKGRlZi50eXBlID09PSAnc3RydWN0dXJlJyAmJiBkZWYudGVudFR5cGUpIHsKICAgICAgICAgICAgICAgICAgY29uc3QgdGVudE1lc2ggPSBjcmVhdGVUZW50TWVzaChpdywgaWgsIGRlZi50ZW50VHlwZSwgZmFsc2UsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBkZWYuc2lkZUxlbmd0aCk7CgogICAgICAgICAgICAgICAgICAgLy8gQWRkLW9uIHRlbnQgc2lkZXdhbGxzICh3aW5kb3cgYnkgZGVmYXVsdDsgc2hpZnQtY2xpY2tlZCB3YWxscyBjYW4gYmUgU09MSUQpCiAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtU2lkZXdhbGxzID0gKGl0ZW0gJiYgKGl0ZW0uaXRlbVNpZGV3YWxscyB8fCBpdGVtLnNpZGV3YWxscykpIHx8IFtdOwogICAgICAgICAgICAgICAgICAgaWYgKFNUQVRFLnNob3dXYWxscyAmJiBBcnJheS5pc0FycmF5KGl0ZW1TaWRld2FsbHMpICYmIGl0ZW1TaWRld2FsbHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdhbGxIID0gODsKCiAgICAgICAgICAgICAgICAgICAgIC8vIEhleCBhZGQtb24gdGVudHM6IDYgZnVsbC1sZW5ndGggcGFuZWxzIChzaWRlOiAnaGV4JywgaW5kZXg6IDAuLjUpCiAgICAgICAgICAgICAgICAgICAgIGlmIChkZWYudGVudFR5cGUgPT09ICdIZXgnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2lkZUxlbiA9ICh0eXBlb2YgZGVmLnNpZGVMZW5ndGggPT09ICdudW1iZXInICYmIGlzRmluaXRlKGRlZi5zaWRlTGVuZ3RoKSkgPyBkZWYuc2lkZUxlbmd0aCA6IChpaCAvIDIpOwogICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBzaWRlTGVuOwogICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN4ID0gaXcgLyAyOwogICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN6ID0gaWggLyAyOwogICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZlcnRzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogNiB9LCAoXywgaSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYSA9IC1NYXRoLlBJIC8gMiArIGkgKiBNYXRoLlBJIC8gMzsKICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHg6IChjeCArIHIgKiBNYXRoLmNvcyhhKSkgLSAoaXcgLyAyKSwgejogKGN6ICsgciAqIE1hdGguc2luKGEpKSAtIChpaCAvIDIpIH07CiAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdhbGxzTG9jYWwgPSBuZXcgVEhSRUUuR3JvdXAoKTsKICAgICAgICAgICAgICAgICAgICAgICB3YWxsc0xvY2FsLm5hbWUgPSAnaXRlbVNpZGV3YWxscyc7CiAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gMC4yNTsKCiAgICAgICAgICAgICAgICAgICAgICAgaXRlbVNpZGV3YWxscy5mb3JFYWNoKHdzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3cy5zaWRlICE9PSAnaGV4JykgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9ICgod3MuaW5kZXggJSA2KSArIDYpICUgNjsKICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFWID0gdmVydHNbaV07CiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiViA9IHZlcnRzWyhpICsgMSkgJSA2XTsKICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG14ID0gKGFWLnggKyBiVi54KSAvIDI7CiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBteiA9IChhVi56ICsgYlYueikgLyAyOwoKICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpciA9IG5ldyBUSFJFRS5WZWN0b3IzKGJWLnggLSBhVi54LCAwLCBiVi56IC0gYVYueik7CiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB5YXcgPSBNYXRoLmF0YW4yKGRpci56LCBkaXIueCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0d2FyZCA9IG5ldyBUSFJFRS5WZWN0b3IzKG14LCAwLCBteik7CiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3V0d2FyZC5sZW5ndGgoKSA+IDAuMDAwMSkgb3V0d2FyZC5ub3JtYWxpemUoKTsgZWxzZSBvdXR3YXJkLnNldCgwLCAwLCAxKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1dpbmRvdyA9ICgod3MudHlwZSB8fCAnd2luZG93JykgIT09ICdzb2xpZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3AgPSBNYXRoLm1heCgxLCBNYXRoLnJvdW5kKHNpZGVMZW4pKTsKICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRleEtleSA9ICdzaWRld2FsbF8nICsgc3AgKyAnXycgKyAoaXNXaW5kb3cgPyAnd2luJyA6ICdzb2xpZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgbWFwOiBnZXRUZXgodGV4S2V5KSwgc2lkZTogVEhSRUUuRG91YmxlU2lkZSwgdHJhbnNwYXJlbnQ6IGlzV2luZG93LCBhbHBoYVRlc3Q6IGlzV2luZG93ID8gMC4xIDogMCB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdhbGwgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuUGxhbmVHZW9tZXRyeShzaWRlTGVuLCB3YWxsSCksIG1hdCk7CiAgICAgICAgICAgICAgICAgICAgICAgICB3YWxsLnBvc2l0aW9uLnNldChteCArIG91dHdhcmQueCAqIG9mZnNldCwgd2FsbEggLyAyLCBteiArIG91dHdhcmQueiAqIG9mZnNldCk7CiAgICAgICAgICAgICAgICAgICAgICAgICB3YWxsLnJvdGF0aW9uLnkgPSAteWF3OwogICAgICAgICAgICAgICAgICAgICAgICAgd2FsbHNMb2NhbC5hZGQod2FsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgIHRlbnRNZXNoLmFkZCh3YWxsc0xvY2FsKTsKICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBnZXRXU3AgPSAodCwgbGVuKSA9PiB0ID09PSAnUG9wdXAnID8gMTAgOiAodCA9PT0gJ1BvbGUnID8gMjAgOiAobGVuICUgMTUgPT09IDAgPyAxNSA6IDIwKSk7CiAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYnVpbGRTZWdzID0gKHRULCBsZW4pID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwID0gZ2V0V1NwKHRULCBsZW4pOwogICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY291bnQgPSBNYXRoLm1heCgxLCBNYXRoLnJvdW5kKGxlbiAvIHNwKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3R1YWwgPSBsZW4gLyBjb3VudDsKICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHsgbGVuZ3RoOiBjb3VudCB9LCAoXywgaSkgPT4gKHsgc3RhcnQ6IGkgKiBhY3R1YWwsIGxlbjogYWN0dWFsIH0pKTsKICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdTZWdzID0gYnVpbGRTZWdzKGRlZi50ZW50VHlwZSwgaXcpOwogICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRTZWdzID0gYnVpbGRTZWdzKGRlZi50ZW50VHlwZSwgaWgpOwoKICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3YWxsc0xvY2FsID0gbmV3IFRIUkVFLkdyb3VwKCk7CiAgICAgICAgICAgICAgICAgICAgICAgd2FsbHNMb2NhbC5uYW1lID0gJ2l0ZW1TaWRld2FsbHMnOwogICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IDAuMjU7CgogICAgICAgICAgICAgICAgICAgICAgIGl0ZW1TaWRld2FsbHMuZm9yRWFjaCh3cyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWdMaXN0ID0gKHdzLnNpZGUgPT09ICd0b3AnIHx8IHdzLnNpZGUgPT09ICdib3R0b20nKSA/IHdTZWdzIDogZFNlZ3M7CiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWcgPSBzZWdMaXN0W3dzLmluZGV4XTsKICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2VnKSByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzcCA9IHNlZy5sZW47CiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1dpbmRvdyA9ICgod3MudHlwZSB8fCAnd2luZG93JykgIT09ICdzb2xpZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4S2V5ID0gJ3NpZGV3YWxsXycgKyBNYXRoLm1heCgxLCBNYXRoLnJvdW5kKHNwKSkgKyAnXycgKyAoaXNXaW5kb3cgPyAnd2luJyA6ICdzb2xpZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgbWFwOiBnZXRUZXgodGV4S2V5KSwgc2lkZTogVEhSRUUuRG91YmxlU2lkZSwgdHJhbnNwYXJlbnQ6IGlzV2luZG93LCBhbHBoYVRlc3Q6IGlzV2luZG93ID8gMC4xIDogMCB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdhbGwgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuUGxhbmVHZW9tZXRyeShzcCwgd2FsbEgpLCBtYXQpOwogICAgICAgICAgICAgICAgICAgICAgICAgd2FsbC5wb3NpdGlvbi55ID0gd2FsbEggLyAyOwoKICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3cy5zaWRlID09PSAndG9wJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICB3YWxsLnBvc2l0aW9uLnggPSAoLWl3IC8gMikgKyBzZWcuc3RhcnQgKyBzcCAvIDI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhbGwucG9zaXRpb24ueiA9ICgtaWggLyAyKSArIG9mZnNldDsKICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAod3Muc2lkZSA9PT0gJ2JvdHRvbScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FsbC5wb3NpdGlvbi54ID0gKC1pdyAvIDIpICsgc2VnLnN0YXJ0ICsgc3AgLyAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICB3YWxsLnBvc2l0aW9uLnogPSAoaWggLyAyKSAtIG9mZnNldDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FsbC5yb3RhdGlvbi55ID0gTWF0aC5QSTsKICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAod3Muc2lkZSA9PT0gJ2xlZnQnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhbGwucG9zaXRpb24ueCA9ICgtaXcgLyAyKSArIG9mZnNldDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FsbC5wb3NpdGlvbi56ID0gKC1paCAvIDIpICsgc2VnLnN0YXJ0ICsgc3AgLyAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICB3YWxsLnJvdGF0aW9uLnkgPSBNYXRoLlBJIC8gMjsKICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAod3Muc2lkZSA9PT0gJ3JpZ2h0JykgewogICAgICAgICAgICAgICAgICAgICAgICAgICB3YWxsLnBvc2l0aW9uLnggPSAoaXcgLyAyKSAtIG9mZnNldDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FsbC5wb3NpdGlvbi56ID0gKC1paCAvIDIpICsgc2VnLnN0YXJ0ICsgc3AgLyAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICB3YWxsLnJvdGF0aW9uLnkgPSAtTWF0aC5QSSAvIDI7CiAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgd2FsbHNMb2NhbC5hZGQod2FsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgIHRlbnRNZXNoLmFkZCh3YWxsc0xvY2FsKTsKICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgIHRlbnRNZXNoLnBvc2l0aW9uLnNldChmeCwgMCwgZnopOwogICAgICAgICAgICAgICAgICAgdGVudE1lc2gucm90YXRpb24ueSA9IHJvdDsKICAgICAgICAgICAgICAgICAgIHNjZW5lLmFkZCh0ZW50TWVzaCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoaXRlbS5uYW1lID09PSAnY2hhaXItc2luZ2xlJykgewogICAgICAgICAgICAgICAgICAgY29uc3QgZ1kgPSBnZXRTdGdIKGZ4LCBmeik7CiAgICAgICAgICAgICAgICAgICBjb25zdCBjaCA9IGNyZWF0ZUNoYWlyR3JvdXAocm90LCBpdGVtLmNoYWlyU3R5bGUsIGl0ZW0uY2hpYXZhcmlDdXNoaW9uKTsKICAgICAgICAgICAgICAgICAgIGNoLnBvc2l0aW9uLnNldChmeCwgZ1kgKyAoaXRlbS5lbGV2YXRpb24gfHwgMCksIGZ6KTsKICAgICAgICAgICAgICAgICAgIHNjZW5lLmFkZChjaCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoaXRlbS5uYW1lID09PSAnY2hhaXItcm93JykgewogICAgICAgICAgICAgICAgICAgY29uc3QgZ1kgPSBnZXRTdGdIKGZ4LCBmeik7CiAgICAgICAgICAgICAgICAgICBjb25zdCBzdHlsZU92ZXJyaWRlID0gaXRlbS5jaGFpclN0eWxlOwogICAgICAgICAgICAgICAgICAgY29uc3QgY3VzaGlvbk92ZXJyaWRlID0gaXRlbS5jaGlhdmFyaUN1c2hpb247CiAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gTWF0aC5tYXgoMSwgaXRlbS5zZWF0cyB8fCBkZWYuc2VhdHMgfHwgMSk7CiAgICAgICAgICAgICAgICAgICBjb25zdCBzcGFjaW5nID0gKHR5cGVvZiBpdGVtLmNoYWlyU3BhY2luZyA9PT0gJ251bWJlcicpID8gaXRlbS5jaGFpclNwYWNpbmcgOiAyLjA7CiAgICAgICAgICAgICAgICAgICBjb25zdCBzcGFuID0gKG4gLSAxKSAqIHNwYWNpbmc7CiAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJ2ZUFtdCA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIGl0ZW0uY2hhaXJDdXJ2ZSB8fCAwKSk7CiAgICAgICAgICAgICAgICAgICBjb25zdCBkaXIgPSBpdGVtLmNoYWlyRmxpcCA/IC0xIDogMTsKICAgICAgICAgICAgICAgICAgIGNvbnN0IG1heEJvdyA9IE1hdGgubWluKHNwYW4gLyAzLCA2KTsKICAgICAgICAgICAgICAgICAgIGNvbnN0IGJvdyA9IGN1cnZlQW10ICogbWF4Qm93ICogZGlyOwoKICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvdyA9IG5ldyBUSFJFRS5Hcm91cCgpOwogICAgICAgICAgICAgICAgICAgcm93LnBvc2l0aW9uLnNldChmeCwgZ1kgKyAoaXRlbS5lbGV2YXRpb24gfHwgMCksIGZ6KTsKICAgICAgICAgICAgICAgICAgIHJvdy5yb3RhdGlvbi55ID0gcm90OwoKICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHggPSAtc3BhbiAvIDIgKyBpICogc3BhY2luZzsKICAgICAgICAgICAgICAgICAgICAgY29uc3QgeE5vcm0gPSBzcGFuID4gMCA/ICh4IC8gKHNwYW4gLyAyKSkgOiAwOwogICAgICAgICAgICAgICAgICAgICBjb25zdCB6ID0gYm93ICogKDEgLSB4Tm9ybSAqIHhOb3JtKTsKCiAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYWlyID0gY3JlYXRlQ2hhaXJHcm91cCgwLCBzdHlsZU92ZXJyaWRlLCBjdXNoaW9uT3ZlcnJpZGUpOwogICAgICAgICAgICAgICAgICAgICBjaGFpci5wb3NpdGlvbi5zZXQoeCwgMCwgeik7CiAgICAgICAgICAgICAgICAgICAgIHJvdy5hZGQoY2hhaXIpOwogICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgIHNjZW5lLmFkZChyb3cpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0ubmFtZSA9PT0gJ2NoYWlyLWNpcmNsZScpIHsKICAgICAgICAgICAgICAgICAgIC8vIENpcmNsZSBzZWF0aW5nOiBjaGFpcnMgYXJlIHByZWNvbXB1dGVkIChmZWV0KSB1c2luZyB0aGUgc2hhcmVkIGhlbHBlciBpbiB0aGUgaG9zdCBhcHAuCiAgICAgICAgICAgICAgICAgICBjb25zdCBnWSA9IGdldFN0Z0goZngsIGZ6KTsKICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0eWxlT3ZlcnJpZGUgPSBpdGVtLmNoYWlyU3R5bGU7CiAgICAgICAgICAgICAgICAgICBjb25zdCBjdXNoaW9uT3ZlcnJpZGUgPSBpdGVtLmNoaWF2YXJpQ3VzaGlvbjsKCiAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFpcnMgPSBBcnJheS5pc0FycmF5KGl0ZW0uY2hhaXJDaXJjbGVDaGFpcnMpID8gaXRlbS5jaGFpckNpcmNsZUNoYWlycyA6IFtdOwoKICAgICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gbmV3IFRIUkVFLkdyb3VwKCk7CiAgICAgICAgICAgICAgICAgICBncm91cC5wb3NpdGlvbi5zZXQoZngsIGdZICsgKGl0ZW0uZWxldmF0aW9uIHx8IDApLCBmeik7CiAgICAgICAgICAgICAgICAgICBncm91cC5yb3RhdGlvbi55ID0gcm90OwoKICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hQb3Mgb2YgY2hhaXJzKSB7CiAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYWlyID0gY3JlYXRlQ2hhaXJHcm91cChjaFBvcy5yb3RSYWQsIHN0eWxlT3ZlcnJpZGUsIGN1c2hpb25PdmVycmlkZSk7CiAgICAgICAgICAgICAgICAgICAgIGNoYWlyLnBvc2l0aW9uLnNldChjaFBvcy54RnQsIDAsIGNoUG9zLnpGdCk7CiAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmFkZChjaGFpcik7CiAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgc2NlbmUuYWRkKGdyb3VwKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZihpdGVtLm5hbWUgJiYgU3RyaW5nKGl0ZW0ubmFtZSkuc3RhcnRzV2l0aCgncGVyc29uLScpKSB7CiAgICAgICAgICAgICAgICAgICBjb25zdCBnWSA9IGdldFN0Z0goZngsIGZ6KTsKICAgICAgICAgICAgICAgICAgIGNvbnN0IHBlcnNvbiA9IGNyZWF0ZVBlcnNvbjNEKGl0ZW0ubmFtZSwgaXcsIGloLCBpdGVtLmNvbG9yKTsKICAgICAgICAgICAgICAgICAgIHBlcnNvbi5wb3NpdGlvbi5zZXQoZngsIGdZICsgKGl0ZW0uZWxldmF0aW9uIHx8IDApLCBmeik7CiAgICAgICAgICAgICAgICAgICBwZXJzb24ucm90YXRpb24ueSA9IHJvdDsKICAgICAgICAgICAgICAgICAgIHBlcnNvbi50cmF2ZXJzZShuID0+IHsgaWYgKG4gJiYgbi5pc01lc2gpIHsgbi5jYXN0U2hhZG93ID0gdHJ1ZTsgbi5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsgfSB9KTsKICAgICAgICAgICAgICAgICAgIHNjZW5lLmFkZChwZXJzb24pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzRCA9IGl0ZW0ubmFtZS5pbmNsdWRlcygnZGFuY2UnKTsgY29uc3QgZ1kgPSBpc0QgPyAwIDogZ2V0U3RnSChmeCwgZnopOyBjb25zdCB0SCA9IGlzRCA/IDAuMDUgOiAoaXRlbS5uYW1lLmluY2x1ZGVzKCdiYXInKSA/IDQuMCA6IChpdGVtLm5hbWUuaW5jbHVkZXMoJ2NvY2t0YWlsJykgPyAzLjY1IDogMi41KSk7IGNvbnN0IGhhc0wgPSBpdGVtLmxpbmVuICYmIGl0ZW0ubGluZW4gIT09ICdub25lJzsgY29uc3QgbGluQyA9IGhhc0wgPyAoaXRlbS5saW5lbiA9PT0gJ3doaXRlJyA/IDB4ZmZmZmZmIDogKGl0ZW0ubGluZW4gPT09ICdibGFjaycgPyAweDExMTExMSA6IChpdGVtLmxpbmVuLnN0YXJ0c1dpdGgoJyMnKSA/IHBhcnNlSW50KGl0ZW0ubGluZW4ucmVwbGFjZSgnIycsICcweCcpKSA6IDB4ZmZmZmZmKSkpIDogMHhiNTgzNWE7CiAgICAgICAgICAgICAgICAgICBjb25zdCBncm91cCA9IG5ldyBUSFJFRS5Hcm91cCgpOyAKICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0ubmFtZS5pbmNsdWRlcygnY29ja3RhaWwnKSkgewogICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNMKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdXJnbGFzcyBTcGFuZGV4IE1vZGVsIGZvciBFbWJlZAogICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdHMgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9wUiA9IGl3IC8gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgcHRzLnB1c2gobmV3IFRIUkVFLlZlY3RvcjIoMCwgMCkpOyAvLyBTdGFydCBjZW50ZXIgYm90dG9tCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IDIwOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGkgLyAyMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHRvcFIgKiAoMC42ICsgMC40ICogTWF0aC5wb3coTWF0aC5hYnModCAqIDIgLSAxKSwgMikpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdHMucHVzaChuZXcgVEhSRUUuVmVjdG9yMihyLCB0ICogdEgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICBwdHMucHVzaChuZXcgVEhSRUUuVmVjdG9yMigwLCB0SCkpOyAvLyBFbmQgY2VudGVyIHRvcAogICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzcGFuZGV4R2VvID0gbmV3IFRIUkVFLkxhdGhlR2VvbWV0cnkocHRzLCAzMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwYW5kZXggPSBuZXcgVEhSRUUuTWVzaChzcGFuZGV4R2VvLCBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogbGluQywgcm91Z2huZXNzOiAwLjkgfSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cC5hZGQoc3BhbmRleCk7CiAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hyb21lIFBlZGVzdGFsIGZvciBFbWJlZAogICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0b3BEaXNjID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkoaXcvMiwgaXcvMiwgMC4wOCwgMzIpLCBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogbGluQywgcm91Z2huZXNzOiAwLjIgfSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICB0b3BEaXNjLnBvc2l0aW9uLnkgPSB0SDsgZ3JvdXAuYWRkKHRvcERpc2MpOwogICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwaWxsYXIgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeSgwLjA4LCAwLjEsIHRILCAxMiksIG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IGNvbG9yOiAweDk0YTNiOCwgbWV0YWxuZXNzOiAwLjksIHJvdWdobmVzczogMC4xIH0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgcGlsbGFyLnBvc2l0aW9uLnkgPSB0SCAvIDI7IGdyb3VwLmFkZChwaWxsYXIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiYXNlTWF0ID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4MzMzMzMzLCByb3VnaG5lc3M6IDAuNyB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYW5nID0gKGkgKiBNYXRoLlBJKSAvIDI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxlZyA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSgxLjIsIDAuMDgsIDAuMiksIGJhc2VNYXQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWcucG9zaXRpb24uc2V0KE1hdGguY29zKGFuZykgKiAwLjUsIDAuMDQsIE1hdGguc2luKGFuZykgKiAwLjUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWcucm90YXRpb24ueSA9IC1hbmc7IGdyb3VwLmFkZChsZWcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0b3BHID0gZGVmLnR5cGUgPT09ICdyb3VuZCcgPyBuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeShpdy8yLCBpdy8yLCAwLjEsIDMyKSA6IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeShpdywgMC4xLCBpaCk7IGNvbnN0IHRvcE0gPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBjb2xvcjogbGluQyB9KTsgY29uc3QgdG9wID0gbmV3IFRIUkVFLk1lc2godG9wRywgdG9wTSk7IHRvcC5wb3NpdGlvbi55ID0gdEggKyAoaXNEID8gMCA6IDAuMDEpOyBncm91cC5hZGQodG9wKTsKICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzTCkgeyBjb25zdCBza0cgPSBkZWYudHlwZSA9PT0gJ3JvdW5kJyA/IG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KGl3LzIrMC4wNSwgaXcvMiswLjEsIHRILCAzMiwgMSwgdHJ1ZSkgOiBuZXcgVEhSRUUuQm94R2VvbWV0cnkoaXcrMC4xLCB0SCwgaWgrMC4xKTsgY29uc3Qgc2tNID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IGxpbkMsIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUgfSk7IGNvbnN0IHNrID0gbmV3IFRIUkVFLk1lc2goc2tHLCBza00pOyBzay5wb3NpdGlvbi55ID0gdEggLyAyOyBncm91cC5hZGQoc2spOyB9CiAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIWlzRCkgeyBjb25zdCBsUiA9IDAuMDY7IGNvbnN0IGxNID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgY29sb3I6IDB4NjY2NjY2IH0pOyBjb25zdCBhZGRMID0gKGx4LCBseikgPT4geyBjb25zdCBsZWcgPSBuZXcgVEhSRUUuTWVzaChuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeShsUiwgbFIsIHRILCA4KSwgbE0pOyBsZWcucG9zaXRpb24uc2V0KGx4LCB0SCAvIDIsIGx6KTsgZ3JvdXAuYWRkKGxlZyk7IH07IGNvbnN0IGlucyA9IDAuNDsgaWYgKGRlZi50eXBlID09PSAncm91bmQnKSB7IGZvciAobGV0IGk9MDsgaTw0OyBpKyspIHsgY29uc3QgYSA9IChpKk1hdGguUEkpLzI7IGFkZEwoKGl3LzItaW5zKSpNYXRoLmNvcyhhKSwgKGl3LzItaW5zKSpNYXRoLnNpbihhKSk7IH0gfSBlbHNlIHsgW1stMSwtMV0sIFsxLC0xXSwgWy0xLDFdLCBbMSwxXV0uZm9yRWFjaCgoW3N4LCBzel0pID0+IHsgYWRkTChzeCooaXcvMi1pbnMpLCBzeiooaWgvMi1pbnMpKTsgfSk7IH0gfSAKICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uc2VhdHMgPiAwICYmICFpdGVtLm5hbWUuc3RhcnRzV2l0aCgnY2hhaXItJykpIHsgY29uc3QgY0QgPSBnZXRDaGFpclRhYmxlVHVja0Rpc3RGdChTVEFURS5jaGFpclN0eWxlIHx8ICdmb2xkaW5nX3doaXRlJywgISFTVEFURS5jaGlhdmFyaUN1c2hpb24pICsgKGhhc0wgPyAwLjA1IDogMCk7IGlmIChkZWYudHlwZSA9PT0gJ3JvdW5kJykgeyBjb25zdCByYWQgPSBpdy8yK2NEOyBmb3IgKGxldCBpPTA7IGk8aXRlbS5zZWF0czsgaSsrKXsgY29uc3QgYSA9IChpKk1hdGguUEkqMikvaXRlbS5zZWF0czsgY29uc3QgY2ggPSBjcmVhdGVDaGFpckdyb3VwKC1hLU1hdGguUEkvMik7IGNoLnBvc2l0aW9uLnNldChyYWQqTWF0aC5jb3MoYSksIDAsIHJhZCpNYXRoLnNpbihhKSk7IGdyb3VwLmFkZChjaCk7IH0gfSBlbHNlIGlmIChkZWYudHlwZSA9PT0gJ2hlYWQnKSB7IGNvbnN0IHNwID0gaXcvKGl0ZW0uc2VhdHMrMSk7IGZvcihsZXQgaT0xOyBpPD1pdGVtLnNlYXRzOyBpKyspeyBjb25zdCBjaCA9IGNyZWF0ZUNoYWlyR3JvdXAoMCk7IGNoLnBvc2l0aW9uLnNldChzcCppLWl3LzIsIDAsIC1paC8yLWNEKTsgZ3JvdXAuYWRkKGNoKTsgfSB9IGVsc2UgeyBjb25zdCBzQyA9IE1hdGguY2VpbChpdGVtLnNlYXRzLzIpOyBjb25zdCBzcCA9IGl3LyhzQysxKTsgZm9yKGxldCBpPTE7IGk8PXNDOyBpKyspeyBjb25zdCB0QyA9IGNyZWF0ZUNoYWlyR3JvdXAoMCk7IHRDLnBvc2l0aW9uLnNldChzcCppLWl3LzIsIDAsIC1paC8yLWNEKTsgZ3JvdXAuYWRkKHRDKTsgY29uc3QgYkMgPSBjcmVhdGVDaGFpckdyb3VwKE1hdGguUEkpOyBiQy5wb3NpdGlvbi5zZXQoc3AqaS1pdy8yLCAwLCBpaC8yK2NEKTsgZ3JvdXAuYWRkKGJDKTsgfSB9IH0KICAgICAgICAgICAgICAgICAgIGdyb3VwLnBvc2l0aW9uLnNldChmeCwgZ1kgKyAoaXRlbS5lbGV2YXRpb24gfHwgMCksIGZ6KTsgZ3JvdXAucm90YXRpb24ueSA9IHJvdDsgZ3JvdXAudHJhdmVyc2UobiA9PiB7IGlmIChuIGluc3RhbmNlb2YgVEhSRUUuTWVzaCkgeyBuLmNhc3RTaGFkb3cgPSB0cnVlOyBuLnJlY2VpdmVTaGFkb3cgPSB0cnVlOyB9IH0pOyBzY2VuZS5hZGQoZ3JvdXApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FtZXJhLnBvc2l0aW9uLnNldCh3LzIsIDUuNSwgZCArIDM1KTsgY2FtZXJhLmxvb2tBdCh3LzIsIDQsIGQvMik7CiAgICAgICAgICAgIGNvbnN0IGNsayA9IG5ldyBUSFJFRS5DbG9jaygpOyBsZXQgaEZ0ID0gNS41OyAKICAgICAgICAgICAgbGV0IGRyb25lRGlzdGFuY2UgPSBudWxsOyAKICAgICAgICAgICAgCiAgICAgICAgICAgIGZ1bmN0aW9uIGFuaW1hdGUoKSB7CiAgICAgICAgICAgICAgICBhbmltYXRpb25GcmFtZSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKTsgY29uc3QgZHQgPSBjbGsuZ2V0RGVsdGEoKTsKICAgICAgICAgICAgICAgIGlmIChNT0RFID09PSAnaW5zaWRlJyAmJiB3YWxsc0dyb3VwKSB7CiAgICAgICAgICAgICAgICAgICB3YWxsc0dyb3VwLnZpc2libGUgPSAhU1RBVEUuZHJvbmVNb2RlICYmIFNUQVRFLnNob3dXYWxsczsKICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlaWwgPSBzY2VuZS5nZXRPYmplY3RCeU5hbWUoImNlaWxpbmciKTsKICAgICAgICAgICAgICAgICAgIGlmKGNlaWwpIGNlaWwudmlzaWJsZSA9ICFTVEFURS5kcm9uZU1vZGUgJiYgU1RBVEUuc2hvd1Jvb2Y7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmKFNUQVRFLmRyb25lTW9kZSkgeyAKICAgICAgICAgICAgICAgICAgICBpZiAoZHJvbmVEaXN0YW5jZSA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICBkcm9uZURpc3RhbmNlID0gTWF0aC5tYXgodywgZCkgKiAxLjEgKyAxNTsKICAgICAgICAgICAgICAgICAgICAgICAgaEZ0ID0gMTIuNTsgCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHpvb21TcGVlZCA9IDgwICogZHQ7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxldlNwZWVkID0gMzAgKiBkdDsKICAgICAgICAgICAgICAgICAgICBpZiAobW92ZVJlZi5mKSBkcm9uZURpc3RhbmNlID0gTWF0aC5tYXgoNSwgZHJvbmVEaXN0YW5jZSAtIHpvb21TcGVlZCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG1vdmVSZWYuYikgZHJvbmVEaXN0YW5jZSA9IE1hdGgubWluKDUwMCwgZHJvbmVEaXN0YW5jZSArIHpvb21TcGVlZCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG1vdmVSZWYudXApIGhGdCArPSBlbGV2U3BlZWQ7CiAgICAgICAgICAgICAgICAgICAgaWYgKG1vdmVSZWYuZG93bikgaEZ0ID0gTWF0aC5tYXgoMSwgaEZ0IC0gZWxldlNwZWVkKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gRGF0ZS5ub3coKSAqIDAuMDAwMTI7IAogICAgICAgICAgICAgICAgICAgIGNhbWVyYS5wb3NpdGlvbi5zZXQody8yICsgZHJvbmVEaXN0YW5jZSpNYXRoLmNvcyh0KSwgaEZ0LCBkLzIgKyBkcm9uZURpc3RhbmNlKk1hdGguc2luKHQpKTsgCiAgICAgICAgICAgICAgICAgICAgY2FtZXJhLmxvb2tBdCh3LzIsIDUsIGQvMik7IAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7IAogICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSAxMjsgY29uc3QgclMgPSAyLjA7IGNvbnN0IGhTID0gODsgCiAgICAgICAgICAgICAgICAgICAgaWYgKG1vdmVSZWYubG9va0wpIGNhbWVyYS5yb3RhdGlvbi55ICs9IHJTICogZHQ7IGlmIChtb3ZlUmVmLmxvb2tSKSBjYW1lcmEucm90YXRpb24ueSAtPSByUyAqIGR0OyBpZiAobW92ZVJlZi5sb29rVXApIGNhbWVyYS5yb3RhdGlvbi54ICs9IHJTICogZHQ7IGlmIChtb3ZlUmVmLmxvb2tEb3duKSBjYW1lcmEucm90YXRpb24ueCAtPSByUyAqIGR0OyBjYW1lcmEucm90YXRpb24ueCA9IE1hdGgubWF4KC1NYXRoLlBJLzIuMiwgTWF0aC5taW4oTWF0aC5QSS8yLjIsIGNhbWVyYS5yb3RhdGlvbi54KSk7IGlmIChtb3ZlUmVmLnVwKSBoRnQgKz0gaFMqZHQ7IGlmIChtb3ZlUmVmLmRvd24pIGhGdCA9IE1hdGgubWF4KDEsIGhGdC1oUypkdCk7IGNvbnN0IGRyID0gbmV3IFRIUkVFLlZlY3RvcjMoKTsgY2FtZXJhLmdldFdvcmxkRGlyZWN0aW9uKGRyKTsgZHIueSA9IDA7IGRyLm5vcm1hbGl6ZSgpOyBjb25zdCBzZCA9IG5ldyBUSFJFRS5WZWN0b3IzKCkuY3Jvc3NWZWN0b3JzKGNhbWVyYS51cCwgZHIpLm5vcm1hbGl6ZSgpOyBpZiAobW92ZVJlZi5mKSBjYW1lcmEucG9zaXRpb24uYWRkU2NhbGVkVmVjdG9yKGRyLCBzKmR0KTsgaWYgKG1vdmVSZWYuYikgY2FtZXJhLnBvc2l0aW9uLmFkZFNjYWxlZFZlY3RvcihkciwgLXMqZHQpOyBpZiAobW92ZVJlZi5sKSBjYW1lcmEucG9zaXRpb24uYWRkU2NhbGVkVmVjdG9yKHNkLCBzKmR0KTsgaWYgKG1vdmVSZWYucikgY2FtZXJhLnBvc2l0aW9uLmFkZFNjYWxlZFZlY3RvcihzZCwgLXMqZHQpOyBjYW1lcmEucG9zaXRpb24ueSA9IGhGdDsgfQogICAgICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmEpOwogICAgICAgICAgICB9IGFuaW1hdGUoKTsKICAgICAgICB9CiAgICAgICAgd2luZG93Lm9ua2V5ZG93biA9IGUgPT4geyBpZihlLmNvZGU9PT0nS2V5Vyd8fGUuY29kZT09PSdBcnJvd1VwJykgbW92ZVJlZi5mPXRydWU7IGlmKGUuY29kZT09PSdLZXlTJ3x8ZS5jb2RlPT09J0Fycm93RG93bicpIG1vdmVSZWYuYj10cnVlOyBpZihlLmNvZGU9PT0nS2V5QSd8fGUuY29kZT09PSdBcnJvd0xlZnQnKSBtb3ZlUmVmLmw9dHJ1ZTsgaWYoZS5jb2RlPT09J0tleUQnfHxlLmNvZGU9PT0nQXJyb3dSaWdodCcpIG1vdmVSZWYucj10cnVlOyB9OwogICAgICAgIHdpbmRvdy5vbmtleXVwID0gZSA9PiB7IGlmKGUuY29kZT09PSdLZXlXJ3x8ZS5jb2RlPT09J0Fycm93VXAnKSBtb3ZlUmVmLmY9ZmFsc2U7IGlmKGUuY29kZT09PSdLZXlTJ3x8ZS5jb2RlPT09J0Fycm93RG93bicpIG1vdmVSZWYuYj1mYWxzZTsgaWYoZS5jb2RlPT09J0tleUEnfHxlLmNvZGU9PT0nQXJyb3dMZWZ0JykgbW92ZVJlZi5sPWZhbHNlOyBpZihlLmNvZGU9PT0nS2V5RCd8fGUuY29kZT09PSdBcnJvd1JpZ2h0JykgbW92ZVJlZi5yPWZhbHNlOyB9OwogICAgICAgIGluaXQoKTsKICAgIDwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4=" width="100%" height="750" style="border:none; border-radius:30px; box-shadow: 0 40px 100px rgba(0,0,0,0.5);"></iframe>



</body>
</html>
